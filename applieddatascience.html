<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tidyverse Skills for Data Science</title>
  <meta name="description" content="This book demonstrates how to use the Tidyverse collection of packages for doing data science." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Tidyverse Skills for Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book demonstrates how to use the Tidyverse collection of packages for doing data science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tidyverse Skills for Data Science" />
  
  <meta name="twitter:description" content="This book demonstrates how to use the Tidyverse collection of packages for doing data science." />
  

<meta name="author" content="Carrie Wright, Shannon E. Ellis, Stephanie C. Hicks and Roger D. Peng" />


<meta name="date" content="2021-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Tidyverse Skills for Data Science</h1>
<p class="author"><em>Carrie Wright, Shannon E. Ellis, Stephanie C. Hicks and Roger D. Peng</em></p>
<p class="date"><em>2021-02-10</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#intro"><span class="toc-section-number">1</span> Introduction to the Tidyverse</a><ul>
<li><a href="#about-this-course"><span class="toc-section-number">1.1</span> About This Course</a></li>
<li><a href="#tidy-data"><span class="toc-section-number">1.2</span> Tidy Data</a><ul>
<li><a href="#data-terminology"><span class="toc-section-number">1.2.1</span> Data Terminology</a></li>
<li><a href="#principles-of-tidy-data"><span class="toc-section-number">1.2.2</span> Principles of Tidy Data</a></li>
<li><a href="#tidy-data-are-rectangular"><span class="toc-section-number">1.2.3</span> Tidy Data Are Rectangular</a></li>
<li><a href="#tidy-data-benefits"><span class="toc-section-number">1.2.4</span> Tidy Data Benefits</a></li>
<li><a href="#rules-for-storing-tidy-data"><span class="toc-section-number">1.2.5</span> Rules for Storing Tidy Data</a></li>
</ul></li>
<li><a href="#from-non-tidy-tidy"><span class="toc-section-number">1.3</span> From Non-Tidy –&gt; Tidy</a><ul>
<li><a href="#common-problems-with-messy-datasets"><span class="toc-section-number">1.3.1</span> Common problems with messy datasets</a></li>
<li><a href="#examples-of-untidy-data"><span class="toc-section-number">1.3.2</span> Examples of untidy data</a></li>
<li><a href="#tidying-untidy-data"><span class="toc-section-number">1.3.3</span> Tidying untidy data</a></li>
</ul></li>
<li><a href="#the-data-science-life-cycle"><span class="toc-section-number">1.4</span> The Data Science Life Cycle</a></li>
<li><a href="#the-tidyverse-ecosystem"><span class="toc-section-number">1.5</span> The Tidyverse Ecosystem</a><ul>
<li><a href="#reading-data-into-r"><span class="toc-section-number">1.5.1</span> Reading Data into R</a></li>
<li><a href="#data-tidying"><span class="toc-section-number">1.5.2</span> Data Tidying</a></li>
<li><a href="#data-visualization"><span class="toc-section-number">1.5.3</span> Data Visualization</a></li>
<li><a href="#data-modeling"><span class="toc-section-number">1.5.4</span> Data Modeling</a></li>
</ul></li>
<li><a href="#data-science-project-organization"><span class="toc-section-number">1.6</span> Data Science Project Organization</a><ul>
<li><a href="#rstudio-projects"><span class="toc-section-number">1.6.1</span> RStudio Projects</a></li>
<li><a href="#file-paths"><span class="toc-section-number">1.6.2</span> File Paths</a></li>
<li><a href="#the-here-package"><span class="toc-section-number">1.6.3</span> The <code>here</code> package</a></li>
<li><a href="#file-naming"><span class="toc-section-number">1.6.4</span> File Naming</a></li>
<li><a href="#project-template-everything-in-its-place"><span class="toc-section-number">1.6.5</span> Project Template: Everything In Its Place</a></li>
</ul></li>
<li><a href="#data-science-workflows"><span class="toc-section-number">1.7</span> Data Science Workflows</a></li>
<li><a href="#case-studies"><span class="toc-section-number">1.8</span> Case Studies</a><ul>
<li><a href="#case-study-1-health-expenditures"><span class="toc-section-number">1.8.1</span> Case Study #1: Health Expenditures</a></li>
<li><a href="#case-study-2-firearms"><span class="toc-section-number">1.8.2</span> Case Study #2: Firearms</a></li>
</ul></li>
</ul></li>
<li><a href="#get-data"><span class="toc-section-number">2</span> Importing Data in the Tidyverse</a><ul>
<li><a href="#about-this-course-1"><span class="toc-section-number">2.1</span> About This Course</a></li>
<li><a href="#tibbles"><span class="toc-section-number">2.2</span> Tibbles</a><ul>
<li><a href="#how-tibbles-differ-from-data.frame"><span class="toc-section-number">2.2.1</span> How tibbles differ from data.frame</a></li>
<li><a href="#creating-a-tibble"><span class="toc-section-number">2.2.2</span> Creating a tibble</a></li>
<li><a href="#subsetting"><span class="toc-section-number">2.2.3</span> Subsetting</a></li>
</ul></li>
<li><a href="#spreadsheets"><span class="toc-section-number">2.3</span> Spreadsheets</a><ul>
<li><a href="#excel-files"><span class="toc-section-number">2.3.1</span> Excel files</a></li>
<li><a href="#google-sheets"><span class="toc-section-number">2.3.2</span> Google Sheets</a></li>
</ul></li>
<li><a href="#csvs"><span class="toc-section-number">2.4</span> CSVs</a><ul>
<li><a href="#downloading-csv-files"><span class="toc-section-number">2.4.1</span> Downloading CSV files</a></li>
<li><a href="#reading-csvs-into-r"><span class="toc-section-number">2.4.2</span> Reading CSVs into R</a></li>
</ul></li>
<li><a href="#tsvs"><span class="toc-section-number">2.5</span> TSVs</a><ul>
<li><a href="#reading-tsvs-into-r"><span class="toc-section-number">2.5.1</span> Reading TSVs into R</a></li>
</ul></li>
<li><a href="#delimited-files"><span class="toc-section-number">2.6</span> Delimited Files</a><ul>
<li><a href="#reading-delimited-files-into-r"><span class="toc-section-number">2.6.1</span> Reading Delimited Files into R</a></li>
</ul></li>
<li><a href="#exporting-data-from-r"><span class="toc-section-number">2.7</span> Exporting Data from R</a></li>
<li><a href="#json"><span class="toc-section-number">2.8</span> JSON</a></li>
<li><a href="#xml"><span class="toc-section-number">2.9</span> XML</a></li>
<li><a href="#databases"><span class="toc-section-number">2.10</span> Databases</a><ul>
<li><a href="#relational-data"><span class="toc-section-number">2.10.1</span> Relational Data</a></li>
<li><a href="#relational-databases-sql"><span class="toc-section-number">2.10.2</span> Relational Databases: <code>SQL</code></a></li>
<li><a href="#connecting-to-databases-rsqlite"><span class="toc-section-number">2.10.3</span> Connecting to Databases: <code>RSQLite</code></a></li>
<li><a href="#working-with-relational-data-dplyr-dbplyr"><span class="toc-section-number">2.10.4</span> Working with Relational Data: <code>dplyr</code> &amp; <code>dbplyr</code></a></li>
<li><a href="#mutating-joins"><span class="toc-section-number">2.10.5</span> Mutating Joins</a></li>
<li><a href="#filtering-joins"><span class="toc-section-number">2.10.6</span> Filtering Joins</a></li>
<li><a href="#how-to-connect-to-a-database-online"><span class="toc-section-number">2.10.7</span> How to Connect to a Database Online</a></li>
</ul></li>
<li><a href="#web-scraping"><span class="toc-section-number">2.11</span> Web Scraping</a><ul>
<li><a href="#rvest-basics"><span class="toc-section-number">2.11.1</span> <code>rvest</code> Basics</a></li>
<li><a href="#selectorgadget"><span class="toc-section-number">2.11.2</span> SelectorGadget</a></li>
<li><a href="#web-scraping-example"><span class="toc-section-number">2.11.3</span> Web Scraping Example</a></li>
<li><a href="#a-final-note-selectorgadget"><span class="toc-section-number">2.11.4</span> A final note: SelectorGadget</a></li>
</ul></li>
<li><a href="#apis"><span class="toc-section-number">2.12</span> APIs</a><ul>
<li><a href="#getting-data-httr"><span class="toc-section-number">2.12.1</span> Getting Data: <code>httr</code></a></li>
<li><a href="#example-1-githubs-api"><span class="toc-section-number">2.12.2</span> Example 1: GitHub’s API</a></li>
<li><a href="#example-2-obtaining-a-csv"><span class="toc-section-number">2.12.3</span> Example 2: Obtaining a CSV</a></li>
<li><a href="#read_csv-from-a-url"><span class="toc-section-number">2.12.4</span> <code>read_csv()</code> from a URL</a></li>
<li><a href="#api-keys"><span class="toc-section-number">2.12.5</span> API keys</a></li>
</ul></li>
<li><a href="#foreign-formats"><span class="toc-section-number">2.13</span> Foreign Formats</a><ul>
<li><a href="#haven-1"><span class="toc-section-number">2.13.1</span> <code>haven</code></a></li>
</ul></li>
<li><a href="#images"><span class="toc-section-number">2.14</span> Images</a></li>
<li><a href="#googledrive-1"><span class="toc-section-number">2.15</span> <code>googledrive</code></a></li>
<li><a href="#case-studies-1"><span class="toc-section-number">2.16</span> Case Studies</a><ul>
<li><a href="#case-study-1-health-expenditures-1"><span class="toc-section-number">2.16.1</span> Case Study #1: Health Expenditures</a></li>
<li><a href="#case-study-2-firearms-1"><span class="toc-section-number">2.16.2</span> Case Study #2: Firearms</a></li>
</ul></li>
</ul></li>
<li><a href="#wrangle-data"><span class="toc-section-number">3</span> Wrangling Data in the Tidyverse</a><ul>
<li><a href="#about-this-course-2"><span class="toc-section-number">3.1</span> About This Course</a></li>
<li><a href="#tidy-data-review"><span class="toc-section-number">3.2</span> Tidy Data Review</a></li>
<li><a href="#reshaping-data"><span class="toc-section-number">3.3</span> Reshaping Data</a><ul>
<li><a href="#wide-data"><span class="toc-section-number">3.3.1</span> Wide Data</a></li>
<li><a href="#long-data"><span class="toc-section-number">3.3.2</span> Long Data</a></li>
<li><a href="#reshaping-the-data"><span class="toc-section-number">3.3.3</span> Reshaping the Data</a></li>
</ul></li>
<li><a href="#data-wrangling"><span class="toc-section-number">3.4</span> Data Wrangling</a><ul>
<li><a href="#r-packages"><span class="toc-section-number">3.4.1</span> R Packages</a></li>
<li><a href="#the-pipe-operator"><span class="toc-section-number">3.4.2</span> The Pipe Operator</a></li>
<li><a href="#filtering-data"><span class="toc-section-number">3.4.3</span> Filtering Data</a></li>
<li><a href="#reordering"><span class="toc-section-number">3.4.4</span> Reordering</a></li>
<li><a href="#creating-new-columns"><span class="toc-section-number">3.4.5</span> Creating New Columns</a></li>
<li><a href="#separating-columns"><span class="toc-section-number">3.4.6</span> Separating Columns</a></li>
<li><a href="#merging-columns"><span class="toc-section-number">3.4.7</span> Merging Columns</a></li>
<li><a href="#cleaning-column-names"><span class="toc-section-number">3.4.8</span> Cleaning Column Names</a></li>
<li><a href="#combining-data-across-data-frames"><span class="toc-section-number">3.4.9</span> Combining Data Across Data Frames</a></li>
<li><a href="#grouping-data"><span class="toc-section-number">3.4.10</span> Grouping Data</a></li>
<li><a href="#summarizing-data"><span class="toc-section-number">3.4.11</span> Summarizing Data</a></li>
<li><a href="#operations-across-columns"><span class="toc-section-number">3.4.12</span> Operations Across Columns</a></li>
</ul></li>
<li><a href="#working-with-factors"><span class="toc-section-number">3.5</span> Working With Factors</a><ul>
<li><a href="#factor-review"><span class="toc-section-number">3.5.1</span> Factor Review</a></li>
<li><a href="#manually-changing-the-labels-of-factor-levels-fct_relevel"><span class="toc-section-number">3.5.2</span> Manually Changing the Labels of Factor Levels: <code>fct_relevel()</code></a></li>
<li><a href="#keeping-the-order-of-the-factor-levels-fct_inorder"><span class="toc-section-number">3.5.3</span> Keeping the Order of the Factor Levels: <code>fct_inorder()</code></a></li>
<li><a href="#advanced-factoring"><span class="toc-section-number">3.5.4</span> Advanced Factoring</a></li>
<li><a href="#re-ordering-factor-levels-by-frequency-fct_infreq"><span class="toc-section-number">3.5.5</span> Re-ordering Factor Levels by Frequency: <code>fct_infreq()</code></a></li>
<li><a href="#reversing-order-levels-fct_rev"><span class="toc-section-number">3.5.6</span> Reversing Order Levels: <code>fct_rev()</code></a></li>
<li><a href="#re-ordering-factor-levels-by-another-variable-fct_reorder"><span class="toc-section-number">3.5.7</span> Re-ordering Factor Levels by Another Variable: <code>fct_reorder()</code></a></li>
<li><a href="#combining-several-levels-into-one-fct_recode"><span class="toc-section-number">3.5.8</span> Combining Several Levels into One: <code>fct_recode()</code></a></li>
<li><a href="#converting-numeric-levels-to-factors-ifelse-factor"><span class="toc-section-number">3.5.9</span> Converting Numeric Levels to Factors: <code>ifelse()</code> + <code>factor()</code></a></li>
</ul></li>
<li><a href="#working-with-dates-and-times"><span class="toc-section-number">3.6</span> Working With Dates and Times</a><ul>
<li><a href="#dates-and-times-basics"><span class="toc-section-number">3.6.1</span> Dates and Times Basics</a></li>
<li><a href="#creating-dates-and-date-time-objects"><span class="toc-section-number">3.6.2</span> Creating Dates and Date-Time Objects</a></li>
<li><a href="#working-with-dates"><span class="toc-section-number">3.6.3</span> Working with Dates</a></li>
<li><a href="#time-spans"><span class="toc-section-number">3.6.4</span> Time Spans</a></li>
</ul></li>
<li><a href="#working-with-strings"><span class="toc-section-number">3.7</span> Working With Strings</a><ul>
<li><a href="#stringr-1"><span class="toc-section-number">3.7.1</span> <code>stringr</code></a></li>
<li><a href="#string-basics"><span class="toc-section-number">3.7.2</span> String Basics</a></li>
<li><a href="#regular-expressions"><span class="toc-section-number">3.7.3</span> Regular Expressions</a></li>
<li><a href="#glue-1"><span class="toc-section-number">3.7.4</span> <code>glue</code></a></li>
</ul></li>
<li><a href="#working-with-text"><span class="toc-section-number">3.8</span> Working With Text</a><ul>
<li><a href="#tidy-text-format"><span class="toc-section-number">3.8.1</span> Tidy Text Format</a></li>
<li><a href="#sentiment-analysis"><span class="toc-section-number">3.8.2</span> Sentiment Analysis</a></li>
<li><a href="#word-and-document-frequency"><span class="toc-section-number">3.8.3</span> Word and Document Frequency</a></li>
</ul></li>
<li><a href="#functional-programming"><span class="toc-section-number">3.9</span> Functional Programming</a><ul>
<li><a href="#for-loops-vs.-functionals"><span class="toc-section-number">3.9.1</span> For Loops vs. Functionals</a></li>
<li><a href="#map-functions"><span class="toc-section-number">3.9.2</span> <code>map</code> Functions</a></li>
<li><a href="#multiple-vectors"><span class="toc-section-number">3.9.3</span> Multiple Vectors</a></li>
<li><a href="#anonymous-functions"><span class="toc-section-number">3.9.4</span> Anonymous Functions</a></li>
</ul></li>
<li><a href="#exploratory-data-analysis"><span class="toc-section-number">3.10</span> Exploratory Data Analysis</a><ul>
<li><a href="#general-principles-of-eda"><span class="toc-section-number">3.10.1</span> General Principles of EDA</a></li>
<li><a href="#analyzing-json-in-r"><span class="toc-section-number">3.10.2</span> Analyzing JSON in R</a></li>
<li><a href="#analyzing-xml-in-r"><span class="toc-section-number">3.10.3</span> Analyzing XML in R</a></li>
</ul></li>
<li><a href="#case-studies-2"><span class="toc-section-number">3.11</span> Case Studies</a><ul>
<li><a href="#case-study-1-health-expenditures-2"><span class="toc-section-number">3.11.1</span> Case Study #1: Health Expenditures</a></li>
<li><a href="#case-study-2-firearms-2"><span class="toc-section-number">3.11.2</span> Case Study #2: Firearms</a></li>
</ul></li>
</ul></li>
<li><a href="#dataviz"><span class="toc-section-number">4</span> Visualizing Data in the Tidyverse</a><ul>
<li><a href="#about-this-course-3"><span class="toc-section-number">4.1</span> About This Course</a></li>
<li><a href="#data-visualization-background"><span class="toc-section-number">4.2</span> Data Visualization Background</a><ul>
<li><a href="#general-features-of-plots"><span class="toc-section-number">4.2.1</span> General Features of Plots</a></li>
</ul></li>
<li><a href="#plot-types"><span class="toc-section-number">4.3</span> Plot Types</a><ul>
<li><a href="#histogram"><span class="toc-section-number">4.3.1</span> Histogram</a></li>
<li><a href="#densityplot"><span class="toc-section-number">4.3.2</span> Densityplot</a></li>
<li><a href="#scatterplot"><span class="toc-section-number">4.3.3</span> Scatterplot</a></li>
<li><a href="#barplot"><span class="toc-section-number">4.3.4</span> Barplot</a></li>
<li><a href="#boxplot"><span class="toc-section-number">4.3.5</span> Boxplot</a></li>
<li><a href="#line-plots"><span class="toc-section-number">4.3.6</span> Line Plots</a></li>
</ul></li>
<li><a href="#making-good-plots"><span class="toc-section-number">4.4</span> Making Good Plots</a><ul>
<li><a href="#choose-the-right-type-of-plot"><span class="toc-section-number">4.4.1</span> Choose the Right Type of Plot</a></li>
<li><a href="#be-mindful-when-choosing-colors"><span class="toc-section-number">4.4.2</span> Be Mindful When Choosing Colors</a></li>
<li><a href="#label-the-axes"><span class="toc-section-number">4.4.3</span> Label the Axes</a></li>
<li><a href="#make-sure-the-text-is-readable"><span class="toc-section-number">4.4.4</span> Make Sure the Text is Readable</a></li>
<li><a href="#make-sure-the-numbers-add-up"><span class="toc-section-number">4.4.5</span> Make Sure the Numbers Add Up</a></li>
<li><a href="#make-sure-the-numbers-and-plots-make-sense-together"><span class="toc-section-number">4.4.6</span> Make Sure the Numbers and Plots Make Sense Together</a></li>
<li><a href="#make-comparisons-easy-on-viewers"><span class="toc-section-number">4.4.7</span> Make Comparisons Easy on Viewers</a></li>
<li><a href="#use-y-axes-that-start-at-zero"><span class="toc-section-number">4.4.8</span> Use y-axes That Start at Zero</a></li>
<li><a href="#keep-it-simple"><span class="toc-section-number">4.4.9</span> Keep It Simple</a></li>
</ul></li>
<li><a href="#plot-generation-process"><span class="toc-section-number">4.5</span> Plot Generation Process</a><ul>
<li><a href="#whats-your-point"><span class="toc-section-number">4.5.1</span> What’s your point?</a></li>
<li><a href="#how-can-you-emphasize-your-point-in-your-chart"><span class="toc-section-number">4.5.2</span> How can you emphasize your point in your chart?</a></li>
<li><a href="#what-does-your-final-chart-show"><span class="toc-section-number">4.5.3</span> What Does Your Final Chart Show?</a></li>
</ul></li>
<li><a href="#ggplot2-basics"><span class="toc-section-number">4.6</span> <code>ggplot2</code>: Basics</a><ul>
<li><a href="#ggplot2-background"><span class="toc-section-number">4.6.1</span> <code>ggplot2</code> Background</a></li>
<li><a href="#example-dataset-diamonds"><span class="toc-section-number">4.6.2</span> Example Dataset: <code>diamonds</code></a></li>
<li><a href="#scatterplots-geom_point"><span class="toc-section-number">4.6.3</span> Scatterplots: <code>geom_point()</code></a></li>
<li><a href="#aesthetics"><span class="toc-section-number">4.6.4</span> Aesthetics</a></li>
<li><a href="#facets"><span class="toc-section-number">4.6.5</span> Facets</a></li>
<li><a href="#geoms"><span class="toc-section-number">4.6.6</span> Geoms</a></li>
<li><a href="#eda-plots"><span class="toc-section-number">4.6.7</span> EDA Plots</a></li>
</ul></li>
<li><a href="#ggplot2-customization"><span class="toc-section-number">4.7</span> <code>ggplot2</code>: Customization</a><ul>
<li><a href="#colors"><span class="toc-section-number">4.7.1</span> Colors</a></li>
<li><a href="#labels"><span class="toc-section-number">4.7.2</span> Labels</a></li>
<li><a href="#themes"><span class="toc-section-number">4.7.3</span> Themes</a></li>
<li><a href="#custom-theme"><span class="toc-section-number">4.7.4</span> Custom Theme</a></li>
<li><a href="#legends"><span class="toc-section-number">4.7.5</span> Legends</a></li>
<li><a href="#scales"><span class="toc-section-number">4.7.6</span> Scales</a></li>
<li><a href="#coordinate-adjustment"><span class="toc-section-number">4.7.7</span> Coordinate Adjustment</a></li>
<li><a href="#annotation"><span class="toc-section-number">4.7.8</span> Annotation</a></li>
<li><a href="#vertical-and-horizontal-lines"><span class="toc-section-number">4.7.9</span> Vertical and Horizontal Lines</a></li>
</ul></li>
<li><a href="#tables"><span class="toc-section-number">4.8</span> Tables</a><ul>
<li><a href="#tables-in-r"><span class="toc-section-number">4.8.1</span> Tables in R</a></li>
<li><a href="#getting-the-data-in-order"><span class="toc-section-number">4.8.2</span> Getting the Data in Order</a></li>
<li><a href="#an-exploratory-table"><span class="toc-section-number">4.8.3</span> An Exploratory Table</a></li>
<li><a href="#improving-the-table-output"><span class="toc-section-number">4.8.4</span> Improving the Table Output</a></li>
<li><a href="#annotating-your-table"><span class="toc-section-number">4.8.5</span> Annotating Your Table</a></li>
</ul></li>
<li><a href="#ggplot2-extensions"><span class="toc-section-number">4.9</span> <code>ggplot2</code>: Extensions</a><ul>
<li><a href="#ggrepel-1"><span class="toc-section-number">4.9.1</span> <code>ggrepel</code></a></li>
<li><a href="#directlabels"><span class="toc-section-number">4.9.2</span> <code>directlabels</code></a></li>
<li><a href="#cowplot-1"><span class="toc-section-number">4.9.3</span> <code>cowplot</code></a></li>
<li><a href="#patchwork-1"><span class="toc-section-number">4.9.4</span> <code>patchwork</code></a></li>
<li><a href="#gganimate-1"><span class="toc-section-number">4.9.5</span> <code>gganimate</code></a></li>
</ul></li>
<li><a href="#case-studies-3"><span class="toc-section-number">4.10</span> Case Studies</a><ul>
<li><a href="#case-study-1-health-expenditures-3"><span class="toc-section-number">4.10.1</span> Case Study #1: Health Expenditures</a></li>
<li><a href="#case-study-2-firearms-3"><span class="toc-section-number">4.10.2</span> Case Study #2: Firearms</a></li>
</ul></li>
</ul></li>
<li><a href="#model"><span class="toc-section-number">5</span> Modeling Data in the Tidyverse</a><ul>
<li><a href="#about-this-course-4"><span class="toc-section-number">5.1</span> About This Course</a></li>
<li><a href="#the-purpose-of-data-science"><span class="toc-section-number">5.2</span> The Purpose of Data Science</a></li>
<li><a href="#types-of-data-science-questions"><span class="toc-section-number">5.3</span> Types of Data Science Questions</a></li>
<li><a href="#data-needs"><span class="toc-section-number">5.4</span> Data Needs</a><ul>
<li><a href="#number-of-observations-is-too-small"><span class="toc-section-number">5.4.1</span> Number of observations is too small</a></li>
<li><a href="#dataset-does-not-contain-the-exact-variables-you-are-looking-for"><span class="toc-section-number">5.4.2</span> Dataset does not contain the exact variables you are looking for</a></li>
<li><a href="#variables-in-the-dataset-are-not-collected-in-the-same-year"><span class="toc-section-number">5.4.3</span> Variables in the dataset are not collected in the same year</a></li>
<li><a href="#dataset-is-not-representative-of-the-population-that-you-are-interested-in"><span class="toc-section-number">5.4.4</span> Dataset is not representative of the population that you are interested in</a></li>
<li><a href="#some-variables-in-the-dataset-are-measured-with-error"><span class="toc-section-number">5.4.5</span> Some variables in the dataset are measured with error</a></li>
<li><a href="#variables-are-confounded"><span class="toc-section-number">5.4.6</span> Variables are confounded</a></li>
</ul></li>
<li><a href="#descriptive-and-exploratory-analysis"><span class="toc-section-number">5.5</span> Descriptive and Exploratory Analysis</a><ul>
<li><a href="#missing-values"><span class="toc-section-number">5.5.1</span> Missing Values</a></li>
<li><a href="#shape"><span class="toc-section-number">5.5.2</span> Shape</a></li>
<li><a href="#identifying-outliers"><span class="toc-section-number">5.5.3</span> Identifying Outliers</a></li>
<li><a href="#evaluating-variables"><span class="toc-section-number">5.5.4</span> Evaluating Variables</a></li>
<li><a href="#evaluating-relationships"><span class="toc-section-number">5.5.5</span> Evaluating Relationships</a></li>
</ul></li>
<li><a href="#inference"><span class="toc-section-number">5.6</span> Inference</a><ul>
<li><a href="#uncertainty"><span class="toc-section-number">5.6.1</span> Uncertainty</a></li>
<li><a href="#random-sampling"><span class="toc-section-number">5.6.2</span> Random Sampling</a></li>
</ul></li>
<li><a href="#linear-modeling"><span class="toc-section-number">5.7</span> Linear Modeling</a><ul>
<li><a href="#linear-regression"><span class="toc-section-number">5.7.1</span> Linear Regression</a></li>
<li><a href="#assumptions"><span class="toc-section-number">5.7.2</span> Assumptions</a></li>
<li><a href="#association"><span class="toc-section-number">5.7.3</span> Association</a></li>
<li><a href="#association-testing-in-r"><span class="toc-section-number">5.7.4</span> Association Testing in R</a></li>
<li><a href="#fitting-the-model"><span class="toc-section-number">5.7.5</span> Fitting the Model</a></li>
<li><a href="#model-diagnostics"><span class="toc-section-number">5.7.6</span> Model Diagnostics</a></li>
<li><a href="#tree-girth-and-height-example"><span class="toc-section-number">5.7.7</span> Tree Girth and Height Example</a></li>
<li><a href="#interpreting-the-model"><span class="toc-section-number">5.7.8</span> Interpreting the Model</a></li>
<li><a href="#variance-explained"><span class="toc-section-number">5.7.9</span> Variance Explained</a></li>
<li><a href="#using-broom"><span class="toc-section-number">5.7.10</span> Using <code>broom</code></a></li>
<li><a href="#correlation-is-not-causation"><span class="toc-section-number">5.7.11</span> Correlation Is Not Causation</a></li>
<li><a href="#confounding"><span class="toc-section-number">5.7.12</span> Confounding</a></li>
</ul></li>
<li><a href="#multiple-linear-regression"><span class="toc-section-number">5.8</span> Multiple Linear Regression</a></li>
<li><a href="#beyond-linear-regression"><span class="toc-section-number">5.9</span> Beyond Linear Regression</a><ul>
<li><a href="#mean-different-from-expectation"><span class="toc-section-number">5.9.1</span> Mean Different From Expectation?</a></li>
<li><a href="#testing-mean-difference-from-expectation-in-r"><span class="toc-section-number">5.9.2</span> Testing Mean Difference From Expectation in R</a></li>
</ul></li>
<li><a href="#more-statistical-tests"><span class="toc-section-number">5.10</span> More Statistical Tests</a></li>
<li><a href="#hypothesis-testing"><span class="toc-section-number">5.11</span> Hypothesis Testing</a><ul>
<li><a href="#theinfer-package"><span class="toc-section-number">5.11.1</span> The<code>Infer</code> Package</a></li>
</ul></li>
<li><a href="#prediction-modeling"><span class="toc-section-number">5.12</span> Prediction Modeling</a><ul>
<li><a href="#what-is-machine-learning"><span class="toc-section-number">5.12.1</span> What is Machine Learning?</a></li>
<li><a href="#machine-learning-steps"><span class="toc-section-number">5.12.2</span> Machine Learning Steps</a></li>
<li><a href="#data-splitting"><span class="toc-section-number">5.12.3</span> Data Splitting</a></li>
<li><a href="#train-test-validate"><span class="toc-section-number">5.12.4</span> Train, Test, Validate</a></li>
<li><a href="#train"><span class="toc-section-number">5.12.5</span> Train</a></li>
<li><a href="#test"><span class="toc-section-number">5.12.6</span> Test</a></li>
<li><a href="#validate"><span class="toc-section-number">5.12.7</span> Validate</a></li>
<li><a href="#variable-selection"><span class="toc-section-number">5.12.8</span> Variable Selection</a></li>
<li><a href="#model-selection"><span class="toc-section-number">5.12.9</span> Model Selection</a></li>
<li><a href="#regression-vs.-classification"><span class="toc-section-number">5.12.10</span> Regression vs. Classification</a></li>
<li><a href="#model-accuracy"><span class="toc-section-number">5.12.11</span> Model Accuracy</a></li>
</ul></li>
<li><a href="#the-tidymodels-ecosystem-1"><span class="toc-section-number">5.13</span> The <code>tidymodels</code> Ecosystem</a><ul>
<li><a href="#benefits-of-tidymodels"><span class="toc-section-number">5.13.1</span> Benefits of <code>tidymodels</code></a></li>
<li><a href="#packages-of-tidymodels"><span class="toc-section-number">5.13.2</span> Packages of <code>tidymodels</code></a></li>
<li><a href="#example-of-continuous-variable-prediction"><span class="toc-section-number">5.13.3</span> Example of Continuous Variable Prediction</a></li>
<li><a href="#example-of-categorical-variable-prediction"><span class="toc-section-number">5.13.4</span> Example of Categorical Variable Prediction</a></li>
</ul></li>
<li><a href="#case-studies-4"><span class="toc-section-number">5.14</span> Case Studies</a><ul>
<li><a href="#case-study-1-predicting-annual-air-pollution"><span class="toc-section-number">5.14.1</span> Case Study #1: Predicting Annual Air Pollution</a></li>
</ul></li>
<li><a href="#summary-of-tidymodels"><span class="toc-section-number">5.15</span> Summary of <code>tidymodels</code></a></li>
</ul></li>
<li><a href="#about-the-authors">About the Authors</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tidyverse Skills for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="prerequisites" class="section level1 unnumbered">
<h1>Prerequisites</h1>
<!--chapter:end:index.Rmd-->
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> Introduction to the Tidyverse</h1>
<p>Placeholder</p>
<div id="about-this-course" class="section level2">
<h2><span class="header-section-number">1.1</span> About This Course</h2>
</div>
<div id="tidy-data" class="section level2">
<h2><span class="header-section-number">1.2</span> Tidy Data</h2>
<div id="data-terminology" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Data Terminology</h3>
</div>
<div id="principles-of-tidy-data" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Principles of Tidy Data</h3>
</div>
<div id="tidy-data-are-rectangular" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Tidy Data Are Rectangular</h3>
</div>
<div id="tidy-data-benefits" class="section level3">
<h3><span class="header-section-number">1.2.4</span> Tidy Data Benefits</h3>
</div>
<div id="rules-for-storing-tidy-data" class="section level3">
<h3><span class="header-section-number">1.2.5</span> Rules for Storing Tidy Data</h3>
<div id="be-consistent" class="section level4">
<h4><span class="header-section-number">1.2.5.1</span> Be consistent</h4>
</div>
<div id="choose-good-names-for-things" class="section level4">
<h4><span class="header-section-number">1.2.5.2</span> Choose good names for things</h4>
</div>
<div id="write-dates-as-yyyy-mm-dd" class="section level4">
<h4><span class="header-section-number">1.2.5.3</span> Write dates as YYYY-MM-DD</h4>
</div>
<div id="no-empty-cells" class="section level4">
<h4><span class="header-section-number">1.2.5.4</span> No empty cells</h4>
</div>
<div id="put-just-one-thing-in-a-cell" class="section level4">
<h4><span class="header-section-number">1.2.5.5</span> Put just one thing in a cell</h4>
</div>
<div id="dont-use-font-color-or-highlighting-as-data" class="section level4">
<h4><span class="header-section-number">1.2.5.6</span> Don’t use font color or highlighting as data</h4>
</div>
<div id="save-the-data-as-plain-text-files" class="section level4">
<h4><span class="header-section-number">1.2.5.7</span> Save the data as plain text files</h4>
</div>
<div id="summary" class="section level4">
<h4><span class="header-section-number">1.2.5.8</span> Summary</h4>
</div>
</div>
</div>
<div id="from-non-tidy-tidy" class="section level2">
<h2><span class="header-section-number">1.3</span> From Non-Tidy –&gt; Tidy</h2>
<div id="common-problems-with-messy-datasets" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Common problems with messy datasets</h3>
</div>
<div id="examples-of-untidy-data" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Examples of untidy data</h3>
<div id="examples-from-data-organization-in-spreadsheets" class="section level4">
<h4><span class="header-section-number">1.3.2.1</span> Examples from <a href="https://peerj.com/preprints/3183/">Data Organization in Spreadsheets</a></h4>
</div>
</div>
<div id="tidying-untidy-data" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Tidying untidy data</h3>
</div>
</div>
<div id="the-data-science-life-cycle" class="section level2">
<h2><span class="header-section-number">1.4</span> The Data Science Life Cycle</h2>
</div>
<div id="the-tidyverse-ecosystem" class="section level2">
<h2><span class="header-section-number">1.5</span> The Tidyverse Ecosystem</h2>
<div id="reading-data-into-r" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Reading Data into R</h3>
<div id="tibble" class="section level4">
<h4><span class="header-section-number">1.5.1.1</span> <strong><code>tibble</code></strong></h4>
</div>
<div id="readr" class="section level4">
<h4><span class="header-section-number">1.5.1.2</span> <strong><code>readr</code></strong></h4>
</div>
<div id="googlesheets4" class="section level4">
<h4><span class="header-section-number">1.5.1.3</span> <strong><code>googlesheets4</code></strong></h4>
</div>
<div id="readxl" class="section level4">
<h4><span class="header-section-number">1.5.1.4</span> <strong><code>readxl</code></strong></h4>
</div>
<div id="googledrive" class="section level4">
<h4><span class="header-section-number">1.5.1.5</span> <strong><code>googledrive</code></strong></h4>
</div>
<div id="haven" class="section level4">
<h4><span class="header-section-number">1.5.1.6</span> <strong><code>haven</code></strong></h4>
</div>
<div id="jsonlite-xml2" class="section level4">
<h4><span class="header-section-number">1.5.1.7</span> <strong><code>jsonlite</code> &amp; <code>xml2</code></strong></h4>
</div>
<div id="rvest" class="section level4">
<h4><span class="header-section-number">1.5.1.8</span> <strong><code>rvest</code></strong></h4>
</div>
<div id="httr" class="section level4">
<h4><span class="header-section-number">1.5.1.9</span> <strong><code>httr</code></strong></h4>
</div>
</div>
<div id="data-tidying" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Data Tidying</h3>
<div id="dplyr" class="section level4">
<h4><span class="header-section-number">1.5.2.1</span> <strong><code>dplyr</code></strong></h4>
</div>
<div id="tidyr" class="section level4">
<h4><span class="header-section-number">1.5.2.2</span> <strong><code>tidyr</code></strong></h4>
</div>
<div id="janitor" class="section level4">
<h4><span class="header-section-number">1.5.2.3</span> <strong><code>janitor</code></strong></h4>
</div>
<div id="forcats" class="section level4">
<h4><span class="header-section-number">1.5.2.4</span> <strong><code>forcats</code></strong></h4>
</div>
<div id="stringr" class="section level4">
<h4><span class="header-section-number">1.5.2.5</span> <strong><code>stringr</code></strong></h4>
</div>
<div id="lubridate" class="section level4">
<h4><span class="header-section-number">1.5.2.6</span> <strong><code>lubridate</code></strong></h4>
</div>
<div id="glue" class="section level4">
<h4><span class="header-section-number">1.5.2.7</span> <strong><code>glue</code></strong></h4>
</div>
<div id="skimr" class="section level4">
<h4><span class="header-section-number">1.5.2.8</span> <strong><code>skimr</code></strong></h4>
</div>
<div id="tidytext" class="section level4">
<h4><span class="header-section-number">1.5.2.9</span> <strong><code>tidytext</code></strong></h4>
</div>
<div id="purrr" class="section level4">
<h4><span class="header-section-number">1.5.2.10</span> <strong><code>purrr</code></strong></h4>
</div>
</div>
<div id="data-visualization" class="section level3">
<h3><span class="header-section-number">1.5.3</span> Data Visualization</h3>
<div id="ggplot2" class="section level4">
<h4><span class="header-section-number">1.5.3.1</span> <strong><code>ggplot2</code></strong></h4>
</div>
<div id="kableextra" class="section level4">
<h4><span class="header-section-number">1.5.3.2</span> <strong><code>kableExtra</code></strong></h4>
</div>
<div id="ggrepel" class="section level4">
<h4><span class="header-section-number">1.5.3.3</span> <strong><code>ggrepel</code></strong></h4>
</div>
<div id="cowplot" class="section level4">
<h4><span class="header-section-number">1.5.3.4</span> <strong><code>cowplot</code></strong></h4>
</div>
<div id="patchwork" class="section level4">
<h4><span class="header-section-number">1.5.3.5</span> <strong><code>patchwork</code></strong></h4>
</div>
<div id="gganimate" class="section level4">
<h4><span class="header-section-number">1.5.3.6</span> <strong><code>gganimate</code></strong></h4>
</div>
</div>
<div id="data-modeling" class="section level3">
<h3><span class="header-section-number">1.5.4</span> Data Modeling</h3>
<div id="the-tidymodels-ecosystem" class="section level4">
<h4><span class="header-section-number">1.5.4.1</span> The <code>tidymodels</code> ecosystem</h4>
</div>
<div id="inferential-packages-broom-and-infer" class="section level4">
<h4><span class="header-section-number">1.5.4.2</span> Inferential packages: <code>broom</code> and <code>infer</code></h4>
</div>
<div id="tidyverts-tsibble-feasts-and-fable" class="section level4">
<h4><span class="header-section-number">1.5.4.3</span> tidyverts: tsibble, feasts, and fable</h4>
</div>
</div>
</div>
<div id="data-science-project-organization" class="section level2">
<h2><span class="header-section-number">1.6</span> Data Science Project Organization</h2>
<div id="rstudio-projects" class="section level3">
<h3><span class="header-section-number">1.6.1</span> RStudio Projects</h3>
</div>
<div id="file-paths" class="section level3">
<h3><span class="header-section-number">1.6.2</span> File Paths</h3>
<div id="relative-paths" class="section level4">
<h4><span class="header-section-number">1.6.2.1</span> Relative Paths</h4>
</div>
<div id="absolute-paths" class="section level4">
<h4><span class="header-section-number">1.6.2.2</span> Absolute Paths</h4>
</div>
<div id="path-summary" class="section level4">
<h4><span class="header-section-number">1.6.2.3</span> Path Summary</h4>
</div>
</div>
<div id="the-here-package" class="section level3">
<h3><span class="header-section-number">1.6.3</span> The <code>here</code> package</h3>
<div id="setting-your-project-directory" class="section level4">
<h4><span class="header-section-number">1.6.3.1</span> Setting your project directory</h4>
</div>
<div id="get-files-paths-using-here" class="section level4">
<h4><span class="header-section-number">1.6.3.2</span> Get files paths using <code>here()</code></h4>
</div>
<div id="save-and-load-files-using-here" class="section level4">
<h4><span class="header-section-number">1.6.3.3</span> Save and load files using <code>here()</code></h4>
</div>
<div id="where-you-should-use-this" class="section level4">
<h4><span class="header-section-number">1.6.3.4</span> Where you should use this</h4>
</div>
<div id="the-utility-of-the-here-package" class="section level4">
<h4><span class="header-section-number">1.6.3.5</span> The utility of the <code>here</code> package</h4>
</div>
</div>
<div id="file-naming" class="section level3">
<h3><span class="header-section-number">1.6.4</span> File Naming</h3>
<div id="good-file-names" class="section level4">
<h4><span class="header-section-number">1.6.4.1</span> Good File Names</h4>
</div>
<div id="machine-readable-files" class="section level4">
<h4><span class="header-section-number">1.6.4.2</span> Machine readable files</h4>
</div>
<div id="human-readable-files" class="section level4">
<h4><span class="header-section-number">1.6.4.3</span> Human readable files</h4>
</div>
<div id="be-nicely-ordered" class="section level4">
<h4><span class="header-section-number">1.6.4.4</span> Be nicely ordered</h4>
</div>
</div>
<div id="project-template-everything-in-its-place" class="section level3">
<h3><span class="header-section-number">1.6.5</span> Project Template: Everything In Its Place</h3>
</div>
</div>
<div id="data-science-workflows" class="section level2">
<h2><span class="header-section-number">1.7</span> Data Science Workflows</h2>
</div>
<div id="case-studies" class="section level2">
<h2><span class="header-section-number">1.8</span> Case Studies</h2>
<div id="case-study-1-health-expenditures" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Case Study #1: Health Expenditures</h3>
<div id="data-healthcare" class="section level4">
<h4><span class="header-section-number">1.8.1.1</span> Data: Healthcare</h4>
</div>
</div>
<div id="case-study-2-firearms" class="section level3">
<h3><span class="header-section-number">1.8.2</span> Case Study #2: Firearms</h3>
<div id="question" class="section level4">
<h4><span class="header-section-number">1.8.2.1</span> Question</h4>
</div>
<div id="data" class="section level4">
<h4><span class="header-section-number">1.8.2.2</span> Data</h4>
<!--chapter:end:01-intro.Rmd-->
</div>
</div>
</div>
</div>
<div id="get-data" class="section level1">
<h1><span class="header-section-number">2</span> Importing Data in the Tidyverse</h1>
<p>Placeholder</p>
<div id="about-this-course-1" class="section level2">
<h2><span class="header-section-number">2.1</span> About This Course</h2>
</div>
<div id="tibbles" class="section level2">
<h2><span class="header-section-number">2.2</span> Tibbles</h2>
<div id="how-tibbles-differ-from-data.frame" class="section level3">
<h3><span class="header-section-number">2.2.1</span> How tibbles differ from data.frame</h3>
</div>
<div id="creating-a-tibble" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Creating a tibble</h3>
<div id="as_tibble" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> <code>as_tibble()</code></h4>
</div>
<div id="tibble-1" class="section level4">
<h4><span class="header-section-number">2.2.2.2</span> <code>tibble()</code></h4>
</div>
</div>
<div id="subsetting" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Subsetting</h3>
</div>
</div>
<div id="spreadsheets" class="section level2">
<h2><span class="header-section-number">2.3</span> Spreadsheets</h2>
<div id="excel-files" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Excel files</h3>
<div id="reading-excel-files-into-r" class="section level4">
<h4><span class="header-section-number">2.3.1.1</span> Reading Excel files into R</h4>
</div>
</div>
<div id="google-sheets" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Google Sheets</h3>
<div id="the-googlesheets4-package" class="section level4">
<h4><span class="header-section-number">2.3.2.1</span> The <code>googlesheets4</code> package</h4>
<div id="getting-started-with-googlesheets4" class="section level5">
<h5><span class="header-section-number">2.3.2.1.1</span> Getting Started with <code>googlesheets4</code></h5>
</div>
<div id="navigating-googlesheets4gs4_find" class="section level5">
<h5><span class="header-section-number">2.3.2.1.2</span> Navigating <code>googlesheets4</code>:<code>gs4_find()</code></h5>
</div>
<div id="reading-data-in-using-googlesheetsgs_read" class="section level5">
<h5><span class="header-section-number">2.3.2.1.3</span> Reading data in using <code>googlesheets</code>:<code>gs_read()</code></h5>
</div>
</div>
</div>
</div>
<div id="csvs" class="section level2">
<h2><span class="header-section-number">2.4</span> CSVs</h2>
<div id="downloading-csv-files" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Downloading CSV files</h3>
</div>
<div id="reading-csvs-into-r" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Reading CSVs into R</h3>
</div>
</div>
<div id="tsvs" class="section level2">
<h2><span class="header-section-number">2.5</span> TSVs</h2>
<div id="reading-tsvs-into-r" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Reading TSVs into R</h3>
</div>
</div>
<div id="delimited-files" class="section level2">
<h2><span class="header-section-number">2.6</span> Delimited Files</h2>
<div id="reading-delimited-files-into-r" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Reading Delimited Files into R</h3>
</div>
</div>
<div id="exporting-data-from-r" class="section level2">
<h2><span class="header-section-number">2.7</span> Exporting Data from R</h2>
</div>
<div id="json" class="section level2">
<h2><span class="header-section-number">2.8</span> JSON</h2>
</div>
<div id="xml" class="section level2">
<h2><span class="header-section-number">2.9</span> XML</h2>
</div>
<div id="databases" class="section level2">
<h2><span class="header-section-number">2.10</span> Databases</h2>
<div id="relational-data" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Relational Data</h3>
<div id="why-relational-data" class="section level4">
<h4><span class="header-section-number">2.10.1.1</span> Why relational data?</h4>
</div>
</div>
<div id="relational-databases-sql" class="section level3">
<h3><span class="header-section-number">2.10.2</span> Relational Databases: <code>SQL</code></h3>
</div>
<div id="connecting-to-databases-rsqlite" class="section level3">
<h3><span class="header-section-number">2.10.3</span> Connecting to Databases: <code>RSQLite</code></h3>
</div>
<div id="working-with-relational-data-dplyr-dbplyr" class="section level3">
<h3><span class="header-section-number">2.10.4</span> Working with Relational Data: <code>dplyr</code> &amp; <code>dbplyr</code></h3>
</div>
<div id="mutating-joins" class="section level3">
<h3><span class="header-section-number">2.10.5</span> Mutating Joins</h3>
<div id="inner-join" class="section level4">
<h4><span class="header-section-number">2.10.5.1</span> Inner Join</h4>
</div>
<div id="left-join" class="section level4">
<h4><span class="header-section-number">2.10.5.2</span> Left Join</h4>
</div>
<div id="right-join" class="section level4">
<h4><span class="header-section-number">2.10.5.3</span> Right Join</h4>
</div>
<div id="full-join" class="section level4">
<h4><span class="header-section-number">2.10.5.4</span> Full Join</h4>
</div>
<div id="mutating-joins-summary" class="section level4">
<h4><span class="header-section-number">2.10.5.5</span> Mutating Joins Summary</h4>
</div>
</div>
<div id="filtering-joins" class="section level3">
<h3><span class="header-section-number">2.10.6</span> Filtering Joins</h3>
</div>
<div id="how-to-connect-to-a-database-online" class="section level3">
<h3><span class="header-section-number">2.10.7</span> How to Connect to a Database Online</h3>
</div>
</div>
<div id="web-scraping" class="section level2">
<h2><span class="header-section-number">2.11</span> Web Scraping</h2>
<div id="rvest-basics" class="section level3">
<h3><span class="header-section-number">2.11.1</span> <code>rvest</code> Basics</h3>
</div>
<div id="selectorgadget" class="section level3">
<h3><span class="header-section-number">2.11.2</span> SelectorGadget</h3>
</div>
<div id="web-scraping-example" class="section level3">
<h3><span class="header-section-number">2.11.3</span> Web Scraping Example</h3>
<div id="using-selectorgadget" class="section level4">
<h4><span class="header-section-number">2.11.3.1</span> Using SelectorGadget</h4>
</div>
<div id="using-rvest" class="section level4">
<h4><span class="header-section-number">2.11.3.2</span> Using <code>rvest</code></h4>
</div>
</div>
<div id="a-final-note-selectorgadget" class="section level3">
<h3><span class="header-section-number">2.11.4</span> A final note: SelectorGadget</h3>
</div>
</div>
<div id="apis" class="section level2">
<h2><span class="header-section-number">2.12</span> APIs</h2>
<div id="getting-data-httr" class="section level3">
<h3><span class="header-section-number">2.12.1</span> Getting Data: <code>httr</code></h3>
</div>
<div id="example-1-githubs-api" class="section level3">
<h3><span class="header-section-number">2.12.2</span> Example 1: GitHub’s API</h3>
<div id="api-endpoint" class="section level4">
<h4><span class="header-section-number">2.12.2.1</span> API Endpoint</h4>
</div>
<div id="api-request-get" class="section level4">
<h4><span class="header-section-number">2.12.2.2</span> API request: <code>GET()</code></h4>
</div>
<div id="api-response-content" class="section level4">
<h4><span class="header-section-number">2.12.2.3</span> API response: <code>content()</code></h4>
</div>
</div>
<div id="example-2-obtaining-a-csv" class="section level3">
<h3><span class="header-section-number">2.12.3</span> Example 2: Obtaining a CSV</h3>
</div>
<div id="read_csv-from-a-url" class="section level3">
<h3><span class="header-section-number">2.12.4</span> <code>read_csv()</code> from a URL</h3>
</div>
<div id="api-keys" class="section level3">
<h3><span class="header-section-number">2.12.5</span> API keys</h3>
</div>
</div>
<div id="foreign-formats" class="section level2">
<h2><span class="header-section-number">2.13</span> Foreign Formats</h2>
<div id="haven-1" class="section level3">
<h3><span class="header-section-number">2.13.1</span> <code>haven</code></h3>
</div>
</div>
<div id="images" class="section level2">
<h2><span class="header-section-number">2.14</span> Images</h2>
<div id="reading-images-in-r" class="section level4">
<h4><span class="header-section-number">2.14.0.1</span> Reading Images in R</h4>
</div>
</div>
<div id="googledrive-1" class="section level2">
<h2><span class="header-section-number">2.15</span> <code>googledrive</code></h2>
</div>
<div id="case-studies-1" class="section level2">
<h2><span class="header-section-number">2.16</span> Case Studies</h2>
<div id="case-study-1-health-expenditures-1" class="section level3">
<h3><span class="header-section-number">2.16.1</span> Case Study #1: Health Expenditures</h3>
<div id="healthcare-coverage-data" class="section level4">
<h4><span class="header-section-number">2.16.1.1</span> Healthcare Coverage Data</h4>
</div>
<div id="healthcare-spending-data" class="section level4">
<h4><span class="header-section-number">2.16.1.2</span> Healthcare Spending Data</h4>
</div>
</div>
<div id="case-study-2-firearms-1" class="section level3">
<h3><span class="header-section-number">2.16.2</span> Case Study #2: Firearms</h3>
<div id="census-data" class="section level4">
<h4><span class="header-section-number">2.16.2.1</span> Census Data</h4>
</div>
<div id="counted-data" class="section level4">
<h4><span class="header-section-number">2.16.2.2</span> Counted Data</h4>
</div>
<div id="suicide-data" class="section level4">
<h4><span class="header-section-number">2.16.2.3</span> Suicide Data</h4>
</div>
<div id="brady-data" class="section level4">
<h4><span class="header-section-number">2.16.2.4</span> Brady Data</h4>
</div>
<div id="crime-data" class="section level4">
<h4><span class="header-section-number">2.16.2.5</span> Crime Data</h4>
</div>
<div id="land-area-data" class="section level4">
<h4><span class="header-section-number">2.16.2.6</span> Land Area Data</h4>
</div>
<div id="unemployment-data" class="section level4">
<h4><span class="header-section-number">2.16.2.7</span> Unemployment Data</h4>
<!--chapter:end:02-get-data.Rmd-->
</div>
</div>
</div>
</div>
<div id="wrangle-data" class="section level1">
<h1><span class="header-section-number">3</span> Wrangling Data in the Tidyverse</h1>
<p>Placeholder</p>
<div id="about-this-course-2" class="section level2">
<h2><span class="header-section-number">3.1</span> About This Course</h2>
</div>
<div id="tidy-data-review" class="section level2">
<h2><span class="header-section-number">3.2</span> Tidy Data Review</h2>
</div>
<div id="reshaping-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Reshaping Data</h2>
<div id="wide-data" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Wide Data</h3>
</div>
<div id="long-data" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Long Data</h3>
</div>
<div id="reshaping-the-data" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Reshaping the Data</h3>
<div id="tidyr-1" class="section level4">
<h4><span class="header-section-number">3.3.3.1</span> <code>tidyr</code></h4>
<div id="pivot_longer" class="section level5">
<h5><span class="header-section-number">3.3.3.1.1</span> <code>pivot_longer()</code></h5>
</div>
<div id="pivot_wider" class="section level5">
<h5><span class="header-section-number">3.3.3.1.2</span> <code>pivot_wider()</code></h5>
</div>
</div>
</div>
</div>
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">3.4</span> Data Wrangling</h2>
<div id="r-packages" class="section level3">
<h3><span class="header-section-number">3.4.1</span> R Packages</h3>
<div id="dplyr-1" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> <code>dplyr</code></h4>
</div>
<div id="tidyr-2" class="section level4">
<h4><span class="header-section-number">3.4.1.2</span> <code>tidyr</code></h4>
</div>
<div id="janitor-1" class="section level4">
<h4><span class="header-section-number">3.4.1.3</span> <code>janitor</code></h4>
</div>
<div id="skimr-1" class="section level4">
<h4><span class="header-section-number">3.4.1.4</span> <code>skimr</code></h4>
</div>
</div>
<div id="the-pipe-operator" class="section level3">
<h3><span class="header-section-number">3.4.2</span> The Pipe Operator</h3>
</div>
<div id="filtering-data" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Filtering Data</h3>
<div id="filtering-rows" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Filtering Rows</h4>
</div>
<div id="selecting-columns" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Selecting Columns</h4>
</div>
<div id="renaming-columns" class="section level4">
<h4><span class="header-section-number">3.4.3.3</span> Renaming Columns</h4>
</div>
</div>
<div id="reordering" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Reordering</h3>
<div id="reordering-columns" class="section level4">
<h4><span class="header-section-number">3.4.4.1</span> Reordering Columns</h4>
</div>
<div id="reordering-rows" class="section level4">
<h4><span class="header-section-number">3.4.4.2</span> Reordering Rows</h4>
</div>
</div>
<div id="creating-new-columns" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Creating New Columns</h3>
</div>
<div id="separating-columns" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Separating Columns</h3>
</div>
<div id="merging-columns" class="section level3">
<h3><span class="header-section-number">3.4.7</span> Merging Columns</h3>
</div>
<div id="cleaning-column-names" class="section level3">
<h3><span class="header-section-number">3.4.8</span> Cleaning Column Names</h3>
</div>
<div id="combining-data-across-data-frames" class="section level3">
<h3><span class="header-section-number">3.4.9</span> Combining Data Across Data Frames</h3>
</div>
<div id="grouping-data" class="section level3">
<h3><span class="header-section-number">3.4.10</span> Grouping Data</h3>
<div id="group_by" class="section level4">
<h4><span class="header-section-number">3.4.10.1</span> <code>group_by()</code></h4>
</div>
</div>
<div id="summarizing-data" class="section level3">
<h3><span class="header-section-number">3.4.11</span> Summarizing Data</h3>
<div id="summarize" class="section level4">
<h4><span class="header-section-number">3.4.11.1</span> <code>summarize()</code></h4>
</div>
<div id="tabyl" class="section level4">
<h4><span class="header-section-number">3.4.11.2</span> <code>tabyl()</code></h4>
</div>
<div id="tally" class="section level4">
<h4><span class="header-section-number">3.4.11.3</span> <code>tally()</code></h4>
</div>
<div id="add_tally" class="section level4">
<h4><span class="header-section-number">3.4.11.4</span> <code>add_tally()</code></h4>
</div>
<div id="count" class="section level4">
<h4><span class="header-section-number">3.4.11.5</span> <code>count()</code></h4>
</div>
<div id="add_count" class="section level4">
<h4><span class="header-section-number">3.4.11.6</span> <code>add_count()</code></h4>
</div>
<div id="get_dupes" class="section level4">
<h4><span class="header-section-number">3.4.11.7</span> <code>get_dupes()</code></h4>
</div>
<div id="skim" class="section level4">
<h4><span class="header-section-number">3.4.11.8</span> <code>skim()</code></h4>
</div>
<div id="summary-1" class="section level4">
<h4><span class="header-section-number">3.4.11.9</span> <code>summary()</code></h4>
</div>
</div>
<div id="operations-across-columns" class="section level3">
<h3><span class="header-section-number">3.4.12</span> Operations Across Columns</h3>
</div>
</div>
<div id="working-with-factors" class="section level2">
<h2><span class="header-section-number">3.5</span> Working With Factors</h2>
<div id="factor-review" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Factor Review</h3>
</div>
<div id="manually-changing-the-labels-of-factor-levels-fct_relevel" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Manually Changing the Labels of Factor Levels: <code>fct_relevel()</code></h3>
</div>
<div id="keeping-the-order-of-the-factor-levels-fct_inorder" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Keeping the Order of the Factor Levels: <code>fct_inorder()</code></h3>
</div>
<div id="advanced-factoring" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Advanced Factoring</h3>
</div>
<div id="re-ordering-factor-levels-by-frequency-fct_infreq" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Re-ordering Factor Levels by Frequency: <code>fct_infreq()</code></h3>
</div>
<div id="reversing-order-levels-fct_rev" class="section level3">
<h3><span class="header-section-number">3.5.6</span> Reversing Order Levels: <code>fct_rev()</code></h3>
</div>
<div id="re-ordering-factor-levels-by-another-variable-fct_reorder" class="section level3">
<h3><span class="header-section-number">3.5.7</span> Re-ordering Factor Levels by Another Variable: <code>fct_reorder()</code></h3>
</div>
<div id="combining-several-levels-into-one-fct_recode" class="section level3">
<h3><span class="header-section-number">3.5.8</span> Combining Several Levels into One: <code>fct_recode()</code></h3>
</div>
<div id="converting-numeric-levels-to-factors-ifelse-factor" class="section level3">
<h3><span class="header-section-number">3.5.9</span> Converting Numeric Levels to Factors: <code>ifelse()</code> + <code>factor()</code></h3>
</div>
</div>
<div id="working-with-dates-and-times" class="section level2">
<h2><span class="header-section-number">3.6</span> Working With Dates and Times</h2>
<div id="dates-and-times-basics" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Dates and Times Basics</h3>
</div>
<div id="creating-dates-and-date-time-objects" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Creating Dates and Date-Time Objects</h3>
<div id="from-strings" class="section level4">
<h4><span class="header-section-number">3.6.2.1</span> From strings</h4>
</div>
<div id="from-individual-parts" class="section level4">
<h4><span class="header-section-number">3.6.2.2</span> From individual parts</h4>
</div>
</div>
<div id="working-with-dates" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Working with Dates</h3>
<div id="getting-components-of-dates" class="section level4">
<h4><span class="header-section-number">3.6.3.1</span> Getting components of dates</h4>
</div>
</div>
<div id="time-spans" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Time Spans</h3>
</div>
</div>
<div id="working-with-strings" class="section level2">
<h2><span class="header-section-number">3.7</span> Working With Strings</h2>
<div id="stringr-1" class="section level3">
<h3><span class="header-section-number">3.7.1</span> <code>stringr</code></h3>
<div id="available-functions" class="section level4">
<h4><span class="header-section-number">3.7.1.1</span> Available functions</h4>
</div>
</div>
<div id="string-basics" class="section level3">
<h3><span class="header-section-number">3.7.2</span> String Basics</h3>
<div id="string-length" class="section level4">
<h4><span class="header-section-number">3.7.2.1</span> String length</h4>
</div>
<div id="combining-strings-str_c" class="section level4">
<h4><span class="header-section-number">3.7.2.2</span> Combining strings: <code>str_c()</code></h4>
</div>
<div id="subsetting-strings-str_sub" class="section level4">
<h4><span class="header-section-number">3.7.2.3</span> Subsetting strings: <code>str_sub()</code></h4>
</div>
<div id="string-sorting-str_sort" class="section level4">
<h4><span class="header-section-number">3.7.2.4</span> String sorting: <code>str_sort()</code></h4>
</div>
</div>
<div id="regular-expressions" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Regular Expressions</h3>
<div id="anchors" class="section level4">
<h4><span class="header-section-number">3.7.3.1</span> Anchors</h4>
</div>
<div id="show-matches-str_view" class="section level4">
<h4><span class="header-section-number">3.7.3.2</span> Show matches: <code>str_view()</code></h4>
</div>
<div id="count-matches-str_count" class="section level4">
<h4><span class="header-section-number">3.7.3.3</span> Count matches: <code>str_count()</code></h4>
</div>
<div id="detect-matches-str_detect" class="section level4">
<h4><span class="header-section-number">3.7.3.4</span> Detect matches: <code>str_detect()</code></h4>
</div>
<div id="subset-matches-str_subset" class="section level4">
<h4><span class="header-section-number">3.7.3.5</span> Subset matches: <code>str_subset()</code></h4>
</div>
<div id="extract-matches-str_extract" class="section level4">
<h4><span class="header-section-number">3.7.3.6</span> Extract matches: <code>str_extract()</code></h4>
</div>
<div id="replace-matches-str_replace" class="section level4">
<h4><span class="header-section-number">3.7.3.7</span> Replace matches: <code>str_replace()</code></h4>
</div>
<div id="common-regular-expressions" class="section level4">
<h4><span class="header-section-number">3.7.3.8</span> Common regular expressions</h4>
<div id="searching-for-characters" class="section level5">
<h5><span class="header-section-number">3.7.3.8.1</span> Searching for characters</h5>
</div>
<div id="searching-for-anything-other-than-a-set-of-characters" class="section level5">
<h5><span class="header-section-number">3.7.3.8.2</span> Searching for anything <em>other</em> than a set of characters</h5>
</div>
<div id="search-for-digits" class="section level5">
<h5><span class="header-section-number">3.7.3.8.3</span> Search for digits</h5>
</div>
<div id="search-for-whitespace" class="section level5">
<h5><span class="header-section-number">3.7.3.8.4</span> Search for whitespace</h5>
</div>
<div id="identify-any-character-except-newline" class="section level5">
<h5><span class="header-section-number">3.7.3.8.5</span> Identify any character (except newline)</h5>
</div>
</div>
<div id="repetition-within-regular-expressions" class="section level4">
<h4><span class="header-section-number">3.7.3.9</span> Repetition within regular expressions</h4>
<div id="examples-of-repetition-within-regular-expressions" class="section level5">
<h5><span class="header-section-number">3.7.3.9.1</span> Examples of repetition within regular expressions</h5>
</div>
</div>
</div>
<div id="glue-1" class="section level3">
<h3><span class="header-section-number">3.7.4</span> <code>glue</code></h3>
</div>
</div>
<div id="working-with-text" class="section level2">
<h2><span class="header-section-number">3.8</span> Working With Text</h2>
<div id="tidy-text-format" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Tidy Text Format</h3>
<div id="tokenization" class="section level4">
<h4><span class="header-section-number">3.8.1.1</span> Tokenization</h4>
</div>
</div>
<div id="sentiment-analysis" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Sentiment Analysis</h3>
</div>
<div id="word-and-document-frequency" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Word and Document Frequency</h3>
</div>
</div>
<div id="functional-programming" class="section level2">
<h2><span class="header-section-number">3.9</span> Functional Programming</h2>
<div id="for-loops-vs.-functionals" class="section level3">
<h3><span class="header-section-number">3.9.1</span> For Loops vs. Functionals</h3>
<div id="copy-paste-approach" class="section level4">
<h4><span class="header-section-number">3.9.1.1</span> Copy + Paste Approach</h4>
</div>
<div id="for-loop-approach" class="section level4">
<h4><span class="header-section-number">3.9.1.2</span> For Loop Approach</h4>
</div>
<div id="function-approach" class="section level4">
<h4><span class="header-section-number">3.9.1.3</span> Function Approach</h4>
</div>
<div id="purrr-approach" class="section level4">
<h4><span class="header-section-number">3.9.1.4</span> <code>purrr</code> Approach</h4>
</div>
</div>
<div id="map-functions" class="section level3">
<h3><span class="header-section-number">3.9.2</span> <code>map</code> Functions</h3>
</div>
<div id="multiple-vectors" class="section level3">
<h3><span class="header-section-number">3.9.3</span> Multiple Vectors</h3>
<div id="map2" class="section level4">
<h4><span class="header-section-number">3.9.3.1</span> <code>map2</code></h4>
</div>
<div id="pmap" class="section level4">
<h4><span class="header-section-number">3.9.3.2</span> <code>pmap</code></h4>
</div>
</div>
<div id="anonymous-functions" class="section level3">
<h3><span class="header-section-number">3.9.4</span> Anonymous Functions</h3>
</div>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2><span class="header-section-number">3.10</span> Exploratory Data Analysis</h2>
<div id="general-principles-of-eda" class="section level3">
<h3><span class="header-section-number">3.10.1</span> General Principles of EDA</h3>
</div>
<div id="analyzing-json-in-r" class="section level3">
<h3><span class="header-section-number">3.10.2</span> Analyzing JSON in R</h3>
</div>
<div id="analyzing-xml-in-r" class="section level3">
<h3><span class="header-section-number">3.10.3</span> Analyzing XML in R</h3>
</div>
</div>
<div id="case-studies-2" class="section level2">
<h2><span class="header-section-number">3.11</span> Case Studies</h2>
<div id="case-study-1-health-expenditures-2" class="section level3">
<h3><span class="header-section-number">3.11.1</span> Case Study #1: Health Expenditures</h3>
<div id="healthcare-coverage-data-1" class="section level4">
<h4><span class="header-section-number">3.11.1.1</span> Healthcare Coverage Data</h4>
<div id="states-data" class="section level5">
<h5><span class="header-section-number">3.11.1.1.1</span> States Data</h5>
</div>
</div>
<div id="healthcare-spending-data-1" class="section level4">
<h4><span class="header-section-number">3.11.1.2</span> Healthcare Spending Data</h4>
</div>
<div id="join-the-data" class="section level4">
<h4><span class="header-section-number">3.11.1.3</span> Join the Data</h4>
</div>
</div>
<div id="case-study-2-firearms-2" class="section level3">
<h3><span class="header-section-number">3.11.2</span> Case Study #2: Firearms</h3>
<div id="census-data-1" class="section level4">
<h4><span class="header-section-number">3.11.2.1</span> Census Data</h4>
</div>
<div id="violent-crime" class="section level4">
<h4><span class="header-section-number">3.11.2.2</span> Violent Crime</h4>
</div>
<div id="brady-scores" class="section level4">
<h4><span class="header-section-number">3.11.2.3</span> Brady Scores</h4>
</div>
<div id="the-counted-fatal-shootings" class="section level4">
<h4><span class="header-section-number">3.11.2.4</span> The Counted Fatal Shootings</h4>
</div>
<div id="unemployment-data-1" class="section level4">
<h4><span class="header-section-number">3.11.2.5</span> Unemployment Data</h4>
</div>
<div id="population-density-2015" class="section level4">
<h4><span class="header-section-number">3.11.2.6</span> Population Density: 2015</h4>
</div>
<div id="firearm-ownership" class="section level4">
<h4><span class="header-section-number">3.11.2.7</span> Firearm Ownership</h4>
<!--chapter:end:03-tidying.Rmd-->
</div>
</div>
</div>
</div>
<div id="dataviz" class="section level1">
<h1><span class="header-section-number">4</span> Visualizing Data in the Tidyverse</h1>
<div id="about-this-course-3" class="section level2">
<h2><span class="header-section-number">4.1</span> About This Course</h2>
<p>Data visualization is a critical part of any data science project. Once data have been imported and wrangled into place, visualizing your data can help you get a handle on what’s going on in the dataset. Similarly, once you’ve completed your analysis and are ready to present your findings, data visualizations are a highly effective way to communicate your results to others. In this course we will cover what data visualization is and define some of the basic types of data visualizations.</p>
<p>In this course you will learn about the ggplot2 R package, a powerful set of tools for making stunning data graphics that has become the industry standard. You will learn about different types of plots, how to construct effect plots, and what makes for a successful or unsuccessful visualization.</p>
<p>In this specialization we assume familiarity with the R programming language. If you are not yet familiar with R, we suggest you first complete <a href="https://www.coursera.org/learn/r-programming">R Programming</a> before returning to complete this course.</p>
</div>
<div id="data-visualization-background" class="section level2">
<h2><span class="header-section-number">4.2</span> Data Visualization Background</h2>
<p>At its core, the term ‘data visualization’ refers to any visual display of data that helps us understand the underlying data better. This can be a plot or figure of some sort or a table that summarizes the data. Generally, there are a few characteristics of all good plots.</p>
<div id="general-features-of-plots" class="section level3">
<h3><span class="header-section-number">4.2.1</span> General Features of Plots</h3>
<p>Good plots have a number of features. While not exhaustive, good plots have:</p>
<ol style="list-style-type: decimal">
<li>Clearly-labeled axes.</li>
<li>Text that are large enough to see.</li>
<li>Axes that are not misleading.</li>
<li>Data that are displayed appropriately considering the type of data you have.</li>
</ol>
<p>More specifically, however, there are two general approaches to data visualization: <strong>exploratory plots</strong> and <strong>explanatory plots</strong>.</p>
<div id="exploratory-plots" class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> Exploratory Plots</h4>
<p>These are <strong>data displays to help you better understand and discover hidden patterns in the data</strong> you’re working with. These won’t be the prettiest plots, but they will be incredibly helpful. Exploratory visualizations have a number of general characteristics:</p>
<ul>
<li>They are made quickly.</li>
<li>You’ll make a large number of them.</li>
<li>The axes and legends are cleaned up.</li>
</ul>
<p>Below we have a graph where the axes are labeled and general pattern can be determined. This is a great example of an exploratory plot. It lets you the analyst know what’s going on in your data, but it isn’t yet ready for a big presentation.</p>
<div class="figure">
<img src="images/gslides/172.png" alt="" />
<p class="caption">Exploratory Plot</p>
</div>
<p>As you’re trying to understand the data you have on hand, you’ll likely make a lot of plots and tables just to figure out to explore and understand the data. Because there are a lot of them and they’re for your use (rather than for communicating with others), you don’t have to spend all your time making them perfect. But, you do have to spend enough time to make sure that you’re drawing the right conclusions from this. Thus, you don’t have to spend a long time considering what colors are perfect on these, but you do want to make sure your axes are not cut off.</p>
<p>Other Exploratory Plotting Examples:
<a href="http://opensource.datacratic.com/mtlpy50/">Map of Reddit</a>
<a href="https://blog.datazar.com/exploratory-data-analysis-using-r-part-i-17e4e8e03961">Air Quality Data</a></p>
</div>
<div id="explanatory-plots" class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> Explanatory Plots</h4>
<p>These are data displays that aim to <strong>communicate insights to others</strong>. These are plots that you spend a lot of time making sure they’re easily interpretable by an audience. General characteristics of explanatory plots:</p>
<ul>
<li>They take a while to make.</li>
<li>There are only a few of these for each project.</li>
<li>You’ve spent a lot of time making sure the colors, labels, and sizes are all perfect for your needs.</li>
</ul>
<p>Here we see an improvement upon the exploratory plot we looked at previously. Here, the axis labels are more descriptive. All of the text is larger. The legend has been moved onto the plot. The points on the plot are larger. And, there is a title. All of these changes help to improve the plot, making it an explanatory plot that would be presentation-ready.</p>
<div class="figure">
<img src="images/gslides/173.png" alt="" />
<p class="caption">Explanatory Plots</p>
</div>
<p>Explanatory plots are made after you’ve done an analysis and once you really understand the data you have. The goal of these plots is to communicate your findings clearly to others. To do so, you want to make sure these plots are made carefully - the axis labels should all be clear, the labels should all be large enough to read, the colors should all be carefully chosen, etc.. As this takes times and because you do not want to overwhelm your audience, you only want to have a few of these for each project. We often refer to these as “publication ready” plots. These are the plots that would make it into an article at the New York Times or in your presentation to your bosses.</p>
<p>Other Explanatory Plotting Examples:</p>
<ul>
<li><a href="https://www.nytimes.com/interactive/2014/06/05/upshot/how-the-recession-reshaped-the-economy-in-255-charts.html">How the Recession Shaped the Economy (NYT)</a></li>
<li><a href="https://fivethirtyeight.com/features/america-should-have-stayed-home-this-flu-season/">2018 Flue Season (FiveThirtyEight)</a></li>
</ul>
</div>
</div>
</div>
<div id="plot-types" class="section level2">
<h2><span class="header-section-number">4.3</span> Plot Types</h2>
<p>Above we saw data displayed as both an exploratory plot and an explanatory plot. That plot was an example of a scatterplot. However, there are many types of plots that are helpful. We’ll discuss a few basic ones below and will include links to a few galleries where you can get a sense of the many different types of plots out there.</p>
<p>To do this, we’ll use the “Davis” dataset of the <code>carData</code> package which includes, height and weight information for 200 people.</p>
<p>To use this data first make sure the <code>carData</code> package is installed and load it.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#install.packages(carData)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(carData)</span>
<span id="cb1-3"><a href="#cb1-3"></a>Davis &lt;-<span class="st"> </span>carData<span class="op">::</span>Davis</span></code></pre></div>
<div class="figure">
<img src="images/gslides/174.png" alt="" />
<p class="caption">Dataset</p>
</div>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Histogram</h3>
<p>Histograms are helpful when you want to <strong>better understand what values you have in your dataset for a single set of numbers</strong>. For example, if you had a dataset with information about many people, you may want to know how tall the people in your dataset are. To quickly visualize this, you could use a histogram. Histograms let you know what range of values you have in your dataset. For example, below you can see that in this dataset, the height values range from around 50 to around 200 cm. The shape of the histogram also gives you information about the individuals in your dataset. The number of people at each height are also counted. So, the tallest bars show that there are about 40 people in the dataset whose height is between 165 and 170 cm. Finally, you can quickly tell, at a glance that most people in this dataset are at least 150 cm tall, but that there is at least one individually whose reported height is much lower.</p>
<div class="figure">
<img src="images/gslides/175.png" alt="" />
<p class="caption">Histogram</p>
</div>
</div>
<div id="densityplot" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Densityplot</h3>
<p>Densityplots are smoothed versions of histograms, visualizing the distribution of a continuous variable. These plots effectively visualize the distribution shape and are, unlike histograms, are not sensitive to the number of bins chosen for visualization.</p>
<div class="figure">
<img src="images/gslides/176.png" alt="" />
<p class="caption">Densityplot</p>
</div>
</div>
<div id="scatterplot" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Scatterplot</h3>
<p>Scatterplots are helpful when you have <strong>numerical values for two different pieces of information</strong> and you want to understand the relationship between those pieces of information. Here, each dot represents a different person in the dataset. The dot’s position on the graph represents that individual’s height and weight. Overall, in this dataset, we can see that, in general, the more someone weighs, the taller they are. Scatterplots, therefore help us at a glance better understand the relationship between two sets of numbers.</p>
<div class="figure">
<img src="images/gslides/177.png" alt="" />
<p class="caption">Scatter Plot</p>
</div>
</div>
<div id="barplot" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Barplot</h3>
<p>When you only have <strong>a single categorical variable that you want broken down and quantified by category</strong>, a barplot will be ideal. For example if you wanted to look at how many females and how many males you have in your dataset, you could use a barplot. The comparison in heights between bars clearly demonstrates that there are more females in this dataset than males.</p>
<div class="figure">
<img src="images/gslides/178.png" alt="" />
<p class="caption">Barplot</p>
</div>
<div id="grouped-barplot" class="section level4">
<h4><span class="header-section-number">4.3.4.1</span> Grouped Barplot</h4>
<p>Grouped barplots, like simple barplots, demonstrate the counts for a group; however, they break this down by an additional categorical variable. For example, here we see the number of individuals within each % category along the x-axis. But, these data are further broken down by gender (an additional categorical variable). Comparisons between bars that are side-by-side are made most easily by our visual system. So, it’s important to ensure that the bars you want viewers to be able to compare most easily are next to one another in this plot type.</p>
<div class="figure">
<img src="images/gslides/179.png" alt="" />
<p class="caption">Grouped Barplot</p>
</div>
</div>
<div id="stacked-barplot" class="section level4">
<h4><span class="header-section-number">4.3.4.2</span> Stacked Barplot</h4>
<p>Another common variation on barplots are stacked barplots. Stacked barplots take the information from a grouped barplot but stacks them on top of one another. This is most helpful when the bars add up to 100%, such as in a survey response where you’re measuring percent of respondents within each category. Otherwise, it can be hard to compare between the groups within each bar.</p>
<div class="figure">
<img src="images/gslides/180_update.png" alt="" />
<p class="caption">Stacked Barplot</p>
</div>
</div>
</div>
<div id="boxplot" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Boxplot</h3>
<p>Boxplots also summarize <strong>numerical values across a category</strong>; however, instead of just comparing the heights of the bar, they give us an idea of the range of values that each category can take. For example, if we wanted to compare the heights of men to the heights of women, we could do that with a boxplot.</p>
<div class="figure">
<img src="images/gslides/181.png" alt="" />
<p class="caption">Boxplot</p>
</div>
<p>To interpret a boxplot, there are a few places where we’ll want to focus our attention. For each category, the horizontal line through the middle of the box corresponds to the median value for that group. So, here, we can say that the median, or most typical height for females is about 165 cm. For males, this value is higher, just under 180 cm. Outside of the colored boxes, there are dashed lines. The ends of these lines correspond to the typical range of values. Here, we can see that females tend to have heights between 150 and 180cm. Lastly, when individuals have values outside the typical range, a boxplot will show these individuals as circles. These circles are referred to as outliers.</p>
</div>
<div id="line-plots" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Line Plots</h3>
<p>The final type of basic plot we’ll discuss here are line plots. Line plots are most effective at showing a <strong>quantitative trend over time</strong>.</p>
<div class="figure">
<img src="images/gslides/182_update.png" alt="" />
<p class="caption">Line Plot</p>
</div>
<div id="resources-to-look-at-these-and-other-types-of-plots" class="section level4">
<h4><span class="header-section-number">4.3.6.1</span> Resources to look at these and other types of plots:</h4>
<ul>
<li><a href="https://www.r-graph-gallery.com/">R Graph Gallery</a></li>
<li><a href="http://datavizproject.com/">Ferdio Data Visualization Catalog</a></li>
</ul>
</div>
</div>
</div>
<div id="making-good-plots" class="section level2">
<h2><span class="header-section-number">4.4</span> Making Good Plots</h2>
<p>The goal of data visualization in data analysis is to improve understanding of the data. As mentioned in the last lesson, this could mean improving our own understanding of the data <em>or</em> using visualization to improve someone else’s understanding of the data.</p>
<p>We discussed some general characteristics and basic types of plots in the last lesson, but here we will step through a number of general tips for making good plots.</p>
<p>When generating exploratory or explanatory plots, you’ll want to ensure information being displayed is being done so accurately and in a away that best reflects the reality within the dataset. Here, we provide a number of tips to keep in mind when generating plots.</p>
<div id="choose-the-right-type-of-plot" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Choose the Right Type of Plot</h3>
<p>If your goal is to allow the viewer to compare values across groups, pie charts should largely be avoided. This is because it’s easier for the human eye to differentiate between bar heights than it is between similarly-sized slices of a pie. Thinking about the best way to visualize your data before making the plot is an important step in the process of data visualization.</p>
<div class="figure">
<img src="images/gslides/183.png" alt="" />
<p class="caption">Choose an appropriate plot for the data you’re visualizing.</p>
</div>
</div>
<div id="be-mindful-when-choosing-colors" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Be Mindful When Choosing Colors</h3>
<p>Choosing colors that work for the story you’re trying to convey with your visualization is important. Avoiding colors that are hard to see on a screen or when projected, such as pastels, is a good idea. Additionally, red-green color blindness is common and leads to difficulty in distinguishing reds from greens. Simply avoiding making comparisons between these two colors is a good first step when visualizing data.</p>
<div class="figure">
<img src="images/gslides/184.png" alt="" />
<p class="caption">Choosing appropriate colors for visualizations is important</p>
</div>
<p>Beyond red-green color blindness, there is an entire group of experts out there in color theory.To learn more about available <a href="https://github.com/EmilHvitfeldt/r-color-palettes">color palettes in R</a> or to read more from a pro named Lisa Charlotte Rost <a href="https://lisacharlotterost.github.io/2016/04/22/Colors-for-DataVis/">talking about color choices in data visualization</a>, feel free to read more.</p>
</div>
<div id="label-the-axes" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Label the Axes</h3>
<p>Whether you’re making an exploratory or explanatory visualization, labeled axes are a must. They help tell the story of the figure. Making sure the axes are clearly labeled is also important. Rather than labeling the graph below with “h” and “g,” we chose the labels “height” and “gender,” making it clear to the viewer exactly what is being plotted.</p>
<div class="figure">
<img src="images/gslides/185.png" alt="" />
<p class="caption">Having descriptive labels on your axes is critical</p>
</div>
</div>
<div id="make-sure-the-text-is-readable" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Make Sure the Text is Readable</h3>
<p>Often text on plots is too small for viewers to read. By being mindful of the size of the text on your axes, in your legend, and used for your labels, your visualizations will be greatly improved.</p>
<div class="figure">
<img src="images/gslides/186.png" alt="" />
<p class="caption">On the right, we see that the text is easily readable</p>
</div>
</div>
<div id="make-sure-the-numbers-add-up" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Make Sure the Numbers Add Up</h3>
<p>When you’re making a plot that should sum to 100, make sure that it in fact does. Taking a look at visualizations after you make them to ensure that they make sense is an important part of the data visualization process.</p>
<div class="figure">
<img src="images/gslides/187.png" alt="" />
<p class="caption">At left, the pieces of the pie only add up to 95%. On the right, this error has been fixed and the pieces add up to 100%</p>
</div>
</div>
<div id="make-sure-the-numbers-and-plots-make-sense-together" class="section level3">
<h3><span class="header-section-number">4.4.6</span> Make Sure the Numbers and Plots Make Sense Together</h3>
<p>Another common error is having labels that don’t reflect the underlying graphic. For example, here, we can see on the left that the turquoise piece is more than half the graph, and thus the label 45% must be incorrect. At right, we see that the labels match what we see in the figure.</p>
<div class="figure">
<img src="images/gslides/188.png" alt="" />
<p class="caption">Checking to make sure the numbers and plot make sense together is important</p>
</div>
</div>
<div id="make-comparisons-easy-on-viewers" class="section level3">
<h3><span class="header-section-number">4.4.7</span> Make Comparisons Easy on Viewers</h3>
<p>There are many ways in which you can make comparisons easier on the viewer. For example, avoiding unnecessary whitespace between the bars on your graph can help viewers make comparisons between the bars on the barplot.</p>
<div class="figure">
<img src="images/gslides/189.png" alt="" />
<p class="caption">At left, there is extra white space between the bars of the plot that should be removed. On the right, we see an improved plot</p>
</div>
</div>
<div id="use-y-axes-that-start-at-zero" class="section level3">
<h3><span class="header-section-number">4.4.8</span> Use y-axes That Start at Zero</h3>
<p>Often, in an attempt to make differences between groups look larger than they are, y-axis will be started at a value other than zero. This is misleading. Y-axis for numerical information should start at zero.</p>
<div class="figure">
<img src="images/gslides/190.png" alt="" />
<p class="caption">At left, the differences between the vars appears larger than on the right; however, this is just because the y-axis starts at 200. The proper way to start this graph is to start the y-axis at 0.</p>
</div>
</div>
<div id="keep-it-simple" class="section level3">
<h3><span class="header-section-number">4.4.9</span> Keep It Simple</h3>
<p>The goal of data visualization is to improve understanding of data. Sometimes complicated visualizations cannot be avoided; however, when possible, keep it simple.</p>
<p>Here, the graphic on the left does not immediately convey a main point. It’s hard to interpret what each point means or what the story of this graphic is supposed to be. In contrast, the graphics on the right are simpler and each show a more obvious story. Make sure that your main point comes through:</p>
<div class="figure">
<img src="images/gslides/191_update.png" alt="" />
<p class="caption">Main point unclear</p>
</div>
<p>Similarly, the intention of your graphic should never be to mislead or confuse. Be sure that your data visualizations improve viewers’ understanding. Using unusual axes limits or point sizes, or using vague labels can make plots misleading. This plot creates an effective exclamation mark shape which is fun, but it is no longer clear what points correspond to what species. Furthermore, this plot makes it look like petal width is not very distinguishable across the different species (particularly for versicolor and virginica), which is the opposite of what the previous petal plot conveyed.</p>
<div class="figure">
<img src="images/gslides/192_update.png" alt="" />
<p class="caption">Confusion is conveyed here</p>
</div>
</div>
</div>
<div id="plot-generation-process" class="section level2">
<h2><span class="header-section-number">4.5</span> Plot Generation Process</h2>
<p>Having discussed some general guidelines, there are a number of questions you should ask yourself before making a plot. These have been nicely laid out in a <a href="https://blog.datawrapper.de/better-charts/">blog post</a> from the wonderful team at <a href="https://blog.datawrapper.de/">Chartable</a>, <a href="https://www.datawrapper.de/">Datawrapper’s</a> blog and we will summarize them here. The post argues that there are three main questions you should ask any time you create a visual display of your data. We will discuss these three questions below</p>
<div id="whats-your-point" class="section level3">
<h3><span class="header-section-number">4.5.1</span> What’s your point?</h3>
<p>Whenever you have data you’re trying to plot, think about what you’re actually trying to show. Once you’ve taken a look at your data, a good title for the plot can be helpful. Your title should <strong>tell viewers what they’ll see when they look at the plot</strong>.</p>
</div>
<div id="how-can-you-emphasize-your-point-in-your-chart" class="section level3">
<h3><span class="header-section-number">4.5.2</span> How can you emphasize your point in your chart?</h3>
<p>We talked about it in the last lesson, but an incredibly important decision is choosing an appropriate chart for the type of data you have. In the next section of this lesson, we’ll discuss what type of data are appropriate for each type of plot in R; however, for now, we’ll just focus on an iPhone data example. With this example, we’ll discuss that you can emphasize your point by:</p>
<ul>
<li>Adding data</li>
<li>Highlighting data with color</li>
<li>Annotating your plot</li>
</ul>
<div id="adding-data" class="section level4">
<h4><span class="header-section-number">4.5.2.1</span> Adding data</h4>
<p>In any plot that makes a specific claim, it usually important to show additional data as a reference for comparison. For example, if you were making a plot of that suggests that the iPhone has been Apple’s most successful product, it would be helpful for the plot to compare iPhone sales with other Apple products, say, the iPad or the iPod. By adding data about other Apple products over time, we can visualize just how successful the iPhone has been compared to other products.</p>
</div>
<div id="highlighting-data-with-color" class="section level4">
<h4><span class="header-section-number">4.5.2.2</span> Highlighting data with color</h4>
<p>Colors help direct viewers’ eyes to the most important parts of the figure. Colors tell your readers where to focus their attention. Grays help to tell viewers where to focus less of their attention, while other colors help to highlight the point your trying to make.</p>
</div>
<div id="annotate-your-plot" class="section level4">
<h4><span class="header-section-number">4.5.2.3</span> Annotate your plot</h4>
<p>By highlighting parts of your plot with arrows or text on your plot, you can further draw viewers’ attention to certain part of the plot. These are often details that are unnecessary in exploratory plots, where the goal is just to better understand the data, but are very helpful in explanatory plots, when you’re trying to draw conclusions from the plot.</p>
</div>
</div>
<div id="what-does-your-final-chart-show" class="section level3">
<h3><span class="header-section-number">4.5.3</span> What Does Your Final Chart Show?</h3>
<p>A plot title should first tell viewers what they would see in the plot. The second step is to show them with the plot. The third step is to make it extra clear to viewers what they should be seeing with descriptions, annotations, and legends. You explain to viewers what they should be seeing in the plot and the source of your data. Again, these are important pieces of creating a complete explanatory plot, but are not all necessary when making exploratory plots.</p>
<div id="write-precise-descriptions" class="section level4">
<h4><span class="header-section-number">4.5.3.1</span> Write precise descriptions</h4>
<p>Whether it’s a figure legend at the bottom of your plot, a subtitle explaining what data are plotted, or clear axes labels, text describing clearly what’s going on in your plot is important. Be sure that viewers are able to easily determine what each line or point on a plot represents.</p>
</div>
<div id="add-a-source" class="section level4">
<h4><span class="header-section-number">4.5.3.2</span> Add a source</h4>
<p>When finalizing an explanatory plot, be sure to source your data. It’s always best for readers to know where you obtained your data and what data are being used to create your plot. Transparency is important.</p>
</div>
</div>
</div>
<div id="ggplot2-basics" class="section level2">
<h2><span class="header-section-number">4.6</span> <code>ggplot2</code>: Basics</h2>
<p>R was initially developed for statisticians, who often are interested in generating plots or figures to visualize their data. As such, a few basic plotting features were built in when R was first developed. These are all still available; however, over time, a new approach to graphing in R was developed. This new approach implemented what is known as the <a href="https://www.amazon.com/Grammar-Graphics-Statistics-Computing/dp/0387245448">grammar of graphics</a>, which allows you to develop elegant graphs flexibly in R. Making plots with this set of rules requires the R package <code>ggplot2</code>. This package is a core package in the tidyverse. So as along as the tidyverse has been loaded, you’re ready to get started.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># load the tidyverse</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<div id="ggplot2-background" class="section level3">
<h3><span class="header-section-number">4.6.1</span> <code>ggplot2</code> Background</h3>
<p>The grammar of graphics implemented in <code>ggplot2</code> is based on the idea that you can build <em>any</em> plot as long as you have a few pieces of information. To start building plots in <code>ggplot2</code>, we’ll need some data and we’ll need to know the type of plot we want to make. The type of plot you want to make in <code>ggplot2</code> is referred to as a geom. This will get us started, but the idea behind ggplot2 is that every new concept we introduce will be layered on top of the information you’ve already learned. In this way, ggplot2 is <em>layered</em> - layers of information add on top of each other as you build your graph. In code written to generate a <code>ggplot2</code> figure, you will see each line is separated by a plus sign (<code>+</code>). Think of each line as a different layer of the graph. We’re simply adding one layer on top of the previous layers to generate the graph. You’ll see exactly what we mean by this throughout each section in this lesson.</p>
<p>To get started, we’ll start with the two basics (data and a geom) and build additional layers from there.</p>
<p>As we get started plotting in <code>ggplot2</code>, plots will take the following general form:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> DATASET) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="kw">geom_PLOT_TYPE</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="kw">VARIABLE</span>(S)))</span></code></pre></div>
<p>When using <code>ggplot2</code> to generate figures, you will always begin by calling the <code>ggplot()</code> function. You’ll then specify your dataset within the <code>ggplot()</code> function. Then, before making your plot you will also have to specify what <strong>geom</strong> type you’re interested in plotting. We’ll focus on a few basic geoms in the next section and give examples of each plot type (geom), but for now we’ll just work with a single geom: <code>geom_point</code>.</p>
<p><code>geom_point</code> is most helpful for creating scatterplots. As a reminder from an earlier lesson, scatterplots are useful when you’re looking at the relationship between two numeric variables. Within <code>geom</code> you will specify the arguments needed to tell <code>ggplot2</code> how you want your plot to look.</p>
<p>You will map your variables using the aesthetic argument <strong><code>aes</code></strong>. We’ll walk through examples below to make all of this clear. However, get comfortable with the overall look of the code now.</p>
</div>
<div id="example-dataset-diamonds" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Example Dataset: <code>diamonds</code></h3>
<p>To build your first plot in <code>ggplot2</code> we’ll make use of the fact that there are some datasets already available in R. One frequently-used dataset is known as <code>diamonds</code>. This dataset contains prices and other attributes of 53,940 diamonds, with each row containing information about a different diamond. If you look at the first few rows of data, you can get an idea of what data are included in this dataset.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>diamonds &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(diamonds)</span>
<span id="cb4-2"><a href="#cb4-2"></a>diamonds</span></code></pre></div>
<pre><code>## # A tibble: 53,940 x 10
##    carat cut       color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.23  Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
##  2 0.21  Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
##  3 0.23  Good      E     VS1      56.9    65   327  4.05  4.07  2.31
##  4 0.290 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
##  5 0.31  Good      J     SI2      63.3    58   335  4.34  4.35  2.75
##  6 0.24  Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
##  7 0.24  Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
##  8 0.26  Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
##  9 0.22  Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
## 10 0.23  Very Good H     VS1      59.4    61   338  4     4.05  2.39
## # … with 53,930 more rows</code></pre>
<div class="figure">
<img src="images/gslides/193.png" alt="" />
<p class="caption">First 12 rows of diamonds dataset</p>
</div>
<p>Here you see a lot of numbers and can get an idea of what data are available in this dataset. For example, in looking at the column names across the top, you can see that we have information about how many carats each diamond is (<code>carat</code>), some information on the quality of the diamond cut (<code>cut</code>), the color of the diamond from J (worst) to D (best) (<code>color</code>), along with a number of other pieces of information about each diamond.</p>
<p>We will use this dataset to better understand how to generate plots in R, using <code>ggplot2</code>.</p>
</div>
<div id="scatterplots-geom_point" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Scatterplots: <code>geom_point()</code></h3>
<p>In <code>ggplot2</code> we specify these by defining <code>x</code> and <code>y</code> <em>within</em> the <code>aes()</code> argument. The <code>x</code> argument defines which variable will be along the bottom of the plot. The <code>y</code> refers to which variable will be along the left side of the plot. If we wanted to understand the relationship between the number of carats in a diamond and that diamond’s price, we may do the following:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># generate scatterplot with geom_point()</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-10-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/194.png" alt="" />
<p class="caption">diamonds scatterplot</p>
</div>
<p>In this plot, we see that, in general, the larger the diamond is (or the more carats it has), the more expensive the diamond is (price), which is probably what we would have expected. However, now, we have a plot that definitively supports this conclusion!</p>
</div>
<div id="aesthetics" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Aesthetics</h3>
<p>What if we wanted to alter the size, color or shape of the points? Probably unsurprisingly, these can all be changed within the aesthetics argument. After all, something’s aesthetic refers to how something looks. Thus, if you want to change the look of your graph, you’ll want to play around with the plot’s aesthetics.</p>
<p>In fact, in the plots above you’ll notice that we specified what should be on the x and y axis within the <code>aes()</code> call. These are aesthetic mappings too! We were telling ggplot2 what to put on each axis, which will clearly affect how the plot looks, so it makes sense that these calls have to occur within <code>aes()</code>. Additionally now, we’ll focus on arguments within <code>aes()</code> that change how the points on the plot look.</p>
<div id="point-color" class="section level4">
<h4><span class="header-section-number">4.6.4.1</span> Point color</h4>
<p>In the scatterplot we just generated, we saw that there was a relationship between carat and price, such that the more carats a diamond has, generally, the higher the price. But, it’s not a perfectly linear trend. What we mean by that is that not all diamonds that were 2 carats were exactly the same price. And, not all 3 carat diamonds were exactly the same price. What if we were interested in finding out a little bit more about why this is the case?</p>
<p>Well, we could look at the clarity of the diamonds to see whether or not that affects the price of the diamonds? To add clarity to our plot, we could change the color of our points to differ based on clarity:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># adjusting color within aes</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-11-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/195_update.png" alt="" />
<p class="caption">changing point colors helps us better understand the data</p>
</div>
<p>Here, we see that not only are the points now colored by clarity, ggplot2 has also automatically added a legend for us with the various classes and their corresponding point color.</p>
<p>The Help pages of the diamonds dataset (accessed using <code>?diamonds</code>) state that clarity is “a measurement of how clear the diamond is.” The documentation also tells us that I1 is the worst clarity and IF is the best (Full scale: I1, SI1, SI2, VS1, VS2, VVS1, VVS2, IF). This makes sense with what we see in the plot. Small (&lt;1 carat) diamonds that have the best clarity level (IF) are some of the most expensive diamonds. While, relatively large diamonds (diamonds between 2 and 3 carats) of the lowest clarity (I1) tend to cost less.</p>
<p>By coloring our points by a different variable in the dataset, we now understand our dataset better. This is one of the goals of data visualization! And, specifically, what we’re doing here in <code>ggplot2</code> is known as <strong>mapping a variable to an aesthetic</strong>. We took another variable in the dataset, mapped it to a color, and then put those colors on the points in the plot. Well, we only told <code>ggplot2</code> what variable to map. It took care of the rest!</p>
<p>Of course, we can also <em>manually</em> specify the colors of the points on our graph; however, manually specifying the colors of points happens <em>outside</em> of the <code>aes()</code> call. This is because <code>ggplot2</code> does not have to go through the process of mapping the variable to an aesthetic (color in this case). In the code here, <code>ggplot2</code> doesn’t have to go through the trouble of figuring out which level of the variable is going to be which color on the plot (the mapping to the aesthetic part of the process). Instead, it just colors every point red. Thus, <strong>manually specifying the color of your points happens <em>outside</em> of <code>aes()</code></strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># manually control color point outside aes</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-12-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/196.png" alt="" />
<p class="caption">manually specifying point color occurs outside of <code>aes()</code></p>
</div>
</div>
<div id="point-size" class="section level4">
<h4><span class="header-section-number">4.6.4.2</span> Point size</h4>
<p>As above, we can change the point size by mapping another variable to the <code>size</code> argument within <code>aes</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># adjust point size within aes</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">size =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-13-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/197.png" alt="" />
<p class="caption">mapping to size changes point size on plot</p>
</div>
<p>As above, <code>ggplot2</code> handles the mapping process. All you have to do is specify what variable you want mapped (<code>clarity</code>) and how you want ggplot2 to handle the mapping (change the point <code>size</code>). With this code, you do get a warning when you run it in R that using a “discrete variable is not advised.” This is because mapping to size is usually done for numeric variables, rather than categorical variables like clarity.</p>
<p>This makes sense here too. The relationship between clarity, carat, and price was easier to visualize when clarity was mapped to <code>color</code> than here where it is mapped to <code>size</code>.</p>
<p>Like the above example with color, the size of <em>every</em> point can be changed by calling <code>size</code> outside of <code>aes</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># global control of point size</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price), <span class="dt">size =</span> <span class="fl">4.5</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-14-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/198.png" alt="" />
<p class="caption">manually specifying point size of all points occurs outside of <code>aes()</code></p>
</div>
<p>Here, we have manually increased the size of <em>all</em> the points on the plot.</p>
</div>
<div id="point-shape" class="section level4">
<h4><span class="header-section-number">4.6.4.3</span> Point Shape</h4>
<p>You can also change the shape of the points (<code>shape</code>). We’ve used solid, filled circles thus far (the default in <code>geom_point</code>), but we could specify a different shape for each clarity.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># map clarity to point shape within aes </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">shape =</span> clarity))</span></code></pre></div>
<pre><code>## Warning: Using shapes for an ordinal variable is not advised</code></pre>
<pre><code>## Warning: The shape palette can deal with a maximum of 6 discrete values because
## more than 6 becomes difficult to discriminate; you have 8. Consider
## specifying shapes manually if you must have them.</code></pre>
<pre><code>## Warning: Removed 5445 rows containing missing values (geom_point).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-15-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/199.png" alt="" />
<p class="caption">mapping clarity to shape</p>
</div>
<p>Here, while the mapping occurs correctly within ggplot2, we do get a warning message that discriminating more than six different shapes is difficult for the human eye. Thus, ggplot2 won’t allow more than six different shapes on a plot. This suggests that while you <em>can</em> do something, it’s not always the <em>best</em> to do that thing. Here, with more than six levels of clarity, it’s best to stick to mapping this variable to <code>color</code> as we did initially.</p>
<p>To manually specify a shape for all the points on your plot, you would specify it outside of <code>aes</code> using one of the twenty-five different shape options available:</p>
<div class="figure">
<img src="images/gslides/200.png" alt="" />
<p class="caption">options for points in ggplot2’s <code>shape</code></p>
</div>
<p>For example, to plot all of the points on the plot as filled diamonds (it is a dataset about diamonds after all…), you would specify shape ‘18’:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># global control of point shape outside aes</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price), <span class="dt">shape =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-16-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/201.png" alt="" />
<p class="caption">specifying filled diamonds as shape for all points manually</p>
</div>
</div>
</div>
<div id="facets" class="section level3">
<h3><span class="header-section-number">4.6.5</span> Facets</h3>
<p>In addition to mapping variables to different aesthetics, you can also opt to use facets to help make sense of your data visually. Rather than plotting all the data on a single plot and visually altering the point size or color of a third variable in a scatterplot, you could break each level of that third variable out into a separate subplot. To do this, you would use faceting. Faceting is particularly helpful for looking at categorical variables.</p>
<p>To use faceting, you would add an additional layer (+) to your code and use the <code>facet_wrap()</code> function. Within facet wrap, you specify the variable by which you want your subplots to be made:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="co"># facet by clarity</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>clarity, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-17-1.png" width="672" /></p>
<p>Here, read the tilde as the word “by”. Specifically here, we want a scatterplot of the relationship between carat and price and we want it faceted (broken down) <strong>by (~)</strong> clarity.</p>
<div class="figure">
<img src="images/gslides/202.png" alt="" />
<p class="caption">facet_wrap breaks plots down into subplots</p>
</div>
<p>Now, we have eight different plots, one for each level of clarity, where we can see the relationship between diamond carats and price.</p>
<p>You’ll note here we’ve opted to specify that we want 2 rows of subplots (<code>nrow = 2</code>). You can play around with the number of rows you want in your output to customize how your output plot appears.</p>
</div>
<div id="geoms" class="section level3">
<h3><span class="header-section-number">4.6.6</span> Geoms</h3>
<p>Thus far in this lesson we’ve only looked at scatterplots, which means we’ve only called <code>geom_point</code>. However, there are <em>many</em> additional geoms that we could call to generate different plots. Simply, a <em>geom</em> is just a shape we use to represent the data. In the case of scatterplots, they don’t <em>really</em> use a geom since each actual point is plotted individually. Other plots, such as the boxplots, barplots, and histograms we described in previous lessons help to summarize or represent the data in a meaningful way, without plotting each individual point. The shapes used in these different types of plots to represent what’s going on in the data is that plot’s geom.</p>
<p>To see exactly what we mean by geoms being “shapes that represent the data”, let’s keep using the <code>diamonds</code> dataset, but instead of looking at the relationship between two numeric variables in a scatterplot, let’s take a step back and take a look at a single numeric variable using a histogram.</p>
<div id="histograms-geom_histogram" class="section level4">
<h4><span class="header-section-number">4.6.6.1</span> Histograms: <code>geom_histogram</code></h4>
<p>To review, histograms allow you to quickly visualize the range of values your variable takes and the shape of your data. (Are all the numbers clustered around center? Or, are they all at the extremes of the range? Somewhere in between? The answers to these questions describe the “shape” of the values of your variable.)</p>
<p>For example, if we wanted to see what the distribution of carats was for these data, we could to the following.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># change geom_ to generate histogram</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">mapping =</span>  <span class="kw">aes</span>(carat))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="images/dataviz-unnamed-chunk-18-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/203.png" alt="" />
<p class="caption">histogram of carat shows range and shape</p>
</div>
<p>The code follows what we’ve seen so far in this lesson; however, we’ve now called <code>geom_histogram</code> to specify that we want to plot a histogram rather than a scatterplot.</p>
<p>Here, the rectangular boxes on the plot are geoms (shapes) that represent the number of diamonds that fall into each bin on the plot. Rather than plotting each individual point, histograms use rectangular boxes to summarize the data. This summarization helps us quickly understand what’s going on in our dataset.</p>
<p>Specifically here, we can quickly see that most of the diamonds in the dataset are less than 1 carat. This is not necessarily something we could be sure of from the scatterplots generated previously in this lesson (since some points could have been plotted directly on top of one another). Thus, it’s often helpful to visualize your data in a number of ways when you first get a dataset to ensure that you understand the variables and relationships between variables in your dataset!</p>
</div>
<div id="barplots-geom_bar" class="section level4">
<h4><span class="header-section-number">4.6.6.2</span> Barplots: geom_bar</h4>
<p>Barplots show the relationship between a set of numbers and a <strong>categorical</strong> variable. In the diamonds dataset, we may be interested in knowing how many diamonds there are of each cut of diamonds. There are five categories for cut of diamond. If we make a barplot for this variable, we can see the number of diamonds in each category.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># geom_bar for bar plots</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(cut))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-19-1.png" width="672" /></p>
<p>Again, the changes to the code are minimal. We are now interested in plotting the categorical variable <code>cut</code> and state that we want a bar plot, by including <code>geom_bar()</code>.</p>
<div class="figure">
<img src="images/gslides/204.png" alt="" />
<p class="caption">diamonds barplot</p>
</div>
<p>Here, we again use rectangular shapes to represent the data, but we’re not showing the distribution of a single variable (as we were with <code>geom_histogram</code>). Rather, we’re using rectangles to show the count (number) of diamonds within each category within cut. Thus, we need a different geom: <code>geom_bar</code>!</p>
</div>
<div id="boxplots-geom_boxplot" class="section level4">
<h4><span class="header-section-number">4.6.6.3</span> Boxplots: <code>geom_boxplot</code></h4>
<p>Boxplots provide a summary of a numerical variable across categories. For example, if you were interested to see how the price of a diamond (a numerical variable) changed across different diamond color categories (categorical variable), you may want to use a boxplot. To do so, you would specify that using <code>geom_boxplot</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># geom_boxplot for boxplots</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-20-1.png" width="672" /></p>
<p>In the code, we see that again, we only have to change what variables we want to be included in the plot and the type of plot (or geom). We want to use <code>geom_boxplot()</code> to get a basic boxplot.</p>
<div class="figure">
<img src="images/gslides/205.png" alt="" />
<p class="caption">diamonds boxplot</p>
</div>
<p>In the figure itself we see that the median price (the black horizontal bar in the middle of each box represents the median for each category) increases as the diamond color increases from the worst category (J) to the best (D).</p>
<p>Now, if you wanted to change the color of this boxplot, it would just take a small addition to the code for the plot you just generated.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># fill globally changes bar color outside aes</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> color, <span class="dt">y =</span> price), </span>
<span id="cb21-4"><a href="#cb21-4"></a>               <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-21-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/206.png" alt="" />
<p class="caption">diamonds boxplot with red fill</p>
</div>
<p>Here, by specifying the color “red” in the <code>fill</code> argument, you’re able to change the plot’s appearance. In the next lesson, we’ll go deeper into the many ways in which a plot can be customized within <code>ggplot2</code>!</p>
</div>
<div id="other-plots" class="section level4">
<h4><span class="header-section-number">4.6.6.4</span> Other plots</h4>
<p>While we’ve reviewed basic code to make a few common types of plots, there are a number of other plot types that can be made in <code>ggplot2.</code> These are listed in the <a href="http://ggplot2.tidyverse.org/reference/">online reference material for ggplot2</a> or can be accessed through RStudio directly. To do so, you would type <code>?geom_</code> into the Console in RStudio. A list of geoms will appear. You can hover your cursor over any one of these to get a short description.</p>
<div class="figure">
<img src="images/gslides/207.png" alt="" />
<p class="caption">?geom in Console</p>
</div>
<p>Or, you can select a geom from this list and click enter. After selecting a geom, such as geom_abline and hitting ‘Enter,’ the help page for that geom will pop up in the ‘Help’ tab at bottom right. Here, you can find more detailed information about the selected geom.</p>
<div class="figure">
<img src="images/gslides/208.png" alt="" />
<p class="caption">geom_abline help page</p>
</div>
</div>
</div>
<div id="eda-plots" class="section level3">
<h3><span class="header-section-number">4.6.7</span> EDA Plots</h3>
<p>As mentioned previously, an important step after you’ve read your data into R and wrangled it into a tidy format is to carry out <strong>Exploratory Data Analysis (EDA)</strong>. EDA is the process of understanding the data in your dataset fully. To understand your dataset fully, you need a full understanding of the variables stored in your dataset, what information you have and what information you don’t have (missingness!). To gain this understanding, we’ve discussed using packages like <code>skimr</code> to get a quick idea of what information is stored in your dataset. However, generating plots is another critical step in this process. We encourage you to use <code>ggplot2</code> to understand the distribution of each single variable as well as the relationship between each variable in your dataset.</p>
<p>In this process, using <code>ggplot2</code> defaults is totally fine. These plots do not have to be the most effective visualizations for communication, so you don’t want to spend a ton of time making them visually perfect. Only spend as much time on these as you need to understand your data!</p>
</div>
</div>
<div id="ggplot2-customization" class="section level2">
<h2><span class="header-section-number">4.7</span> <code>ggplot2</code>: Customization</h2>
<p>So far, we have walked through the steps of generating a number of different graphs (using different <code>geoms</code>) in <code>ggplot2</code>. We discussed the basics of mapping variables to your graph to customize its appearance or aesthetic (using size, shape, and color within <code>aes()</code>). Here, we’ll build on what we’ve previously learned to really get down to how to customize your plots so that they’re as clear as possible for communicating your results to others.</p>
<p>The skills learned in this lesson will help take you from generating exploratory plots that help <em>you</em> better understand your data to explanatory plots – plots that help you communicate your results <em>to others</em>. We’ll cover how to customize the colors, labels, legends, and text used on your graph.</p>
<p>Since we’re already familiar with it, we’ll continue to use the <code>diamonds</code> dataset that we’ve been using to learn about <code>ggplot2</code>.</p>
<div id="colors" class="section level3">
<h3><span class="header-section-number">4.7.1</span> Colors</h3>
<p>To get started, we’ll learn how to control color across plots in <code>ggplot2</code>. Previously, we discussed using color within <code>aes()</code> on a scatterplot to automatically color points by the clarity of the diamond when looking at the relationship between price and carat.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price, <span class="dt">color =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-22-1.png" width="672" /></p>
<p>However, what if we wanted to carry this concept over to a bar plot and look at how many diamonds we have of each clarity group?</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># generate bar plot</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-23-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/209.png" alt="" />
<p class="caption">diamonds broken down by clarity</p>
</div>
<p>As a general note, we’ve stopped including <code>data =</code> and <code>mapping =</code> here within our code. We included it so far to be explicit; however, in code you see in the world, the names of the arguments will typically be excluded and we want you to be familiar with code that appears as you see above.</p>
<p>OK, well that’s a start since we see the breakdown, but all the bars are the same color. What if we adjusted color within <code>aes()</code>?</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># color changes outline of bar</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">color =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-24-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/210.png" alt="" />
<p class="caption">color does add color but around the bars</p>
</div>
<p>As expected, color added a legend for each level of clarity; however, it colored the lines around the bars on the plot, rather than the bars themselves. In order to color the bars themselves, you want to specify the more helpful argument <code>fill</code>:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># use fill to color bars</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-25-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/211.png" alt="" />
<p class="caption"><code>fill</code> automatically colors the bars</p>
</div>
<p>Great! We now have a plot with bars of different colors, which was our first goal! However, adding colors here, while maybe making the plot prettier doesn’t actually give us any more information. We can see the same pattern of which clarity is most frequent among the diamonds in our dataset like we could see in the first plot we made.</p>
<p>Color is particularly helpful here, however, if we wanted to map a <em>different</em> variable onto each bar. For example, what if we wanted to see the breakdown of diamond “cut” within each “clarity” bar?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># fill by separate variable (cut) = stacked bar chart</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-26-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/212.png" alt="" />
<p class="caption">mapping a different variable to fill provides new information</p>
</div>
<p>Now we’re getting some new information! We can see that each level in clarity appears to have diamonds of all levels of cut. Color here has really helped us understand more about the data.</p>
<p>But what if we were going to present these data? While there is no comparison between red and green (which is good!), there is a fair amount of yellow in this plot. Some projectors don’t handle projecting yellow well, and it will show up too light on the screen. To avoid this, let’s manually change the colors in this bar chart! To do so we’ll add an additional layer to the plot using <code>scale_fill_manual</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut)) <span class="op">+</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="st">  </span><span class="co"># manually control colors used</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-27-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/213.png" alt="" />
<p class="caption">manually setting colors using <code>scale_fill_manual</code></p>
</div>
<p>Here, we’ve specified five different colors within the <code>values</code> argument of <code>scale_fill_manual()</code>, one for each cut of diamond. The names of these colors can be specified using the names explained on the third page of the cheatsheet <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">here</a>. (Note: There are other ways to specify colors within R. Explore the details in that cheatsheet to better understand the various ways!)</p>
<p>Additionally, it’s important to note that here we’ve used <code>scale_fill_manual()</code> to adjust the color of what was mapped using <code>fill = cut</code>. If we had colored our chart using <code>color</code> within <code>aes()</code>, there is a different function called <code>scale_color_manual</code>. This makes good sense! You use scale_fill_manual() with <code>fill</code> and <code>scale_color_manual()</code> with <code>color</code>. Keep that in mind as you adjust colors in the future!</p>
<p>Now that we have some sense of which clarity is most common in our diamonds dataset and now that we are able to successfully specify the colors we want manually in order to make this plot useful for presentation, what if we wanted to compare the proportion of each cut across the different clarities? Currently, that’s difficult because there is a different number within each clarity. In order to compare the proportion of each cut we have to use <strong>position adjustment</strong>.</p>
<p>What we’ve just generated is a <strong>stacked bar chart</strong>. It’s a pretty good name for this type of chart as the bars for cut are all stacked on top of one another. If you don’t want a stacked bar chart you could use one of the other <code>position</code> options: <code>identity</code>, <code>fill</code>, or <code>dodge</code>.</p>
<p>Returning to our question about proportion of each cut within each clarity group, we’ll want to use <code>position = "fill"</code> within <code>geom_bar()</code>. Building off of what we’ve already done:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span><span class="co"># fill scales to 100%</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-28-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/214.png" alt="" />
<p class="caption"><code>position = "fill"</code> allows for comparison of proportion across groups</p>
</div>
<p>Here, we’ve specified how we want to adjust the position of the bars in the plot. Each bar is now of equal height and we can compare each colored bar across the different clarities. As expected, we see that among the best clarity group (IF), we see more diamonds of the best cut (“Ideal”)!</p>
<p>Briefly, we’ll take a quick detour to look at <code>position = "dodge"</code>. This position adjustment places each object <em>next to one another</em>. This will not allow for easy comparison across groups, as we just saw with the last group but will allow values within each clarity group to be visualized.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  </span><span class="co"># dodge rather than stack produces grouped bar plot</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>))</span></code></pre></div>
<div class="figure">
<img src="images/gslides/215.png" alt="" />
<p class="caption"><code>position = "dodge"</code> helps compare values within each group</p>
</div>
<p>Unlike in the first plot where we specified <code>fill = cut</code>, we can actually see the relationship between each cut within the lowest clarity group (I1). Before, when the values were stacked on top of one another, we were not able to visually see that there were more “Fair” and “Premium” cut diamonds in this group than the other cuts. Now, with <code>position = "dodge"</code>, this information is visually apparent.</p>
<p>Note: <code>position = "identity"</code> is not very useful for bars, as it <em>places each object exactly where it falls within the graph</em>. For bar charts, this will lead to <em>overlapping bars</em>, which is not visually helpful. However, for scatterplots (and other 2-Dimensional charts), this is the default and is exactly what you want.</p>
</div>
<div id="labels" class="section level3">
<h3><span class="header-section-number">4.7.2</span> Labels</h3>
<p>Text on plots is incredibly helpful. A good title tells viewers what they should be getting out of the plot. Axis labels are incredibly important to inform viewers of what’s being plotted. Annotations on plots help guide viewers to important points in the plot. We’ll discuss how to control all of these now!</p>
<div id="titles" class="section level4">
<h4><span class="header-section-number">4.7.2.1</span> Titles</h4>
<p>Now that we have an understanding of how to manually adjust color, let’s improve the clarity of our plots by including helpful labels by adding an additional <code>labs()</code> layer. We’ll return to the plot where we were comparing proportions of diamond cut across diamond clarity groups.</p>
<p>You can include a <code>title</code>, <code>subtitle</code>, and/or <code>caption</code> within the <code>labs()</code> function. Each argument, as per usual, will be specified by a comma.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="st">  </span><span class="co"># add titles</span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb30-6"><a href="#cb30-6"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-30-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/216.png" alt="" />
<p class="caption"><code>labs()</code> adds helpful tittles, subtitles, and captions</p>
</div>
</div>
<div id="axis-labels" class="section level4">
<h4><span class="header-section-number">4.7.2.2</span> Axis labels</h4>
<p>You may have noticed that our y-axis label says “count”, but it’s not actually a count anymore. In reality, it’s a proportion. Having appropriately labeled axes is <em>so important</em>. Otherwise, viewers won’t know what’s being plotted. So, we should really fix that now using the <code>ylab()</code> function. Note: we won’t be changing the x-axis label, but if you were interested in doing so, you would use <code>xlab("label")</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb31-5"><a href="#cb31-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="st">  </span><span class="co"># add y axis label explicitly</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-31-1.png" width="672" /></p>
<p>Note that the x- and y- axis labels can <em>also</em> be changed within <code>labs()</code>, using the argument (<code>x =</code> and <code>y =</code> respectively).</p>
<div class="figure">
<img src="images/gslides/217.png" alt="" />
<p class="caption">Accurate axis labels are incredibly important</p>
</div>
</div>
</div>
<div id="themes" class="section level3">
<h3><span class="header-section-number">4.7.3</span> Themes</h3>
<p>To change the overall aesthetic of your graph, there are 8 themes built into <code>ggplot2</code> that can be added as an additional layer in your graph:</p>
<div class="figure">
<img src="images/gslides/218.png" alt="" />
<p class="caption">themes</p>
</div>
<p>For example, if we wanted remove the gridlines and grey background from the chart, we would use <code>theme_classic()</code>. Building on what we’ve already generated:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb32-5"><a href="#cb32-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="st">  </span><span class="co"># change plot theme</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-32-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/219.png" alt="" />
<p class="caption"><code>theme_classic</code> changes aesthetic of our plot</p>
</div>
<p>We now have a pretty good looking plot! However, a few additional changes would make this plot <em>even better</em> for communication.</p>
<p>Note: Additional themes are available from the <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/"><code>ggthemes</code> package</a>. Users can also generate their own themes.</p>
</div>
<div id="custom-theme" class="section level3">
<h3><span class="header-section-number">4.7.4</span> Custom Theme</h3>
<p>In addition to using available themes, we can also adjust parts of the theme of our graph using an additional <code>theme()</code> layer. There are <strong>a lot</strong> of options within theme. To see them all, look at the help documentation within RStudio Cloud using: <code>?theme</code>. We’ll simply go over the syntax for using a few of them here to get you comfortable with adjusting your theme. Later on, you can play around with all the options on your own to become an expert!</p>
<div id="altering-text-size" class="section level4">
<h4><span class="header-section-number">4.7.4.1</span> Altering text size</h4>
<p>For example, if we want to increase text size to make our plots more easily to view when presenting, we could do that within theme. Notice here that we’re increasing the text size of the <code>title</code>, <code>axis.text</code>, <code>axis.title</code>, and <code>legend.text</code> all within <code>theme()</code>! The syntax here is important. Within each of the elements of the theme you want to alter, you have to specify what it is you want to change. Here, for all three, we want to alter the text, so we specify <code>element_text()</code>. Within that, we specify that it’s <code>size</code> that we want to adjust.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb33-5"><a href="#cb33-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="st">  </span><span class="co"># control theme</span></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb33-10"><a href="#cb33-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span><span class="dv">14</span>),</span>
<span id="cb33-11"><a href="#cb33-11"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</span>
<span id="cb33-12"><a href="#cb33-12"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-33-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/220.png" alt="" />
<p class="caption"><code>theme()</code> allows us to adjust font size</p>
</div>
</div>
<div id="additional-text-alterations" class="section level4">
<h4><span class="header-section-number">4.7.4.2</span> Additional text alterations</h4>
<p>Changing the size of text on your plot is not the only thing you can control within <code>theme()</code>. You can make text <strong>bold</strong> and change its color within <code>theme()</code>. Note here that multiple changes can be made to a single element. We can change size and make the text <strong>bold</strong>. All we do is separate each argument with a comma, per usual.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb34-9"><a href="#cb34-9"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-10"><a href="#cb34-10"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb34-11"><a href="#cb34-11"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb34-12"><a href="#cb34-12"></a>        <span class="co"># additional control</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-34-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/221.png" alt="" />
<p class="caption"><code>theme()</code> allows us to tweak many parts of our plot</p>
</div>
<p>Any alterations to plot spacing/background, title, axis, and legend will all be made within <code>theme()</code>.</p>
</div>
</div>
<div id="legends" class="section level3">
<h3><span class="header-section-number">4.7.5</span> Legends</h3>
<p>At this point, all the text on the plot is pretty visible! However, there’s one thing that’s still not quite clear to viewers. In daily life, people refer to the “cut” of a diamond by terms like “round cut” or “princess cut” to describe the <em>shape</em> of the diamond. That’s not what we’re talking about here when we’re discussing “cut”. In these data, “cut” refers to the quality of the diamond, not the shape. Let’s be sure that’s clear as well! We can change the name of the legend by using an additional layer and the <code>guides()</code> and <code>guide_legend()</code> functions of the <code>ggplot2</code> package!</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb35-5"><a href="#cb35-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb35-9"><a href="#cb35-9"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb35-10"><a href="#cb35-10"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb35-11"><a href="#cb35-11"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb35-12"><a href="#cb35-12"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>)) <span class="op">+</span></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="st">  </span><span class="co"># control legend</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;cut quality&quot;</span>)) </span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-35-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/222.png" alt="" />
<p class="caption"><code>guides()</code> allows us to change the legend title</p>
</div>
<p>This <code>guides()</code> function, as well as the <code>guides_*</code> functions allow us to modify legends even further.</p>
<p>This is especially useful if you have many colors in your legend and you want to control how the legend is displayed in terms of the number of columns and rows using <code>ncol</code> and <code>nrow</code> respectively.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb36-5"><a href="#cb36-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb36-9"><a href="#cb36-9"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-10"><a href="#cb36-10"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb36-11"><a href="#cb36-11"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb36-12"><a href="#cb36-12"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>)) <span class="op">+</span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="st">  </span><span class="co"># control legend</span></span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;Cut Quality&quot;</span>, </span>
<span id="cb36-15"><a href="#cb36-15"></a>                              <span class="dt">ncol =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-36-1.png" width="672" /></p>
<p>Or, we can modify the font of the legend title using <code>title.theme()</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb37-5"><a href="#cb37-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb37-9"><a href="#cb37-9"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-10"><a href="#cb37-10"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb37-11"><a href="#cb37-11"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-12"><a href="#cb37-12"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>)) <span class="op">+</span></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="st">  </span><span class="co"># control legend</span></span>
<span id="cb37-14"><a href="#cb37-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;Cut Quality&quot;</span>, </span>
<span id="cb37-15"><a href="#cb37-15"></a>                             <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>)))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-37-1.png" width="672" /></p>
<p>Alternatively, we can do this modification, as well as other legend modifications, like adding a rectangle around the legend, using the <code>theme()</code> function.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co"># changing the legend title:</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;Cut Quality&quot;</span>)) <span class="op">+</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb38-10"><a href="#cb38-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>), </span>
<span id="cb38-11"><a href="#cb38-11"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb38-12"><a href="#cb38-12"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb38-13"><a href="#cb38-13"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb38-14"><a href="#cb38-14"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>),</span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="co"># changing the legend style:</span></span>
<span id="cb38-16"><a href="#cb38-16"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb38-17"><a href="#cb38-17"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-38-1.png" width="672" /></p>
<p>At this point, we have an informative title, clear colors, a well-labeled legend, and text that is large enough throughout the graph. This is certainly a graph that could be used in a presentation. We’ve taken it from a graph that is useful to just ourselves (exploratory) and made it into a plot that can communicate our findings well to others (explanatory)!</p>
<p>We have touched on a number of alterations you can make by adding additional layers to a ggplot. In the rest of this lesson we’ll touch on a few more changes you can make within <code>ggplot2</code>.</p>
</div>
<div id="scales" class="section level3">
<h3><span class="header-section-number">4.7.6</span> Scales</h3>
<p>There may be times when you want a different number of values to be displayed on an axis. The scale of your plot for <strong>continuous variables</strong> (i.e. numeric variables) can be controlled using <code>scale_x_continuous</code> or <code>scale_y_continuous</code>. Here, we want to increase the number of labels displayed on the y-axis, so we’ll use <code>scale_y_continuous</code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">  </span><span class="co"># control scale for continuous variable</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">17000</span>, <span class="dt">by =</span> <span class="dv">1000</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-39-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/223.png" alt="" />
<p class="caption">Continuous scales can be altered</p>
</div>
<p>There is very handy argument called <code>trans</code> for the <code>scale_y_continuous</code> or the <code>scale_x_continuous</code> functions to change the scale of the axes. For example, it can be very useful to show the logarithmic version of the scale if you have very high values with large differences.</p>
<p>According to the documentation for the <code>trans</code> argument:</p>
<blockquote>
<p>Built-in transformations include “asn”, “atanh”, “boxcox”, “date”, “exp”, “hms”, “identity”, “log”, “log10”, “log1p”, “log2”, “logit”, “modulus”, “probability”, “probit”, “pseudo_log”, “reciprocal”, “reverse”, “sqrt” and “time”.</p>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">  </span><span class="co"># control scale for continuous variable</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Count (log10 scale)&quot;</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>         <span class="dt">x =</span> <span class="st">&quot;Clarity&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-40-1.png" width="672" /></p>
<p>Notice that the values are not changed, just the way they are plotted. Now the y-axis increases by a factor of 10 for each break.</p>
<p>We will create a plot of the price of the diamonds to demonstrate the utility of creating a plot with a log10 scaled y-axis.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> price, <span class="dt">x =</span> clarity))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> price, <span class="dt">x =</span> clarity)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Price (log10 scale)&quot;</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>       <span class="dt">x =</span> <span class="st">&quot;Diamond Clarity&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-41-2.png" width="672" /></p>
<p>In the first plot, it is difficult to tell what values the boxplots correspond to and it is difficult to compare the boxplots (particularly for the last three clarity categories), however this is greatly improved in the second plot.</p>
<p>We can also use another argument of the <code>scale_y_continuous()</code> function to add specific labels to our plot. For example, it would be nice to add dollar signs to the y-axis. We can do so using the <code>labels</code> argument. A variety of <code>label_*</code> functions within the <code>scales</code> package can be used to modify axis labels. See <a href="https://scales.r-lib.org/reference/index.html">here</a> to take a look at the many options.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> price, <span class="dt">x =</span> clarity)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>, </span>
<span id="cb43-4"><a href="#cb43-4"></a>                    <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_dollar</span>()) <span class="op">+</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Price (log10 scale)&quot;</span>,</span>
<span id="cb43-6"><a href="#cb43-6"></a>       <span class="dt">x =</span> <span class="st">&quot;Diamond Clarity&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-42-1.png" width="672" />
In the above plot, we might also want to order the boxplots by the median price, we can do so using the <code>fct_reorder</code> function of <code>forcats</code> package to change the order for the <code>clarity</code> levels to be based on the median of the <code>price</code> values.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> price, <span class="dt">x =</span> forcats<span class="op">::</span><span class="kw">fct_reorder</span>(clarity, price, <span class="dt">.fun =</span> median))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>, </span>
<span id="cb44-4"><a href="#cb44-4"></a>                    <span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_dollar</span>()) <span class="op">+</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Price (log10 scale)&quot;</span>,</span>
<span id="cb44-6"><a href="#cb44-6"></a>       <span class="dt">x =</span> <span class="st">&quot;Diamond Clarity&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-43-1.png" width="672" /></p>
<p>Now we can more easily determine that the <code>SI2</code> diamonds are the most expensive.</p>
<p>Another way to modify <strong>discrete variables</strong> (aka factors or categorical variables where there is a limited number of levels), is to use <code>scale_x_discrete</code> or <code>scale_y_discrete</code>. In this case we will just pick a few of the clarity categories to plot and we will specify the order.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="st">  </span><span class="co"># control scale for discrete variable</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limit =</span> <span class="kw">c</span>(<span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;I1&quot;</span>)) <span class="op">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">17000</span>, <span class="dt">by =</span> <span class="dv">1000</span>)) </span></code></pre></div>
<div class="figure">
<img src="images/gslides/224.png" alt="" />
<p class="caption">Discrete scales can be altered</p>
</div>
</div>
<div id="coordinate-adjustment" class="section level3">
<h3><span class="header-section-number">4.7.7</span> Coordinate Adjustment</h3>
<p>There are times when you’ll want to flip your axis. This can be accomplished using <code>coord_flip()</code>. Adding an additional layer to the plot we just generated switches our x- and y-axes, allowing for horizontal bar charts, rather than the default vertical bar charts:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">17000</span>, <span class="dt">by =</span> <span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limit =</span> <span class="kw">c</span>(<span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;I1&quot;</span>)) <span class="op">+</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="st">  </span><span class="co"># flip coordinates</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Clearer diamonds tend to be of higher quality cut&quot;</span>,</span>
<span id="cb46-8"><a href="#cb46-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The majority of IF diamonds are an </span><span class="ch">\&quot;</span><span class="st">Ideal</span><span class="ch">\&quot;</span><span class="st"> cut&quot;</span>) <span class="op">+</span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>), </span>
<span id="cb46-12"><a href="#cb46-12"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb46-13"><a href="#cb46-13"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb46-14"><a href="#cb46-14"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb46-15"><a href="#cb46-15"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>)) <span class="op">+</span></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="st">&quot;cut quality&quot;</span>)) </span></code></pre></div>
<pre><code>## Warning: Removed 30940 rows containing non-finite values (stat_count).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-45-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/225.png" alt="" />
<p class="caption">Axes can be flipped using <code>coord_flip</code></p>
</div>
<p>It’s important to remember that all the additional alterations we already discussed can still be applied to this graph, due to the fact that ggplot2 uses layering!</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">17000</span>, <span class="dt">by =</span> <span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limit =</span> <span class="kw">c</span>(<span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;I1&quot;</span>)) <span class="op">+</span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of diamonds by diamond clarity&quot;</span>,</span>
<span id="cb48-7"><a href="#cb48-7"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Subset of all diamonds, looking three levels of clarity&quot;</span>) <span class="op">+</span></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb48-9"><a href="#cb48-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>), </span>
<span id="cb48-10"><a href="#cb48-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb48-11"><a href="#cb48-11"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb48-12"><a href="#cb48-12"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb48-13"><a href="#cb48-13"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>) ) </span></code></pre></div>
<div class="figure">
<img src="images/gslides/226.png" alt="" />
<p class="caption">Additional layers will help customize this plot</p>
</div>
</div>
<div id="annotation" class="section level3">
<h3><span class="header-section-number">4.7.8</span> Annotation</h3>
<p>Finally, there will be times when you’ll want to add text to a plot or to annotate points on your plot. We’ll discuss briefly how to accomplish that here!</p>
<p>To add text to your plot, we can use the function <code>annotate</code>. This requires us to specify that we want to annotate here with “text” (rather than say a shape, like a rectangle - “rect” - which you can also do!). Additionally, we have to specify what we’d like that text to say (using the <code>label</code> argument), where on the plot we’d like that text to show up (using <code>x</code> and <code>y</code> for coordinates), how we’d like the text aligned (using <code>hjust</code> for horizontal alignment where the options are “left”, “center”, or “right” and <code>vjust</code> for vertical alignment where the arguments are “top”, “center”, or “bottom”), and how big we’d like that text to be (using <code>size</code>):</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity)) <span class="op">+</span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">17000</span>, <span class="dt">by =</span> <span class="dv">1000</span>)) <span class="op">+</span></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limit =</span> <span class="kw">c</span>(<span class="st">&quot;SI2&quot;</span>, <span class="st">&quot;SI1&quot;</span>, <span class="st">&quot;I1&quot;</span>)) <span class="op">+</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Number of diamonds by diamond clarity&quot;</span>,</span>
<span id="cb49-7"><a href="#cb49-7"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Subset of all diamonds, looking three levels of clarity&quot;</span>) <span class="op">+</span></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb49-9"><a href="#cb49-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>), </span>
<span id="cb49-10"><a href="#cb49-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb49-11"><a href="#cb49-11"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb49-12"><a href="#cb49-12"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</span>
<span id="cb49-13"><a href="#cb49-13"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;gray30&quot;</span>)) <span class="op">+</span></span>
<span id="cb49-14"><a href="#cb49-14"></a><span class="st">  </span><span class="co"># add annotation</span></span>
<span id="cb49-15"><a href="#cb49-15"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;SI1 diamonds are among </span><span class="ch">\n</span><span class="st"> the most frequent clarity diamond&quot;</span>, </span>
<span id="cb49-16"><a href="#cb49-16"></a>           <span class="dt">y =</span> <span class="dv">12800</span>, <span class="dt">x =</span> <span class="fl">2.9</span>, </span>
<span id="cb49-17"><a href="#cb49-17"></a>           <span class="dt">vjust =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">hjust =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb49-18"><a href="#cb49-18"></a>           <span class="dt">size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 30940 rows containing non-finite values (stat_count).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-47-1.png" width="672" /></p>
<div class="figure">
<img src="images/gslides/227.png" alt="" />
<p class="caption"><code>annotate</code> helps add text to our plot</p>
</div>
<p>Note: we could have accomplished this by adding an additional <code>geom</code>: <code>geom_text</code>. However, this requires creating a new data frame, as explained <a href="http://r4ds.had.co.nz/graphics-for-communication.html#annotations">here</a>. This can also be used to <strong>label the points on your plot</strong>. Keep this reference in mind in case you have to do that in the future.</p>
</div>
<div id="vertical-and-horizontal-lines" class="section level3">
<h3><span class="header-section-number">4.7.9</span> Vertical and Horizontal Lines</h3>
<p>Sometimes it is very useful to add a line to our plot to indicate an important threshold. We can do so by using the <code>geom_hline()</code> function for a horizontal line and <code>geom_vline()</code> for a vertical line.</p>
<p>In each case, the functions require that a y-axis intercept or x-axis intercept be specified respectively.</p>
<p>For example, it might be useful to add a horizontal line to indicate 50% of the total counts for each of the <code>clarity</code> categories. We will also use the <code>scale_y_continuous()</code> function to change the y-axis to show percentages.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="st">  </span><span class="co"># fill scales to 100%</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>percent) <span class="op">+</span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percent of diamonds&quot;</span>) <span class="op">+</span></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-48-1.png" width="672" /></p>
<p>Now, it is easier to tell that slightly over half of the <code>VVS2</code> diamonds have an <code>Ideal</code> cut. This would be much more difficult to see without the horizontal line.</p>
<p>To add a vertical line we would instead use the <code>geom_vline()</code> function and we would specify an x-axis intercept. Since this plot has a discrete x-axis, numeric values specify a categorical value based on the order, thus a value of 4 would create a line down the center of the <code>VS2</code> bar. However, if we used 5.5 we could add a line offset from the center of a bar, as you can see in the following example:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="st">  </span><span class="co"># fill scales to 100%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clarity, <span class="dt">fill =</span> cut), <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;purple4&quot;</span>)) <span class="op">+</span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>percent) <span class="op">+</span></span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Percent of diamonds&quot;</span>) <span class="op">+</span></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span> ) <span class="op">+</span></span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">5.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.5</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-49-1.png" width="672" /></p>
<p>This would be helpful if we wanted to especially point out differences between the last three clarity categories of diamonds compared to the other categories.</p>
</div>
</div>
<div id="tables" class="section level2">
<h2><span class="header-section-number">4.8</span> Tables</h2>
<p>While we have focused on figures here so far, tables can be incredibly informative at a glance too. If you are looking to display summary numbers, <strong>a table can also visually display information</strong>.</p>
<p>Using this same dataset, we can use a table to get a quick breakdown of how many males and females there are in the dataset and what percentage of each gender there is.</p>
<p>A few things to keep in mind when making tables is that it’s best to:</p>
<ul>
<li>Limit the number of digits in the table</li>
<li>Include a caption</li>
<li>When possible, keep it simple.</li>
</ul>
<div class="figure">
<img src="images/gslides/228.png" alt="" />
<p class="caption">Table</p>
</div>
<div id="tables-in-r" class="section level3">
<h3><span class="header-section-number">4.8.1</span> Tables in R</h3>
<p>Now that we have a good understanding of what to consider when making tables, we can to practice making good tables in R. To do this, we’ll continue to use the diamonds dataset (which is part of the <code>ggplot2</code> package). As a reminder, this dataset contains prices and other information about ~54,000 different diamonds. If we want to provide viewers with a summary of these data, we may want to provide information about diamonds broken down by the quality of the diamond’s cut. To get our data in the form we want we will use the <code>dplyr</code> package, which we discussed in a lesson earlier.</p>
</div>
<div id="getting-the-data-in-order" class="section level3">
<h3><span class="header-section-number">4.8.2</span> Getting the Data in Order</h3>
<p>To start figuring out how the quality of the cut of the diamond affects the price of that diamond, we first have to get the data in order. To do that we’ll use the <code>dplyr</code> package. This allows us to group the data by the quality of the cut (<code>cut</code>) before summarizing the data to determine the number of diamonds in each category (<code>N</code>), the minimum price of the diamonds in this category (<code>min</code>), the average price (<code>avg</code>), and the highest price in the category (<code>max</code>).</p>
<p>To get these data in order, you could use the following code. This code groups the data by cut (quality of the diamond) and then calculates the number of diamonds in each group (N), the minimum price across each group (min), the average price of diamonds across each group (avg), and the maximum price within each group (max):</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># get summary data for table in order</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>df &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="st">  </span><span class="kw">group_by</span>(cut) <span class="op">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarize</span>(</span>
<span id="cb53-5"><a href="#cb53-5"></a>    <span class="dt">N =</span> <span class="kw">n</span>(), </span>
<span id="cb53-6"><a href="#cb53-6"></a>    <span class="dt">min =</span> <span class="kw">min</span>(price), </span>
<span id="cb53-7"><a href="#cb53-7"></a>    <span class="dt">avg =</span> <span class="kw">mean</span>(price), </span>
<span id="cb53-8"><a href="#cb53-8"></a>    <span class="dt">max =</span> <span class="kw">max</span>(price),</span>
<span id="cb53-9"><a href="#cb53-9"></a>    <span class="dt">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb53-10"><a href="#cb53-10"></a>  )</span></code></pre></div>
</div>
<div id="an-exploratory-table" class="section level3">
<h3><span class="header-section-number">4.8.3</span> An Exploratory Table</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># look at data</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   cut           N   min   avg   max
## * &lt;ord&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
## 1 Fair       1610   337 4359. 18574
## 2 Good       4906   327 3929. 18788
## 3 Very Good 12082   336 3982. 18818
## 4 Premium   13791   326 4584. 18823
## 5 Ideal     21551   326 3458. 18806</code></pre>
<p>By getting the data summarized into a single object in R (<code>df</code>), we’re on our way to making an informative table. However, this is clearly just an exploratory table. The output in R from this code follows some of the good table rules above, but not all of them. At a glance, it will help you to understand the data, but it’s not the finished table you would want to send to your boss.</p>
<div class="figure">
<img src="images/gslides/229.png" alt="" />
<p class="caption">Exploratory diamonds table</p>
</div>
<p>From this output, you, the creator of the table, would be able to see that there are a number of <strong>good qualities</strong>:</p>
<ul>
<li>there is a <strong>reasonable number of rows and columns</strong> - There are 5 rows and 5 columns. A viewer can quickly look at this table and determine what’s going on.</li>
<li>the first column <code>cut</code> is <strong>organized logically</strong> - The lowest quality diamond category is first and then they are ordered vertically until the highest quality cut (<code>ideal</code>))</li>
<li>comparisons are made <strong>top to bottom</strong> - To compare between the groups, your eye only has to travel up and down, rather than from left to right.</li>
</ul>
<p>There are also things that <strong>need to be improved</strong> on this table:</p>
<ul>
<li><strong>column headers</strong> could be even more clear</li>
<li>there’s <strong>no caption/title</strong></li>
<li>it could be more <strong>aesthetically pleasing</strong></li>
</ul>
</div>
<div id="improving-the-table-output" class="section level3">
<h3><span class="header-section-number">4.8.4</span> Improving the Table Output</h3>
<p>By-default, R outputs tables in the Console using a monospaced font. However, this limits our ability to format the appearance of the table. To fix the remaining few problems with the table’s format, we’ll use the <code>kable()</code> function from the R package <code>knitr</code> and the additional formatting capabilities of the R packages <code>kableExtra</code>.</p>
<p>The first step to a prettier table just involves using the <code>kable()</code> function from the <code>knitr</code> package, which improves the readability of this table. The <code>knitr</code> package is <em>not</em> a core tidyverse package, so you’ll have to be sure it’s installed and loaded.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># install.packages(&quot;knitr&quot;)</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="kw">kable</span>(df)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">cut</th>
<th align="right">N</th>
<th align="right">min</th>
<th align="right">avg</th>
<th align="right">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fair</td>
<td align="right">1610</td>
<td align="right">337</td>
<td align="right">4358.758</td>
<td align="right">18574</td>
</tr>
<tr class="even">
<td align="left">Good</td>
<td align="right">4906</td>
<td align="right">327</td>
<td align="right">3928.864</td>
<td align="right">18788</td>
</tr>
<tr class="odd">
<td align="left">Very Good</td>
<td align="right">12082</td>
<td align="right">336</td>
<td align="right">3981.760</td>
<td align="right">18818</td>
</tr>
<tr class="even">
<td align="left">Premium</td>
<td align="right">13791</td>
<td align="right">326</td>
<td align="right">4584.258</td>
<td align="right">18823</td>
</tr>
<tr class="odd">
<td align="left">Ideal</td>
<td align="right">21551</td>
<td align="right">326</td>
<td align="right">3457.542</td>
<td align="right">18806</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="images/gslides/230.png" alt="" />
<p class="caption">kable basic output</p>
</div>
<p>However, there are still a few issues we want to improve upon:</p>
<ul>
<li>column names could be more informative</li>
<li>too many digits in the <code>avg</code> column</li>
<li>caption/title is missing</li>
<li>source of data not included</li>
</ul>
<p>To begin addressing these issues, we can use the <code>add_header_above</code> function from <code>kableExtra()</code> to specify that the min, avg, and max columns refer to <code>price</code> in US dollars (USD). Additionally, <code>kable()</code> takes a <code>digits</code> argument to specify how many significant digits to display. This takes care of the display of too many digits in the <code>avg</code> column. Finally, we can also style the table so that every other row is shaded, helping our eye to keep each row’s information separate from the other rows using <code>kable_styling()</code> from <code>kableExtra</code>. These few changes really improve the readability of the table.</p>
<p>If you copy this code into your R console, the formatted table will show up in the Viewer tab at the bottom right-hand side of your RStudio console and the HTML code used to generate that table will appear in your console.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># install.packages(&quot;kableExtra&quot;)</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="kw">library</span>(kableExtra)</span>
<span id="cb57-3"><a href="#cb57-3"></a></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="co"># use kable_styling to control table appearance</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="kw">kable</span>(df, <span class="dt">digits=</span><span class="dv">0</span>, <span class="st">&quot;html&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;bordered&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot; &quot;</span> =<span class="st"> </span><span class="dv">2</span>,  <span class="st">&quot;price (USD)&quot;</span> =<span class="st"> </span><span class="dv">3</span>)) </span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
price (USD)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
cut
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
avg
</th>
<th style="text-align:right;">
max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Fair
</td>
<td style="text-align:right;">
1610
</td>
<td style="text-align:right;">
337
</td>
<td style="text-align:right;">
4359
</td>
<td style="text-align:right;">
18574
</td>
</tr>
<tr>
<td style="text-align:left;">
Good
</td>
<td style="text-align:right;">
4906
</td>
<td style="text-align:right;">
327
</td>
<td style="text-align:right;">
3929
</td>
<td style="text-align:right;">
18788
</td>
</tr>
<tr>
<td style="text-align:left;">
Very Good
</td>
<td style="text-align:right;">
12082
</td>
<td style="text-align:right;">
336
</td>
<td style="text-align:right;">
3982
</td>
<td style="text-align:right;">
18818
</td>
</tr>
<tr>
<td style="text-align:left;">
Premium
</td>
<td style="text-align:right;">
13791
</td>
<td style="text-align:right;">
326
</td>
<td style="text-align:right;">
4584
</td>
<td style="text-align:right;">
18823
</td>
</tr>
<tr>
<td style="text-align:left;">
Ideal
</td>
<td style="text-align:right;">
21551
</td>
<td style="text-align:right;">
326
</td>
<td style="text-align:right;">
3458
</td>
<td style="text-align:right;">
18806
</td>
</tr>
</tbody>
</table>
<div class="figure">
<img src="images/gslides/231.png" alt="" />
<p class="caption">Viewer tab with formatted table</p>
</div>
</div>
<div id="annotating-your-table" class="section level3">
<h3><span class="header-section-number">4.8.5</span> Annotating Your Table</h3>
<p>We mentioned earlier that captions and sourcing your data are incredibly important. The <code>kable</code> package allows for a <code>caption</code> argument. Below, an informative caption has been included. Additionally, <code>kableExtra</code> has a <code>footnote()</code> function. This allows you to include the source of your data at the bottom of the table. With these final additions, you have a table that clearly displays the data and could be confidently shared with your boss.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">kable</span>(df, <span class="dt">digits=</span><span class="dv">0</span>, <span class="st">&quot;html&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Table 1: Diamonds Price by Quality of Cut. Most Diamonds are of the highest quality cut and the most expensive diamonds are of the highest quality&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;bordered&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="st">  </span><span class="co"># add headers and footnote</span></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot; &quot;</span> =<span class="st"> </span><span class="dv">2</span>,  <span class="st">&quot;price (USD)&quot;</span> =<span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="st">  </span><span class="kw">footnote</span>(<span class="dt">general =</span> <span class="st">&quot;Diamonds dataset from ggplot2&quot;</span>, <span class="dt">general_title =</span> <span class="st">&quot;Source:&quot;</span>, <span class="dt">footnote_as_chunk =</span> T)</span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
(#tab:unnamed-chunk-54)Table 1: Diamonds Price by Quality of Cut. Most Diamonds are of the highest quality cut and the most expensive diamonds are of the highest quality
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="2">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
price (USD)
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
cut
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
avg
</th>
<th style="text-align:right;">
max
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Fair
</td>
<td style="text-align:right;">
1610
</td>
<td style="text-align:right;">
337
</td>
<td style="text-align:right;">
4359
</td>
<td style="text-align:right;">
18574
</td>
</tr>
<tr>
<td style="text-align:left;">
Good
</td>
<td style="text-align:right;">
4906
</td>
<td style="text-align:right;">
327
</td>
<td style="text-align:right;">
3929
</td>
<td style="text-align:right;">
18788
</td>
</tr>
<tr>
<td style="text-align:left;">
Very Good
</td>
<td style="text-align:right;">
12082
</td>
<td style="text-align:right;">
336
</td>
<td style="text-align:right;">
3982
</td>
<td style="text-align:right;">
18818
</td>
</tr>
<tr>
<td style="text-align:left;">
Premium
</td>
<td style="text-align:right;">
13791
</td>
<td style="text-align:right;">
326
</td>
<td style="text-align:right;">
4584
</td>
<td style="text-align:right;">
18823
</td>
</tr>
<tr>
<td style="text-align:left;">
Ideal
</td>
<td style="text-align:right;">
21551
</td>
<td style="text-align:right;">
326
</td>
<td style="text-align:right;">
3458
</td>
<td style="text-align:right;">
18806
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Source:</span> <sup></sup> Diamonds dataset from ggplot2
</td>
</tr>
</tfoot>
</table>
<div class="figure">
<img src="images/gslides/232.png" alt="" />
<p class="caption">Viewer tab with annotated and formatted table</p>
</div>
</div>
</div>
<div id="ggplot2-extensions" class="section level2">
<h2><span class="header-section-number">4.9</span> <code>ggplot2</code>: Extensions</h2>
<p>Beyond the <em>many</em> capabilities of <code>ggplot2</code>, there are a few additional packages that build <em>on top of</em> <code>ggplot2</code>’s capabilities. We’ll introduce a few packages here so that you can:</p>
<ul>
<li>directly annotate points on plots (<code>ggrepel</code> and <code>directlabels</code>)</li>
<li>combine multiple plots (<code>cowplot</code> + <code>patchwork</code>)</li>
<li>generate animated plots (<code>gganimate</code>)</li>
</ul>
<p>These are referred to as <code>ggplot2</code> extensions. There are dozens of additional <a href="http://www.ggplot2-exts.org/gallery/"><code>ggplot2</code> extensions</a> available if you’d like to explore other plotting options beyond what is covered here!</p>
<div id="ggrepel-1" class="section level3">
<h3><span class="header-section-number">4.9.1</span> <code>ggrepel</code></h3>
<p><a href="https://github.com/slowkow/ggrepel"><code>ggrepel</code></a> “provides geoms for<code>ggplot2</code> to repel overlapping text labels.”</p>
<p>To demonstrate the functionality within the <code>ggrepel</code> package and demonstrate cases where it would be needed, let’s use a dataset available from R - the <code>mtcars</code> dataset:</p>
<blockquote>
<p>The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models).</p>
</blockquote>
<p>This dataset includes information about 32 different cars. Let’s first convert this from a data.frame to a tibble. Note that we will keep the rownames and make it a new variable called <code>model</code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># see first 6 rows of mtcars</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>mtcars &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="kw">as_tibble</span>(<span class="dt">rownames =</span> <span class="st">&quot;model&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="kw">head</span>(mtcars)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 12
##   model          mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Mazda RX4     21       6   160   110  3.9   2.62  16.5     0     1     4     4
## 2 Mazda RX4 W…  21       6   160   110  3.9   2.88  17.0     0     1     4     4
## 3 Datsun 710    22.8     4   108    93  3.85  2.32  18.6     1     1     4     1
## 4 Hornet 4 Dr…  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1
## 5 Hornet Spor…  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2
## 6 Valiant       18.1     6   225   105  2.76  3.46  20.2     1     0     3     1</code></pre>
<p>What if we were to plot a scatterplot between horsepower (<code>hp</code>) and weight (<code>wt</code>) of each car and wanted to label each point in that plot with the care model.</p>
<p>If we were to do that with <code>ggplot2</code>, we’d see the following:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># label points without ggrepel</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, hp, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="st">  </span><span class="kw">geom_text</span>() <span class="op">+</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&#39;dodgerblue&#39;</span>) <span class="op">+</span></span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-56-1.png" width="672" /></p>
<p>The overall trend is clear here - the more a car weights, the more horsepower it tends to have. However, many of the labels are overlapping and impossible to read - this is where <code>ggrepel</code> plays a role:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># install and load package</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="co"># install.packages(&quot;ggrepel&quot;)</span></span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb62-4"><a href="#cb62-4"></a></span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="co"># label points with ggrepel</span></span>
<span id="cb62-6"><a href="#cb62-6"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, hp, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="st">  </span><span class="kw">geom_text_repel</span>() <span class="op">+</span></span>
<span id="cb62-8"><a href="#cb62-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&#39;dodgerblue&#39;</span>) <span class="op">+</span></span>
<span id="cb62-9"><a href="#cb62-9"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<pre><code>## Warning: ggrepel: 1 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="images/dataviz-unnamed-chunk-57-1.png" width="672" /></p>
<p>The only bit of code here that changed was that we changed <code>geom_text()</code> to <code>geom_text_repel()</code>. This, like <code>geom_text()</code> adds text directly to the plot. However, it also helpfully repels overlapping labels away from one another and away from the data points on the plot.</p>
<div id="custom-formatting" class="section level4">
<h4><span class="header-section-number">4.9.1.1</span> Custom Formatting</h4>
<p>Within <code>geom_text_repel()</code>, there are a number of additional formatting options available. We’ll cover a number of the most important here, but the <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"><code>ggrepel</code> vignettes</a> explore these further.</p>
<p><strong>Highlighting Specific Points</strong></p>
<p>Often, you do not want to highlight <em>all</em> the points on a plot, but want to draw your viewer’s attention to a few <em>specific</em> points. To do this and say highlight only cars that are the make Mercedes, you could use the following approach:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># create a new column &quot;merc&quot; with true or false for Mercedes</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co"># value is true for rows with &quot;Merc&quot; in model column</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>mtcars &lt;-<span class="st"> </span>mtcars<span class="op">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="st">          </span><span class="kw">mutate</span>(<span class="dt">merc =</span> <span class="kw">str_detect</span>(<span class="dt">string =</span> model, <span class="dt">pattern =</span> <span class="st">&quot;Merc&quot;</span>))</span>
<span id="cb64-5"><a href="#cb64-5"></a></span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="co"># Let&#39;s just label these items and manually color the points</span></span>
<span id="cb64-7"><a href="#cb64-7"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(wt, hp, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb64-8"><a href="#cb64-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> merc)) <span class="op">+</span></span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;grey50&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>)) <span class="op">+</span></span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> <span class="kw">filter</span>(mtcars, merc <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>),</span>
<span id="cb64-11"><a href="#cb64-11"></a>        <span class="dt">nudge_y =</span> <span class="dv">1</span>, </span>
<span id="cb64-12"><a href="#cb64-12"></a>        <span class="dt">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb64-13"><a href="#cb64-13"></a>        <span class="dt">direction =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb64-15"><a href="#cb64-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-58-1.png" width="672" /></p>
<p>Here, notice that we first create a new column in our dataframe called <code>merc</code>. Here, we include the model of the car, only if “Merc” is in the model of the car’s name.</p>
<p>We then, specify that only these Mercedes cars should be labeled <em>and</em> that we only want them colored blue if they are Mercedes. This allows us to focus in on those few points we’re interested in. And, we can see that among the cars in this dataset, Mercedes tend to be of average weight but have varying horsepower, depending on the model of the car.</p>
<p><strong>Text Alignment</strong></p>
<p>Other times, you want to ensure that your labels are aligned on the top or bottom edge, relative to one another. This can be controlled using the <code>hjust</code> and <code>vjust</code> arguments. The values for particular alignment are:</p>
<p><code>hjust = 0</code> | to left-align<br />
<code>hjust = 0.5</code> | to center<br />
<code>hjust = 1</code> | to right-align</p>
<p>Additionally, you can adjust the starting position of text vertically with <code>nudge_y</code> (or horizontally with <code>nudge_x</code>). To use this, you’ll specify the distance from the point to the label you want to use.</p>
<p>You can also allow the labels to move horizontally with <code>direction = "x"</code> (or vertically with <code>direction = "y"</code>. This will put the labels at a right angle from the point. The default here is “both”, which allows labels to move in both directions.</p>
<p>For example, what if we wanted to plot the relationship between quarter mile time (<code>qsec</code>) and miles per gallon (<code>mpg</code>) to identify cars that get the best gas mileage.</p>
<p>To do this, we’re specifying within <code>geom_text_repel()</code> the following arguments:</p>
<p><code>data</code> | only label those cars with gas mileage &gt; 30 mpg<br />
<code>nudge_y</code> | position all labels so that they’re vertically aligned<br />
<code>hjust</code> | center-align the labels<br />
<code>direction</code> | allow labels to move horizontally</p>
<p>For further customization, we’re also changing the segment color from the default black to a light gray (“gray60”).</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># customize within geom_text_repel</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># first create a new column for mpg &gt; 30 within mtcars and pipe this into ggplot</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>mtcars <span class="op">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">mpg_highlight =</span> <span class="kw">case_when</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;high&quot;</span>, mpg <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;low&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(qsec, mpg, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="st">      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> mpg_highlight)) <span class="op">+</span></span>
<span id="cb65-7"><a href="#cb65-7"></a><span class="st">      </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>( <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="st">      </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb65-9"><a href="#cb65-9"></a><span class="st">      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb65-10"><a href="#cb65-10"></a><span class="st">      </span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>), </span>
<span id="cb65-11"><a href="#cb65-11"></a>        <span class="dt">nudge_y =</span> <span class="dv">3</span>, </span>
<span id="cb65-12"><a href="#cb65-12"></a>        <span class="dt">hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb65-13"><a href="#cb65-13"></a>        <span class="dt">direction =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb65-14"><a href="#cb65-14"></a>        <span class="dt">segment.color =</span> <span class="st">&quot;gray60&quot;</span>) <span class="op">+</span></span>
<span id="cb65-15"><a href="#cb65-15"></a><span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="op">+</span></span>
<span id="cb65-16"><a href="#cb65-16"></a><span class="st">      </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">38</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-59-1.png" width="672" /></p>
<p>Notice that we’ve also had to provide the plot with more room by customizing the x- and y- axes, using the final two lines of code you see above.</p>
<p>With this plot, it is clear that there are four cars with mpg &gt; 30. And, among these, we now know that the Toyota Corolla has the fastest quarter mile time, all thanks to direct labeling of the points!</p>
</div>
</div>
<div id="directlabels" class="section level3">
<h3><span class="header-section-number">4.9.2</span> <code>directlabels</code></h3>
<p>The <code>directlabels</code> package also helps you to add labels directly to plots. There are functions that allow you to also add labels that generally don’t overlap using less code than <code>ggrepel</code>, however there are less specification options.</p>
<p>There are several method options for adding direct labels to scatter plots, such as: <code>first.points</code> (which will place the label on the left in a scatterplot), and <code>last.points</code> (which will place the label on the right in a scatterplot).</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co">#install.packages(&quot;directlabels&quot;)</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="kw">library</span>(directlabels)</span>
<span id="cb66-3"><a href="#cb66-3"></a>mtcars <span class="op">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mpg_highlight =</span> <span class="kw">case_when</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;high&quot;</span>, mpg <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;low&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(qsec, mpg, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb66-6"><a href="#cb66-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> mpg_highlight)) <span class="op">+</span></span>
<span id="cb66-7"><a href="#cb66-7"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb66-8"><a href="#cb66-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="op">+</span></span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">36</span>)) <span class="op">+</span></span>
<span id="cb66-10"><a href="#cb66-10"></a><span class="st">  </span><span class="kw">geom_dl</span>(<span class="dt">data =</span> <span class="kw">filter</span>(mtcars, mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>), <span class="kw">aes</span>(<span class="dt">label =</span> model), </span>
<span id="cb66-11"><a href="#cb66-11"></a>          <span class="dt">method =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;first.points&quot;</span>),</span>
<span id="cb66-12"><a href="#cb66-12"></a>                        <span class="dt">cex =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb66-13"><a href="#cb66-13"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb66-14"><a href="#cb66-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-60-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>mtcars <span class="op">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mpg_highlight =</span> <span class="kw">case_when</span>(mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;high&quot;</span>, mpg <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">~</span><span class="st"> &quot;low&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(qsec, mpg, <span class="dt">label =</span> model)) <span class="op">+</span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> mpg_highlight)) <span class="op">+</span></span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>)) <span class="op">+</span></span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">36</span>)) <span class="op">+</span></span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="st">  </span><span class="kw">geom_dl</span>(<span class="dt">data =</span> <span class="kw">filter</span>(mtcars, mpg <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>), <span class="kw">aes</span>(<span class="dt">label =</span> model), </span>
<span id="cb67-9"><a href="#cb67-9"></a>          <span class="dt">method =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;last.points&quot;</span>),</span>
<span id="cb67-10"><a href="#cb67-10"></a>                        <span class="dt">cex =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb67-11"><a href="#cb67-11"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb67-12"><a href="#cb67-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-60-2.png" width="672" /></p>
<p>This package is especially useful for labeling lines in a lineplot. There are several methods, one of which is the <code>angled.boxes</code> method. This often negates the need for a legend.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(qsec, mpg, <span class="dt">color =</span> cyl, <span class="dt">group =</span> cyl)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">  </span><span class="kw">geom_dl</span>(<span class="kw">aes</span>(<span class="dt">label =</span> cyl), </span>
<span id="cb68-4"><a href="#cb68-4"></a>          <span class="dt">method =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;angled.boxes&quot;</span>),</span>
<span id="cb68-5"><a href="#cb68-5"></a>                        <span class="dt">cex =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Differences in cars with 4, 6, or 8 cylinders&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-61-1.png" width="672" /></p>
<p>See <a href="https://cran.r-project.org/web/packages/directlabels/directlabels.pdf">here</a> for more information about this package.</p>
</div>
<div id="cowplot-1" class="section level3">
<h3><span class="header-section-number">4.9.3</span> <code>cowplot</code></h3>
<p>Beyond customization within <code>ggplot2</code> and labeling points, there are times you’ll want to arrange multiple plots together in a single grid, applying a standard theme across all plots. This often occurs when you’re ready to present or publish your visualizations. When you’re ready to share and present your work with others, you want to be sure your visualizations are conveying the point you want to convey to your viewer in as simple a plot as possible. And, if you’re presenting multiple plots, you typically want to ensure that they have a consistent theme from one plot to the next. This allows the viewer to focus on the data you’re plotting, rather than changes in theme. The <code>cowplot</code> package assists in this process!</p>
<div id="theme" class="section level4">
<h4><span class="header-section-number">4.9.3.1</span> Theme</h4>
<p>The standard theme within <code>cowplot</code>, which works for many types of plots is <code>theme_cowplot()</code>. This theme is very similar to <code>theme_classic()</code>, which removes the background color, removes grid lines, and plots only the x- and y- axis lines (rather than a box around all the data). We’ll use this theme for the examples from this package. However, note that there are a number of additional themes available from the <code>cowplot</code> package. We will use the number 12 within this function to indicate that we want to use a font size of 12.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># install and load package</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="co"># install.packages(&quot;cowplot&quot;)</span></span>
<span id="cb69-3"><a href="#cb69-3"></a><span class="kw">library</span>(cowplot)</span></code></pre></div>
<p>We’ll continue to use the <code>mtcars</code> dataset for these examples. Here, using the <code>forcats</code> package (which is part of the core tidyverse), we’ll add two new columns: <code>transmission</code>, where we recode the <code>am</code> column to be “automatic” if <code>am == 0</code> and “manual” if <code>am == 1</code>, and <code>engine</code>, where we recode the <code>vs</code> column to be “v-shaped” if <code>vs == 0</code> and “straight” if <code>vs == 1</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>mtcars &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">transmission =</span> <span class="kw">fct_recode</span>(<span class="kw">as.factor</span>(am), <span class="st">&quot;automatic&quot;</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">&quot;manual&quot;</span> =<span class="st"> &quot;1&quot;</span>),</span>
<span id="cb70-3"><a href="#cb70-3"></a>         <span class="dt">engine =</span> <span class="kw">fct_recode</span>(<span class="kw">as.factor</span>(vs), <span class="st">&quot;v-shaped&quot;</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">&quot;straight&quot;</span> =<span class="st"> &quot;1&quot;</span>))</span></code></pre></div>
<p>We’ll use these data to generate a scatterplot plotting the relationship between 1/4 mile speed (<code>qsec</code>) and gas mileage (<code>mpg</code>). We’ll color the points by this new column <code>transmission</code> and apply <code>theme_cowplot</code>. Finally, we’ll assign this to <code>p1</code>, as we’ll ultimately generate a few different plots.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(qsec, mpg, <span class="dt">color =</span> transmission)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.2</span>))</span>
<span id="cb71-5"><a href="#cb71-5"></a>p1</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-64-1.png" width="672" /></p>
<p>Let’s make a similar plot, but color by engine type. We’ll want to manually change the colors here so that we aren’t using the same colors for transmission and engine. We’ll store this in <code>p2</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(qsec, mpg, <span class="dt">color =</span> engine)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>)) <span class="op">+</span></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="st">  </span><span class="kw">theme_cowplot</span>(<span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.2</span>))</span>
<span id="cb72-6"><a href="#cb72-6"></a>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-65-1.png" width="672" /></p>
<p>Great - we’ve now got two plots with the same theme and similar appearance. What if we wanted to combine these into a single grid for presentation purposes?</p>
</div>
<div id="multiple-plots" class="section level4">
<h4><span class="header-section-number">4.9.3.2</span> Multiple Plots</h4>
<p>Aligning plots is made simple within the <code>cowplot</code> package using the <code>align_plots()</code> function:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># plot side by side</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="kw">plot_grid</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-66-1.png" width="672" /></p>
<p>Here, we specify the two plots we’d like to plot on a single grid and we also optionally include how many columns we’d like using the <code>ncol</code> parameter.</p>
<p>To plot these one on top of the other, you could specify for <code>plot_grid()</code> to use a single column. Also note here that we’re aligning the plots vertically with <code>align = "v"</code>. The default here is “none”, so if you want the graphs in the grid to be aligned, be sure to specify “h” (horizontally), “v” (vertically) or “hv” (align in both directions) explicitly.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># plot on top of one another</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="kw">plot_grid</span>(p1, p2, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">align =</span> <span class="st">&quot;v&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-67-1.png" width="672" /></p>
<p>Note that by default, the plots will share the space equally, but it’s also possible to make one larger than the other within the grid using <code>rel_widths</code> and <code>rel_heights</code>.</p>
<p>For example, if you had a faceted plot summarizing the number of cars by transmission and engine (which we’ll call <code>p3</code>):</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># generate faceted plot</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(engine)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>transmission) <span class="op">+</span></span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expand_scale</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="op">+</span></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>(<span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="st">  </span><span class="kw">panel_border</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb75-8"><a href="#cb75-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;gray80&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>p3</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-68-1.png" width="672" /></p>
<p>Note that for this plot we’ve chosen a different theme, allowing for horizontal grid lines. This can be helpful when visualizing bar plots.</p>
<p>If we were to plot these next to one another using the defaults, the faceted plot would be squished:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># plot next to one another</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">plot_grid</span>(p1, p3)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-69-1.png" width="672" /></p>
<p>We can use <code>rel_widths</code> to specify the relative width for the plot on the left relative to the plot on the right:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># control relative spacing within grid</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="kw">plot_grid</span>(p1, p3, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-70-1.png" width="672" /></p>
<p><strong>Adding Labels</strong></p>
<p>Within these grids, you’ll often want to label these plots so that you can refer to them in your report or presentation. This can be done using the <code>labels</code> parameter within <code>plot_grid()</code>:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># add A and B labels to plots</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">plot_grid</span>(p1, p3, <span class="dt">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-71-1.png" width="672" /></p>
<p><strong>Adding Joint Titles</strong></p>
<p>Finally, when generating grids with multiple plots, at times you’ll often want a single title to explain what’s going on across the plots. Here, the process <em>looks</em> slightly confusing, but this is only because we’re putting all of these <code>cowplot</code> pieces together.</p>
<p>Generally, there are three steps:</p>
<ol style="list-style-type: decimal">
<li>Create grid with plots<br />
</li>
<li>Create title object<br />
</li>
<li>Piece title and grid of plots together</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># use plot_grid to generate plot with 3 plots together</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>first_col &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>))</span>
<span id="cb81-3"><a href="#cb81-3"></a>three_plots &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(first_col, p3, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;&#39;</span>, <span class="st">&#39;C&#39;</span>), <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>))</span>
<span id="cb81-4"><a href="#cb81-4"></a></span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="co"># specify title</span></span>
<span id="cb81-6"><a href="#cb81-6"></a>title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="st">  </span><span class="co"># specify title and alignment</span></span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="st">  </span><span class="kw">draw_label</span>(<span class="st">&quot;Transmission and Engine Type Affect Mileage and 1/4 mile time&quot;</span>,</span>
<span id="cb81-9"><a href="#cb81-9"></a>              <span class="dt">fontface =</span> <span class="st">&#39;bold&#39;</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">hjust =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb81-10"><a href="#cb81-10"></a><span class="st">  </span><span class="co"># add margin on the left of the drawing canvas,</span></span>
<span id="cb81-11"><a href="#cb81-11"></a><span class="st">  </span><span class="co"># so title is aligned with left edge of first plot</span></span>
<span id="cb81-12"><a href="#cb81-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">7</span>))</span>
<span id="cb81-13"><a href="#cb81-13"></a></span>
<span id="cb81-14"><a href="#cb81-14"></a><span class="co"># put title and plots together</span></span>
<span id="cb81-15"><a href="#cb81-15"></a><span class="kw">plot_grid</span>(title, three_plots, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-72-1.png" width="672" /></p>
<p>And, just like that we’ve got three plots, labeled, spaced out nicely in a grid, with a shared title, all thanks to the functionality within the <code>cowplot</code> package.</p>
</div>
</div>
<div id="patchwork-1" class="section level3">
<h3><span class="header-section-number">4.9.4</span> <code>patchwork</code></h3>
<p>The <code>patchwork</code> package is similar to the <code>cowplot</code> package in that they both are helpful for combining plots together. They each allow for different plot modifications, so it is useful to know about both packages.</p>
<p>Instead of requiring a function like <code>plot_grid()</code> of the <code>cowplot</code> package plots can be combined using a few operators, such as <code>"+"</code>, <code>"/"</code>, and `“|”.</p>
<p>To combine two plots together we can simply add them together with the <code>+</code> sign or place them next to one another using the <code>|</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">#install.packages(patchwork)</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">library</span>(patchwork)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;patchwork&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:cowplot&#39;:
## 
##     align_plots</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>p1 <span class="op">|</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-73-2.png" width="672" /></p>
<p>If we want a plot above another plot we can use the “/” symbol:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>p1 <span class="op">/</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-74-1.png" width="672" />
Grouping or nesting plots together using parenthesis can result in two or more plots taking up a single grid space.</p>
<p>Thus, to combine multiple plots in a more complicated layout, one can combine two plots on one row and have a third plot on another row like this:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>(p3 <span class="op">+</span><span class="st"> </span>p2) <span class="op">/</span><span class="st"> </span>p1</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-75-1.png" width="672" /></p>
<p>Otherwise, we would have the following:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>p3 <span class="op">+</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p1</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-76-1.png" width="672" /></p>
<p>You can also empty plot spacers using the <code>plotspacer()</code> function like so:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>(<span class="kw">plot_spacer</span>() <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_spacer</span>()) <span class="op">/</span><span class="st"> </span>p1</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-77-1.png" width="672" /></p>
<p>You can modify the widths of the plots using the <code>widths</code> argument of the <code>plot_layout()</code> function. In the following example we will make the width of the plot on the left 3 times that of the plot on the right. Any numeric values will do, it is the ratio of the numbers that make the difference.</p>
<p>Thus, both <code>p1 + p2 + plot_layout(widths = c(2, 1))</code> and <code>p1 + p2 + plot_layout(widths = c(60, 30))</code> will result in the same relative size difference between <code>p1</code> and <code>p2</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-78-1.png" width="672" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">30</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-78-2.png" width="672" /></p>
<p>The relative heights of the plots can also be modified using a <code>heights</code> argument with the same function.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">heights =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-79-1.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">heights =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">30</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-79-2.png" width="672" /></p>
<p>This package also allows for modification of legends. For example, legends can be gathered together to one side of the combined plots using the <code>guides = 'collect'</code> argument of the <code>plot_grid()</code> function.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-80-1.png" width="672" /></p>
<p>You can also specify the number of columns or rows using this same function with the <code>ncol</code> or <code>nrow</code> as you would with <code>facet_wrap()</code> of the <code>ggplot2</code> package, where plots are added to <strong>complete a row</strong> before they will be added to a new row. For example, the following will result in an empty 2nd row.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-81-1.png" width="672" /></p>
<p>However, the <code>byrow = FALSE</code> argument can disrupt this behavior and result in an empty 2nd column:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>p1 <span class="op">+</span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">guides =</span> <span class="st">&quot;collect&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-82-1.png" width="672" /></p>
<p>In this case the <strong>columns will be preferentially completed</strong> before placing a plot in a new column.</p>
<p>We can also use the package to change the theme specifications of specific plots. By default the plot just prior to the <code>theme()</code> function will be the only plot changed.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-83-1.png" width="672" /></p>
<p>Using the <code>*</code>, themes can be added to all plots that are nested together.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>(p1 <span class="op">+</span><span class="st"> </span>p2) <span class="op">*</span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>p2</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-84-1.png" width="672" /></p>
<p>The <code>&amp;</code> adds themes to all plots.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>(p1 <span class="op">+</span><span class="st"> </span>p2) <span class="op">+</span><span class="st"> </span>p2 <span class="op">&amp;</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-85-1.png" width="672" /></p>
<p>Annotations for all the plots combined can also be added using the <code>plot_annotation()</code> function, which can also take <code>theme()</code> function specifications with the <code>theme</code> argument.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>(p1 <span class="op">+</span><span class="st"> </span>p2) <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="st">  </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Plot title for all 3 plots&quot;</span>, </span>
<span id="cb101-3"><a href="#cb101-3"></a>                  <span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-86-1.png" width="672" /></p>
<p>See <a href="https://patchwork.data-imaginist.com/">here</a> for more information about the <code>patchwork</code> package.</p>
</div>
<div id="gganimate-1" class="section level3">
<h3><span class="header-section-number">4.9.5</span> <code>gganimate</code></h3>
<p>The final <code>ggplot2</code> extension we’ll discuss here is <a href="https://gganimate.com/"><code>gganmiate</code></a>. This extends the grammar of graphics implemented in the <code>ggplot2</code> package to work with animated plots. To get started, you’ll need to install and load the package:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">library</span>(gganimate)</span></code></pre></div>
<p>The <code>gganimate</code> package adds functionality by providing a number of these grammar classes. Across the animation being generated, the following classes are made available, with each classes’ corresponding functionality:</p>
<p><code>transition_*()</code> | specifies how data should transition
<code>enter_*()</code>/<code>exit_*()</code> | specifies how data should appear and disappear
<code>ease_aes()</code> | specifies how different aesthetics should be eased during transitions
<code>view_*()</code> | specifies how positional scales should change
<code>shadow_*()</code> | specifies how points from a previous frame should be displayed in current frame</p>
<p>We’ll walk through these grammar classes using the <code>mtcars</code> dataset.</p>
<div id="example-mtcars" class="section level4">
<h4><span class="header-section-number">4.9.5.1</span> Example: <code>mtcars</code></h4>
<p>As noted, <code>gganimate</code> builds on top of the functionality within <code>ggplot2</code>, so the code should look pretty familiar by now.</p>
<p>First, using the <code>mtcars</code> dataset we generate a static boxplot looking at the relationship between the number of cylinders a car has (<code>cyl</code>) and its gas mileage (<code>mpg</code>).</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co"># generate static boxplot</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-88-1.png" width="672" /></p>
<p>But what if we wanted to understand the relationship between those two variables and the number of gears a car has (<code>gear</code>)?</p>
<p>One option would be to use faceting:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># facet by gear</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg)) <span class="op">+</span></span>
<span id="cb104-4"><a href="#cb104-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>gear)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-89-1.png" width="672" /></p>
<p>Alternatively, we could animate the plot, using <code>gganimate</code> so that on a single plot we rotate between each of these three plots.</p>
<div id="transitions" class="section level5">
<h5><span class="header-section-number">4.9.5.1.1</span> Transitions</h5>
<p>We’ll transition in this example between frames by gear:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="co"># animate it!</span></span>
<span id="cb105-2"><a href="#cb105-2"></a>mtcars <span class="op">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gear =</span> <span class="kw">factor</span>(gear),</span>
<span id="cb105-4"><a href="#cb105-4"></a>         <span class="dt">cyl =</span> <span class="kw">factor</span>(cyl)) <span class="op">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb105-6"><a href="#cb105-6"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(cyl, mpg)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb105-7"><a href="#cb105-7"></a><span class="st">  </span><span class="kw">transition_manual</span>(gear)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-90-1.gif" /><!-- --></p>
<p>Note that here, <code>transition_manual()</code> is a new grammar class that we add right on top of our <code>ggplot2</code> plot code! Within this grammar class, we specify the variable upon which we’d like the transition in the animation to occur.</p>
<p>This means that the number of frames in the animation will be the number of levels in the variable by which you’re transitioning. Here, there will be 3 frames, as there are three different levels of <code>gear</code> in the <code>mtcars</code> dataset.</p>
<p><code>transition_manual()</code> is not the only option for transition. In fact, there are a number of different <code>transition_*</code> options, depending upon your animation needs. One of the most commonly used is <code>transition_states()</code>. The animation will plot the same information as the example above; however, it allows for finer tune control of the animation</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># animate it!</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>anim &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(cyl), mpg)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb106-4"><a href="#cb106-4"></a><span class="st">  </span><span class="kw">transition_states</span>(gear,</span>
<span id="cb106-5"><a href="#cb106-5"></a>                    <span class="dt">transition_length =</span> <span class="dv">2</span>,</span>
<span id="cb106-6"><a href="#cb106-6"></a>                    <span class="dt">state_length =</span> <span class="dv">1</span>)</span>
<span id="cb106-7"><a href="#cb106-7"></a></span>
<span id="cb106-8"><a href="#cb106-8"></a>anim</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-91-1.gif" /><!-- --></p>
<p>Note here that we’ve stored the output from <code>transition_states</code> in the object <code>anim</code>. We’ll build on this object below.</p>
</div>
<div id="labeling" class="section level5">
<h5><span class="header-section-number">4.9.5.1.2</span> Labeling</h5>
<p>Currently, it’s hard to know which frame corresponds to which <code>gear</code>. To make this easier on the viewer, let’s label our animation:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># animate it!</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>anim &lt;-<span class="st"> </span>anim <span class="op">+</span><span class="st">  </span></span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Now showing gear: {closest_state}&#39;</span>)</span>
<span id="cb107-4"><a href="#cb107-4"></a></span>
<span id="cb107-5"><a href="#cb107-5"></a>anim</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-92-1.gif" /><!-- --></p>
<p>Note that we’re referring to the appropriate gear within the animation frame by specifying <code>{closest_state}</code>.</p>
</div>
<div id="easing" class="section level5">
<h5><span class="header-section-number">4.9.5.1.3</span> Easing</h5>
<p>Easing determines how the change from one value to another should occur. The default is linear, but there are other options that will control the appearance of progression in your animation. for example, ‘cubic-in-out’ allows for the start and end of the animation to have a smoother look.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>anim &lt;-<span class="st"> </span>anim <span class="op">+</span><span class="st"> </span></span>
<span id="cb108-2"><a href="#cb108-2"></a><span class="st">  </span><span class="co"># Slow start and end for a smoother look</span></span>
<span id="cb108-3"><a href="#cb108-3"></a><span class="st">  </span><span class="kw">ease_aes</span>(<span class="st">&#39;cubic-in-out&#39;</span>)</span>
<span id="cb108-4"><a href="#cb108-4"></a></span>
<span id="cb108-5"><a href="#cb108-5"></a>anim</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-93-1.gif" /><!-- --></p>
<p>There are a number of easing functions, all of which are listed within the documentation, which can be viewed, as always, using the <code>?</code> help function: <code>?ease_aes</code>.</p>
</div>
<div id="enter-exit" class="section level5">
<h5><span class="header-section-number">4.9.5.1.4</span> Enter &amp; Exit</h5>
<p>Building on top of easing, we can also control how the data appears (enters) and disappears (exits), using <code>enter_*</code> and <code>exit_*</code>:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>anim &lt;-<span class="st"> </span>anim <span class="op">+</span><span class="st"> </span></span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="st">  </span><span class="co"># fade to enter</span></span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="st">  </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb109-4"><a href="#cb109-4"></a><span class="st">  </span><span class="co"># shrink on exit</span></span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="st">  </span><span class="kw">exit_shrink</span>()</span>
<span id="cb109-6"><a href="#cb109-6"></a></span>
<span id="cb109-7"><a href="#cb109-7"></a>anim</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-94-1.gif" /><!-- --></p>
<p>The changes are subtle but you’ll notice that on transition the data fades in to appear and shrinks upon exit.</p>
</div>
<div id="position-scales" class="section level5">
<h5><span class="header-section-number">4.9.5.1.5</span> Position Scales</h5>
<p>To demonstrate how changing positional scales can be adjusted, let’s take a look at a scatterplot. Here, we’re plotting the relationship between 1/4 mile speed and miles per gallon and we’ll be transitioning between gear.</p>
<p>The static plot would be as follows</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(qsec, mpg))</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-95-1.png" width="672" /></p>
<p>However, upon adding animation, we see how the data changes by gear.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># animate it!</span></span>
<span id="cb111-2"><a href="#cb111-2"></a>scat &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars) <span class="op">+</span><span class="st"> </span></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(qsec, mpg)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb111-4"><a href="#cb111-4"></a><span class="st">  </span><span class="kw">transition_states</span>(gear,</span>
<span id="cb111-5"><a href="#cb111-5"></a>                    <span class="dt">transition_length =</span> <span class="dv">2</span>,</span>
<span id="cb111-6"><a href="#cb111-6"></a>                    <span class="dt">state_length =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb111-7"><a href="#cb111-7"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Now showing gear: {closest_state}&#39;</span>)</span>
<span id="cb111-8"><a href="#cb111-8"></a></span>
<span id="cb111-9"><a href="#cb111-9"></a>scat</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-96-1.gif" /><!-- --></p>
<p>However, the x- and y-axes remain constant throughout the animation.</p>
<p>If you wanted to allow these positional scales to adjust between each gear level, you could use <code>view_step</code>:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># allow positional scaling for each level in gear</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>scat <span class="op">+</span></span>
<span id="cb112-3"><a href="#cb112-3"></a><span class="st">  </span><span class="kw">view_step</span>(<span class="dt">pause_length =</span> <span class="dv">2</span>, </span>
<span id="cb112-4"><a href="#cb112-4"></a>            <span class="dt">step_length =</span> <span class="dv">1</span>, </span>
<span id="cb112-5"><a href="#cb112-5"></a>            <span class="dt">nsteps =</span> <span class="dv">3</span>, </span>
<span id="cb112-6"><a href="#cb112-6"></a>            <span class="dt">include =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-97-1.gif" /><!-- --></p>
</div>
</div>
<div id="example-gapminder" class="section level4">
<h4><span class="header-section-number">4.9.5.2</span> Example: gapminder</h4>
<p>One of the most famous examples of an animated plot uses the gapminder dataset. This dataset includes economic data for countries all over the world. The animated plot here demonstrates the relationship between GDP (per capita) and life expectancy over time, by continent. Note that the year whose data is being displayed is shown at the top left portion of the plot.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># install.packages(&quot;gapminder&quot;)</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="kw">library</span>(gapminder)</span>
<span id="cb113-3"><a href="#cb113-3"></a></span>
<span id="cb113-4"><a href="#cb113-4"></a>gap &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapminder, <span class="kw">aes</span>(gdpPercap, lifeExp, <span class="dt">size =</span> pop, <span class="dt">colour =</span> country)) <span class="op">+</span></span>
<span id="cb113-5"><a href="#cb113-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb113-6"><a href="#cb113-6"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> country_colors) <span class="op">+</span></span>
<span id="cb113-7"><a href="#cb113-7"></a><span class="st">  </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb113-8"><a href="#cb113-8"></a><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span></span>
<span id="cb113-9"><a href="#cb113-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>continent, <span class="dt">ncol =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb113-10"><a href="#cb113-10"></a><span class="st">  </span><span class="kw">theme_half_open</span>(<span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb113-11"><a href="#cb113-11"></a><span class="st">  </span><span class="kw">panel_border</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb113-12"><a href="#cb113-12"></a><span class="st">  </span><span class="co"># animate it!</span></span>
<span id="cb113-13"><a href="#cb113-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Year: {frame_time}&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;GDP per capita&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;life expectancy&#39;</span>) <span class="op">+</span></span>
<span id="cb113-14"><a href="#cb113-14"></a><span class="st">  </span><span class="kw">transition_time</span>(year)</span>
<span id="cb113-15"><a href="#cb113-15"></a></span>
<span id="cb113-16"><a href="#cb113-16"></a>gap</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-98-1.gif" /><!-- --></p>
<p>Note that in this example, we’re now using <code>transition_time()</code> rather than <code>transition_states()</code>. This is a variant of <code>transition_states()</code> that is particularly useful when the states represent points in time, such as the years we’re animating through in the plot above. The transition length is set to correspond to the time difference between the points in the data.</p>
<div id="shadow" class="section level5">
<h5><span class="header-section-number">4.9.5.2.1</span> Shadow</h5>
<p>However, what if we didn’t want the data to completely disappear from one frame to the next and instead wanted to see the pattern emerge over time? We didn’t demonstrate this using the <code>mtcars</code> dataset because each observation in that dataset is a different car. However, here, with the gapminder dataset, where we’re looking at a trend over time, it makes more sense to include a trail</p>
<p>To do this, we would use <code>shadow_*</code>. Here, we’ll use <code>shadow_trail()</code> to see a trail of the data from one frame to the next:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>gap <span class="op">+</span></span>
<span id="cb114-2"><a href="#cb114-2"></a><span class="st"> </span><span class="kw">shadow_trail</span>(<span class="dt">distance =</span> <span class="fl">0.05</span>,</span>
<span id="cb114-3"><a href="#cb114-3"></a>              <span class="dt">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-99-1.gif" /><!-- --></p>
<p>Here, distance specifies the temporal distance between the frames to show and alpha specifies the transparency of the trail, so that the current frame’s data is always discernible.</p>
</div>
</div>
</div>
</div>
<div id="case-studies-3" class="section level2">
<h2><span class="header-section-number">4.10</span> Case Studies</h2>
<p>At this point, we’ve done a lot of work with our case studies. We’ve introduced the case studies, read them into R, and have wrangled the data into a usable format. Now, we get to peak at the data using visualizations to better understand each dataset’s observations and variables!</p>
<p>Let’s start by loading our wrangled tidy data that we previously saved:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="kw">load</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;tidy_data&quot;</span>, <span class="st">&quot;case_study_1_tidy.rda&quot;</span>))</span>
<span id="cb115-2"><a href="#cb115-2"></a></span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="kw">load</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;tidy_data&quot;</span>, <span class="st">&quot;case_study_2_tidy.rda&quot;</span>))</span></code></pre></div>
<div id="case-study-1-health-expenditures-3" class="section level3">
<h3><span class="header-section-number">4.10.1</span> Case Study #1: Health Expenditures</h3>
<p>We’ve now got the data in order so that we can start to explore the relationships between the variables contained in the health care dataset (<code>hc</code>) to answer our questions of interest:</p>
<ol style="list-style-type: decimal">
<li>Is there a relationship between healthcare coverage and healthcare spending in the United States?</li>
<li>How does the spending distribution change across geographic regions in the United States?</li>
<li>Does the relationship between healthcare coverage and healthcare spending in the United States change from 2013 to 2014?</li>
</ol>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># see health care data</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>hc</span></code></pre></div>
<pre><code>## # A tibble: 612 x 10
##    Location  year type  tot_coverage abb   region tot_spending tot_pop
##    &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;int&gt;
##  1 Alabama   2013 Empl…      2126500 AL    South         33788 4763900
##  2 Alabama   2013 Non-…       174200 AL    South         33788 4763900
##  3 Alabama   2013 Medi…       869700 AL    South         33788 4763900
##  4 Alabama   2013 Medi…       783000 AL    South         33788 4763900
##  5 Alabama   2013 Othe…        85600 AL    South         33788 4763900
##  6 Alabama   2013 Unin…       724800 AL    South         33788 4763900
##  7 Alabama   2014 Empl…      2202800 AL    South         35263 4768000
##  8 Alabama   2014 Non-…       288900 AL    South         35263 4768000
##  9 Alabama   2014 Medi…       891900 AL    South         35263 4768000
## 10 Alabama   2014 Medi…       718400 AL    South         35263 4768000
## # … with 602 more rows, and 2 more variables: prop_coverage &lt;dbl&gt;,
## #   spending_capita &lt;dbl&gt;</code></pre>
<p>As a reminder, we have state level data, broken down by year and type of insurance. For each, we have the total number of individuals who have health care coverage (<code>tot_coverage</code>), the amount spent on coverage (<code>tot_spending</code>), the proportion of individuals covered (<code>prop_coverage</code>), and the amount spent per capita (<code>spending_capita</code>). Additionally, we have the state name (<code>Location</code>), the two letter state abbreviation (<code>abb</code>) and the region of the United States where the state is located (<code>region</code>). Let’s get visualizing!</p>
<div id="exploratory-data-analysis-eda" class="section level4">
<h4><span class="header-section-number">4.10.1.1</span> Exploratory Data Analysis (EDA)</h4>
<p>To first get a sense of what information we do and do not have, the <code>visdat</code> package can be very helpful. This package uses <code>ggplot2</code> to visualize missingness in a data frame. For example, <code>vis_dat()</code> takes the data frame as an input and visualizes the observations on the left and the variables across the top. Solid colors indicate that a value is present. Each type of variable is represented by a different color. Grey lines indicate missing values.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="co"># install.packages(&quot;visdat&quot;)</span></span>
<span id="cb118-2"><a href="#cb118-2"></a><span class="kw">library</span>(visdat)</span>
<span id="cb118-3"><a href="#cb118-3"></a></span>
<span id="cb118-4"><a href="#cb118-4"></a><span class="kw">vis_dat</span>(hc)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-102-1.png" width="672" /></p>
<p>We now have a sense that a few states, for some years are missing coverage data, which also affects the ability to calculate proportion covered.</p>
<p>To see these values highlighted more specifically, we can use the related <code>vis_miss()</code> function.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="kw">vis_miss</span>(hc)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-103-1.png" width="672" /></p>
<p>Here we see that missing values only occur 0.6% of the time, with 3.1% of the observations missing entries for <code>tot_coverage</code> and <code>prop_coverage</code>. So, all in all, there is not a lot of missing data, but we still want to be sure we understand where missingness occurs before answering our questions.</p>
<p>Let’s use <code>dplyr</code> to see <em>which</em> observations have missing data:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(tot_coverage))</span></code></pre></div>
<pre><code>## # A tibble: 19 x 10
##    Location  year type  tot_coverage abb   region tot_spending tot_pop
##    &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt; &lt;fct&gt;         &lt;dbl&gt;   &lt;int&gt;
##  1 Arizona   2013 Othe…           NA AZ    West          41481 6603100
##  2 Arizona   2014 Othe…           NA AZ    West          43356 6657200
##  3 Distric…  2013 Othe…           NA DC    South          7443  652100
##  4 Distric…  2014 Othe…           NA DC    South          7871  656900
##  5 Indiana   2014 Othe…           NA IN    North…        54741 6477500
##  6 Kansas    2013 Othe…           NA KS    North…        21490 2817600
##  7 Kansas    2014 Othe…           NA KS    North…        22183 2853000
##  8 Kentucky  2014 Othe…           NA KY    South         35323 4315700
##  9 Massach…  2013 Othe…           NA MA    North…        68899 6647700
## 10 Massach…  2014 Othe…           NA MA    North…        71274 6658100
## 11 New Ham…  2014 Othe…           NA NH    North…        12742 1319700
## 12 New Jer…  2013 Othe…           NA NJ    North…        75148 8807400
## 13 North D…  2013 Othe…           NA ND    North…         6795  714500
## 14 Oklahoma  2013 Othe…           NA OK    South         28097 3709400
## 15 Rhode I…  2014 Othe…           NA RI    North…        10071 1048200
## 16 Tenness…  2013 Othe…           NA TN    South         46149 6400200
## 17 Tenness…  2014 Othe…           NA TN    South         48249 6502000
## 18 West Vi…  2013 Othe…           NA WV    South         16622 1822000
## 19 Wiscons…  2014 Othe…           NA WI    North…        50109 5747200
## # … with 2 more variables: prop_coverage &lt;dbl&gt;, spending_capita &lt;dbl&gt;</code></pre>
<p>Ah, so we see that the “Other” type of coverage is missing in both 2013 and 2014 for a subset of states. We’ll be focusing on the non-“Other” types of healthcare coverage, so this shouldn’t pose a problem, but is good to know!</p>
<p>Taking this one step further, let’s skim the entire dataset to get a sense of the information stored in each variable:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="kw">library</span>(skimr)</span>
<span id="cb122-2"><a href="#cb122-2"></a></span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="co"># get summary of the data</span></span>
<span id="cb122-4"><a href="#cb122-4"></a><span class="kw">skim</span>(hc)</span></code></pre></div>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
(#tab:unnamed-chunk-105)Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
hc
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
612
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
type
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
abb
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
region
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Sou: 204, Wes: 156, Nor: 144, Nor: 108
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
2013.50
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
2013.00
</td>
<td style="text-align:right;">
2013.00
</td>
<td style="text-align:right;">
2013.50
</td>
<td style="text-align:right;">
2014.00
</td>
<td style="text-align:right;">
2014.00
</td>
<td style="text-align:left;">
▇▁▁▁▇
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_coverage
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
1059391.91
</td>
<td style="text-align:right;">
1864110.89
</td>
<td style="text-align:right;">
9900.00
</td>
<td style="text-align:right;">
135700.00
</td>
<td style="text-align:right;">
436800.00
</td>
<td style="text-align:right;">
1036800.00
</td>
<td style="text-align:right;">
17747300.00
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_spending
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
49004.39
</td>
<td style="text-align:right;">
54031.44
</td>
<td style="text-align:right;">
4639.00
</td>
<td style="text-align:right;">
12742.00
</td>
<td style="text-align:right;">
33939.00
</td>
<td style="text-align:right;">
60364.00
</td>
<td style="text-align:right;">
291989.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_pop
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6172245.10
</td>
<td style="text-align:right;">
6983404.37
</td>
<td style="text-align:right;">
572000.00
</td>
<td style="text-align:right;">
1610200.00
</td>
<td style="text-align:right;">
4357900.00
</td>
<td style="text-align:right;">
6866000.00
</td>
<td style="text-align:right;">
38701300.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
prop_coverage
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:left;">
▇▅▁▁▂
</td>
</tr>
<tr>
<td style="text-align:left;">
spending_capita
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
8246.17
</td>
<td style="text-align:right;">
1263.98
</td>
<td style="text-align:right;">
5676.52
</td>
<td style="text-align:right;">
7395.76
</td>
<td style="text-align:right;">
8049.26
</td>
<td style="text-align:right;">
8993.86
</td>
<td style="text-align:right;">
11982.04
</td>
<td style="text-align:left;">
▂▇▅▃▁
</td>
</tr>
</tbody>
</table>
<p>At a glance, by looking at the <code>hist</code> column of the output for our numeric/integer variables, we see that there is a long right tail in <code>tot_coverage</code> and <code>tot_pop</code>.</p>
<p>We see that proportion coverage varies from 0.0054 (<code>p0</code>) to 0.61 (<code>p100</code>). So, we’ll want to know which states are at each end of the spectrum here.</p>
<p>We also see that for <code>tot_spending</code>, the <code>mean</code> is 49004 and the median (<code>p50</code>) is slightly lower and that this variable also has a long right tail (<code>hist</code>).</p>
<p>We also know that these data come from two different years, so we can group by <code>year</code> and again summarize the data:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co"># group by year</span></span>
<span id="cb123-2"><a href="#cb123-2"></a>hc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb123-3"><a href="#cb123-3"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></span>
<span id="cb123-4"><a href="#cb123-4"></a><span class="st">  </span><span class="kw">skim</span>()</span></code></pre></div>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
(#tab:unnamed-chunk-106)Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
Piped data
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
612
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
year
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
type
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
type
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
abb
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
abb
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
region
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Sou: 102, Wes: 78, Nor: 72, Nor: 54
</td>
</tr>
<tr>
<td style="text-align:left;">
region
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Sou: 102, Wes: 78, Nor: 72, Nor: 54
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
year
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
tot_coverage
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
1052927.61
</td>
<td style="text-align:right;">
1863158.94
</td>
<td style="text-align:right;">
9900.00
</td>
<td style="text-align:right;">
132300.00
</td>
<td style="text-align:right;">
426300.00
</td>
<td style="text-align:right;">
1034500.00
</td>
<td style="text-align:right;">
17747300.00
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_coverage
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
1065878.04
</td>
<td style="text-align:right;">
1868198.24
</td>
<td style="text-align:right;">
9900.00
</td>
<td style="text-align:right;">
137700.00
</td>
<td style="text-align:right;">
450150.00
</td>
<td style="text-align:right;">
1056725.00
</td>
<td style="text-align:right;">
17703700.00
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_spending
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
47757.31
</td>
<td style="text-align:right;">
52637.29
</td>
<td style="text-align:right;">
4639.00
</td>
<td style="text-align:right;">
12392.00
</td>
<td style="text-align:right;">
33468.00
</td>
<td style="text-align:right;">
60364.00
</td>
<td style="text-align:right;">
278168.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_spending
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
50251.47
</td>
<td style="text-align:right;">
55448.72
</td>
<td style="text-align:right;">
4856.00
</td>
<td style="text-align:right;">
12742.00
</td>
<td style="text-align:right;">
35299.00
</td>
<td style="text-align:right;">
62847.00
</td>
<td style="text-align:right;">
291989.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_pop
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6145121.57
</td>
<td style="text-align:right;">
6945677.64
</td>
<td style="text-align:right;">
582200.00
</td>
<td style="text-align:right;">
1600600.00
</td>
<td style="text-align:right;">
4400100.00
</td>
<td style="text-align:right;">
6866000.00
</td>
<td style="text-align:right;">
38176400.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
tot_pop
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6199368.63
</td>
<td style="text-align:right;">
7032201.22
</td>
<td style="text-align:right;">
572000.00
</td>
<td style="text-align:right;">
1610200.00
</td>
<td style="text-align:right;">
4315700.00
</td>
<td style="text-align:right;">
7085000.00
</td>
<td style="text-align:right;">
38701300.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
prop_coverage
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:left;">
▇▆▁▁▂
</td>
</tr>
<tr>
<td style="text-align:left;">
prop_coverage
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:left;">
▇▅▁▁▂
</td>
</tr>
<tr>
<td style="text-align:left;">
spending_capita
</td>
<td style="text-align:right;">
2013
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
8064.53
</td>
<td style="text-align:right;">
1228.01
</td>
<td style="text-align:right;">
5676.52
</td>
<td style="text-align:right;">
7210.56
</td>
<td style="text-align:right;">
7842.66
</td>
<td style="text-align:right;">
8883.00
</td>
<td style="text-align:right;">
11413.89
</td>
<td style="text-align:left;">
▂▇▅▃▁
</td>
</tr>
<tr>
<td style="text-align:left;">
spending_capita
</td>
<td style="text-align:right;">
2014
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
8427.80
</td>
<td style="text-align:right;">
1275.27
</td>
<td style="text-align:right;">
6007.03
</td>
<td style="text-align:right;">
7544.68
</td>
<td style="text-align:right;">
8242.67
</td>
<td style="text-align:right;">
9378.16
</td>
<td style="text-align:right;">
11982.04
</td>
<td style="text-align:left;">
▂▇▃▃▁
</td>
</tr>
</tbody>
</table>
<p>At a glance, there doesn’t appear to be a huge difference in the variables from one year to the next, but we’ll explore this again in a bit.</p>
<p>With at least some understanding of the data in our dataset, let’s start generating exploratory plots that will help us answer each of our questions of interest.</p>
</div>
<div id="q1-relationship-between-coverage-and-spending" class="section level4">
<h4><span class="header-section-number">4.10.1.2</span> Q1: Relationship between coverage and spending?</h4>
<p>To answer the question:</p>
<blockquote>
<p>Is there a relationship between healthcare coverage and healthcare spending in the United States?</p>
</blockquote>
<p>We’ll have to visualize coverage and spending data across the United States.</p>
<p>And, to understand the relationship between two continuous variables - coverage and spending - a scatterplot will be the most effective visualization.</p>
<p>We’ll first look at a scatterplot:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb124-2"><a href="#cb124-2"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>, </span>
<span id="cb124-3"><a href="#cb124-3"></a>         year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb124-4"><a href="#cb124-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb124-5"><a href="#cb124-5"></a>             <span class="dt">y =</span> prop_coverage)) <span class="op">+</span></span>
<span id="cb124-6"><a href="#cb124-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb124-7"><a href="#cb124-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb124-8"><a href="#cb124-8"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-107-1.png" width="672" /></p>
<p>We see that there appears to be some relationship, with those states that spend more per capita also having higher proportions of their population having healthcare coverage.</p>
<p>We can continue to improve this plot to better understand the underlying data. For example, we can add a best-fit line using <code>geom_smooth()</code> to visualize the magnitude of the linear relationship:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># generate scatterplot with fit line</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>, </span>
<span id="cb125-4"><a href="#cb125-4"></a>         year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb125-6"><a href="#cb125-6"></a>             <span class="dt">y =</span> prop_coverage)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb125-7"><a href="#cb125-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb125-8"><a href="#cb125-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb125-9"><a href="#cb125-9"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb125-10"><a href="#cb125-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-108-1.png" width="672" /></p>
<p>Beyond that, we likely want to know which point represents which state, so we can add state labels:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="co"># add state abbreviation labels</span></span>
<span id="cb127-2"><a href="#cb127-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>, </span>
<span id="cb127-4"><a href="#cb127-4"></a>         year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb127-5"><a href="#cb127-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb127-6"><a href="#cb127-6"></a>             <span class="dt">y =</span> prop_coverage)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-7"><a href="#cb127-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-8"><a href="#cb127-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb127-9"><a href="#cb127-9"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb127-10"><a href="#cb127-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb127-11"><a href="#cb127-11"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb127-12"><a href="#cb127-12"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-109-1.png" width="672" /></p>
<p>From there, it’d likely be helpful to have information from each region:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1"></a><span class="co"># color by region</span></span>
<span id="cb129-2"><a href="#cb129-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>, </span>
<span id="cb129-4"><a href="#cb129-4"></a>         year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb129-5"><a href="#cb129-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb129-6"><a href="#cb129-6"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb129-7"><a href="#cb129-7"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb129-8"><a href="#cb129-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb129-9"><a href="#cb129-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb129-10"><a href="#cb129-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb129-11"><a href="#cb129-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb129-12"><a href="#cb129-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb129-13"><a href="#cb129-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb129-14"><a href="#cb129-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-110-1.png" width="672" /></p>
<p>So far, we’ve only been focusing on data from 2013. What about looking at data from both 2013 and 2014? We can do that using <code>facet_wrap()</code>:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="co"># color by region</span></span>
<span id="cb131-2"><a href="#cb131-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb131-4"><a href="#cb131-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb131-5"><a href="#cb131-5"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb131-6"><a href="#cb131-6"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb131-7"><a href="#cb131-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb131-8"><a href="#cb131-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year) <span class="op">+</span></span>
<span id="cb131-9"><a href="#cb131-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb131-10"><a href="#cb131-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb131-11"><a href="#cb131-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb131-12"><a href="#cb131-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb131-13"><a href="#cb131-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb131-14"><a href="#cb131-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-111-1.png" width="672" /></p>
<p>We see that the overall trend holds, but there has been some movement. For example, we see at a glance that DC has a higher proportion of its population covered in 2014 relative to 2013, while MA saw a drop in coverage. UT appears to be an outlier in both years having low spending but a high proportion of individuals covered.</p>
<p>Beyond “Employer”-held healthcare coverage, let’s look at the other types of coverage data we have. Here, we’ll facet by type, rather than year, again focusing on just data from 2013.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># visualize 2013 data by type</span></span>
<span id="cb133-2"><a href="#cb133-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb133-4"><a href="#cb133-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb133-5"><a href="#cb133-5"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb133-6"><a href="#cb133-6"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb133-7"><a href="#cb133-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb133-8"><a href="#cb133-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type) <span class="op">+</span></span>
<span id="cb133-9"><a href="#cb133-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb133-10"><a href="#cb133-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb133-11"><a href="#cb133-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb133-12"><a href="#cb133-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb133-13"><a href="#cb133-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb133-14"><a href="#cb133-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-112-1.png" width="672" /></p>
<p>From these data, we see that Employer health care coverage is the most popular way in which individuals receive their health insurance across all states. We also see a flat or positive relationship for all other types of insurance, except for “Uninsured”. There, as makes sense, we see that the more money spent per capita the fewer individuals the state has without insurance.</p>
<p>We can quickly peak at the data from 2014 to be sure the same general patterns hold:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="co"># visualize 2014 data by type</span></span>
<span id="cb135-2"><a href="#cb135-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> &quot;2014&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb135-4"><a href="#cb135-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb135-5"><a href="#cb135-5"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb135-6"><a href="#cb135-6"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-7"><a href="#cb135-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-8"><a href="#cb135-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type) <span class="op">+</span></span>
<span id="cb135-9"><a href="#cb135-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb135-10"><a href="#cb135-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb135-11"><a href="#cb135-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-12"><a href="#cb135-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb135-13"><a href="#cb135-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb135-14"><a href="#cb135-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-113-1.png" width="672" /></p>
<p>The same general patterns hold in 2014 as we saw in 2013; however, the patterns are not exactly the same.</p>
<p>With these plots we have a pretty good understanding of the relationship between spending and coverage across this country when it comes to health care.</p>
<p>Let’s save some of these plots for later:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="kw">pdf</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;exploratory&quot;</span>, <span class="st">&quot;2013and2014_spending_and_coverage.pdf&quot;</span>))</span>
<span id="cb137-2"><a href="#cb137-2"></a></span>
<span id="cb137-3"><a href="#cb137-3"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb137-4"><a href="#cb137-4"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb137-5"><a href="#cb137-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb137-6"><a href="#cb137-6"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb137-7"><a href="#cb137-7"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-8"><a href="#cb137-8"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-9"><a href="#cb137-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>year) <span class="op">+</span></span>
<span id="cb137-10"><a href="#cb137-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb137-11"><a href="#cb137-11"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb137-12"><a href="#cb137-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-13"><a href="#cb137-13"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb137-14"><a href="#cb137-14"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb137-15"><a href="#cb137-15"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="kw">pdf</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;exploratory&quot;</span>, <span class="st">&quot;2013_coverage_type.pdf&quot;</span>))</span>
<span id="cb141-2"><a href="#cb141-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> &quot;2013&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb141-4"><a href="#cb141-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb141-5"><a href="#cb141-5"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb141-6"><a href="#cb141-6"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb141-7"><a href="#cb141-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb141-8"><a href="#cb141-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type) <span class="op">+</span></span>
<span id="cb141-9"><a href="#cb141-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb141-10"><a href="#cb141-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb141-11"><a href="#cb141-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb141-12"><a href="#cb141-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb141-13"><a href="#cb141-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb141-14"><a href="#cb141-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 9 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 9 rows containing missing values (geom_text).</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="kw">pdf</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;exploratory&quot;</span>, <span class="st">&quot;2014_coverage_type.pdf&quot;</span>))</span>
<span id="cb148-2"><a href="#cb148-2"></a>hc <span class="op">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> &quot;2014&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb148-4"><a href="#cb148-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb148-5"><a href="#cb148-5"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb148-6"><a href="#cb148-6"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb148-7"><a href="#cb148-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb148-8"><a href="#cb148-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type) <span class="op">+</span></span>
<span id="cb148-9"><a href="#cb148-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb148-10"><a href="#cb148-10"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb148-11"><a href="#cb148-11"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb148-12"><a href="#cb148-12"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>abb), </span>
<span id="cb148-13"><a href="#cb148-13"></a>            <span class="dt">nudge_x =</span> <span class="dv">150</span>, </span>
<span id="cb148-14"><a href="#cb148-14"></a>            <span class="dt">show.legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 10 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_text).</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
</div>
<div id="q2-spending-across-geographic-regions" class="section level4">
<h4><span class="header-section-number">4.10.1.3</span> Q2: Spending Across Geographic Regions?</h4>
<p>To answer the question:</p>
<blockquote>
<p>Which US states spend the most and which spend the least on healthcare? How does the spending distribution change across geographic regions in the United States?</p>
</blockquote>
<p>We’ll want to visualize healthcare spending across regions of the US.</p>
<p>We saw in the previous plots that there are some regional effects when it comes to spending, as the states from the different regions tended to cluster in the previous plot. But, let’s look at this explicitly now.</p>
<p>We’re looking to visualize a continuous variable (<code>spending_capita</code>) by a categorical variable (<code>region</code>), so a boxplot is always a good place to start:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="co"># generate boxplot</span></span>
<span id="cb155-2"><a href="#cb155-2"></a>hc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb155-3"><a href="#cb155-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> region, </span>
<span id="cb155-4"><a href="#cb155-4"></a>             <span class="dt">y =</span> spending_capita)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb155-5"><a href="#cb155-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb155-6"><a href="#cb155-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;spending per capita&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-115-1.png" width="672" /></p>
<p>Here, we get a sense of the overall trend, seeing that states in the Northeast tend to spend the most on health care, while states in the West spend the least.</p>
<p>But, sometimes, it can be helpful to see the distribution of points along with the boxplot, so we can add those onto the plot. We’ll use <code>geom_jitter()</code> rather than <code>geom_point()</code> here so that we can see all the points without overlap. Note that we also use <code>alpha = 0.2</code> to increase the transparency of the points and <code>outlier.shape = NA</code> to hide the outliers on the boxplot. This way, each observation is only plotted a single time:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="co"># add data points to boxplot</span></span>
<span id="cb156-2"><a href="#cb156-2"></a>hc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb156-3"><a href="#cb156-3"></a><span class="st">  </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;Employer&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb156-4"><a href="#cb156-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> region, </span>
<span id="cb156-5"><a href="#cb156-5"></a>             <span class="dt">y =</span> spending_capita)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb156-6"><a href="#cb156-6"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb156-7"><a href="#cb156-7"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb156-8"><a href="#cb156-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;spending per capita&quot;</span>)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-116-1.png" width="672" /></p>
<p>This gives us a sense of the variation in spending for states in each region. Of note, there are more outliers in the South and West, with a few states spending more on health care than even states in the Northeast, where spending tends to be higher.</p>
<p>With this we have a good sense of the regional effects of spending across the United states.</p>
</div>
<div id="q3-coverage-and-spending-change-over-time" class="section level4">
<h4><span class="header-section-number">4.10.1.4</span> Q3: Coverage and Spending Change Over Time?</h4>
<p>To answer the question:</p>
<blockquote>
<p>Does the relationship between healthcare coverage and healthcare spending in the United States change from 2013 to 2014?</p>
</blockquote>
<p>we’ll need to visualize a whole bunch of variables: coverage, spending, <code>year</code> and type of insurance. We can return to a scatterplot again, but now we’ll put all these pieces we looked at separately in Q1 together at once to answer this temporal question visually.</p>
<p>We won’t filter the dataset but will instead use <code>facet_grid()</code>, which “forms a matrix of panels defined by row and column faceting variables”:</p>
<p><code>facet_wrap()</code>, which we used previously, <em>typically</em> utilizes screen space better than <code>facet_grid()</code>; however, in this case, where we want 2013 and 2014 to each be in a separate row, <code>facet_grid()</code> is the better visual choice.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="co"># color by region</span></span>
<span id="cb157-2"><a href="#cb157-2"></a>hc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-3"><a href="#cb157-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spending_capita, </span>
<span id="cb157-4"><a href="#cb157-4"></a>             <span class="dt">y =</span> prop_coverage,</span>
<span id="cb157-5"><a href="#cb157-5"></a>             <span class="dt">color =</span> region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb157-6"><a href="#cb157-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb157-7"><a href="#cb157-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;spending per capita&quot;</span>,</span>
<span id="cb157-8"><a href="#cb157-8"></a>       <span class="dt">y =</span> <span class="st">&quot;coverage proportion&quot;</span>) <span class="op">+</span></span>
<span id="cb157-9"><a href="#cb157-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb157-10"><a href="#cb157-10"></a><span class="st">  </span><span class="kw">facet_grid</span>(year<span class="op">~</span>type)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="images/dataviz-unnamed-chunk-117-1.png" width="672" /></p>
<p>With this, output the top row are the data from 2013 and the bottom from 2014. We can then visually compare the top plot to the bottom plot for each time of insurance.</p>
<p>Visually, we can start to get a sense that a few things changed from 2013 to 2014. For example, as we saw previously, individual states changed from one year to the next, but overall patterns seem to hold pretty steady between these two years.</p>
<p>We were able to start answering all our questions of interest with a number of quick plots using <code>ggplot2</code>.</p>
<p>Now, of course there are <em>many</em> ways in which we could customize each of these plots to be “publication-ready,” but for now, we’ll stop with this case study having gained a lot of new insight into these data and answers to our questions we now have, simply from generating a few exploratory plots.</p>
</div>
</div>
<div id="case-study-2-firearms-3" class="section level3">
<h3><span class="header-section-number">4.10.2</span> Case Study #2: Firearms</h3>
<p>For our second case study, we’re interested in the following question:</p>
<blockquote>
<p>At the state-level, what is the relationship between firearm legislation strength and annual rate of fatal police shootings?</p>
</blockquote>
<p>In the previous course, we wrangled the data into a single, helpful data frame: <code>firearms</code>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a><span class="co"># see firearms data</span></span>
<span id="cb159-2"><a href="#cb159-2"></a>firearms</span></code></pre></div>
<pre><code>## # A tibble: 51 x 15
##    NAME  white black hispanic  male total_pop violent_crime brady_scores
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;
##  1 alab…  69.5 26.7      4.13  48.5   4850858          472.        -18  
##  2 alas…  66.5  3.67     6.82  52.4    737979          730.        -30  
##  3 ariz…  83.5  4.80    30.9   49.7   6802262          410.        -39  
##  4 arka…  79.6 15.7      7.18  49.1   2975626          521.        -24  
##  5 cali…  73.0  6.49    38.7   49.7  39032444          426.         76  
##  6 colo…  87.6  4.47    21.3   50.3   5440445          321          22  
##  7 conn…  80.9 11.6     15.3   48.8   3593862          218.         73  
##  8 dela…  70.3 22.5      8.96  48.4    944107          499          41  
##  9 dist…  44.1 48.5     10.7   47.4    672736         1269.         NA  
## 10 flor…  77.7 16.9     24.7   48.9  20268567          462.        -20.5
## # … with 41 more rows, and 7 more variables: gunshot_tally &lt;int&gt;,
## #   gunshot_filtered &lt;int&gt;, gunshot_rate &lt;dbl&gt;, unemployment_rate &lt;dbl&gt;,
## #   unemployment_rank &lt;int&gt;, density &lt;dbl&gt;, ownership &lt;dbl&gt;</code></pre>
<p>This dataset contains state level information about firearm ownership (broken down by ethnicity and gender), the population of each state (<code>total_pop</code>), the number of violent crimes (<code>violent_crime</code>), the “total state points” from the Brady Scorecard (<code>brady_scores</code>), the number of gunshots (<code>gunshot_tally</code>), the number of gunshots from armed, non-white, male individuals (<code>gunshot_filtered</code>), the annualized rate per 1,000,000 residents (<code>gunshot_rate</code>), the <code>unemployment rate</code> and <code>unemployment_rank</code>, population density (<code>density</code>), and firearm ownership as a percent of firearm suicides to all suicides (<code>ownership</code>).</p>
<div id="exploratory-data-analysis-eda-1" class="section level4">
<h4><span class="header-section-number">4.10.2.1</span> Exploratory Data Analysis (EDA)</h4>
<p>Similar to how we approached the health care case study, let’s get an overall understanding of the data in our dataset, starting with understanding where data are missing in our dataset:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="co"># visualize missingness</span></span>
<span id="cb161-2"><a href="#cb161-2"></a><span class="kw">vis_dat</span>(firearms)</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-119-1.png" width="672" /></p>
<p>We see that we have data for all 50 states (and Washington, D.C.) for most variables in our dataset; however, we’re missing information for one state when it comes to gunshot information and another state when it comes to Brady scores and ownership by suicide rates.</p>
<p>Additionally, we see that most of our variables are numeric (either integers or numeric) while the state name (<code>NAME</code>) is a character, confirming what we expect for these data.</p>
<p>We will also again use <code>skim()</code> to get a better sense of the values in our dataset:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1"></a><span class="co"># summarize data</span></span>
<span id="cb162-2"><a href="#cb162-2"></a><span class="kw">skim</span>(firearms)</span></code></pre></div>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
(#tab:unnamed-chunk-120)Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
firearms
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
51
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
NAME
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
white
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
78.83
</td>
<td style="text-align:right;">
13.17
</td>
<td style="text-align:right;">
26.02
</td>
<td style="text-align:right;">
71.95
</td>
<td style="text-align:right;">
82.15
</td>
<td style="text-align:right;">
87.65
</td>
<td style="text-align:right;">
94.95
</td>
<td style="text-align:left;">
▁▁▂▆▇
</td>
</tr>
<tr>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
11.70
</td>
<td style="text-align:right;">
10.89
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
3.56
</td>
<td style="text-align:right;">
8.23
</td>
<td style="text-align:right;">
16.26
</td>
<td style="text-align:right;">
48.52
</td>
<td style="text-align:left;">
▇▃▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
hispanic
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
11.55
</td>
<td style="text-align:right;">
10.18
</td>
<td style="text-align:right;">
1.49
</td>
<td style="text-align:right;">
4.92
</td>
<td style="text-align:right;">
9.08
</td>
<td style="text-align:right;">
13.15
</td>
<td style="text-align:right;">
48.20
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
49.40
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
47.44
</td>
<td style="text-align:right;">
48.78
</td>
<td style="text-align:right;">
49.28
</td>
<td style="text-align:right;">
49.78
</td>
<td style="text-align:right;">
52.37
</td>
<td style="text-align:left;">
▁▇▇▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
total_pop
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6294898.80
</td>
<td style="text-align:right;">
7191254.03
</td>
<td style="text-align:right;">
586102.00
</td>
<td style="text-align:right;">
1744545.50
</td>
<td style="text-align:right;">
4422057.00
</td>
<td style="text-align:right;">
6977540.00
</td>
<td style="text-align:right;">
39032444.00
</td>
<td style="text-align:left;">
▇▂▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
violent_crime
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
379.86
</td>
<td style="text-align:right;">
186.69
</td>
<td style="text-align:right;">
118.00
</td>
<td style="text-align:right;">
257.60
</td>
<td style="text-align:right;">
349.60
</td>
<td style="text-align:right;">
441.75
</td>
<td style="text-align:right;">
1269.10
</td>
<td style="text-align:left;">
▇▇▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
brady_scores
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
3.94
</td>
<td style="text-align:right;">
32.25
</td>
<td style="text-align:right;">
-39.00
</td>
<td style="text-align:right;">
-19.00
</td>
<td style="text-align:right;">
-8.75
</td>
<td style="text-align:right;">
19.62
</td>
<td style="text-align:right;">
76.00
</td>
<td style="text-align:left;">
▇▇▂▁▃
</td>
</tr>
<tr>
<td style="text-align:left;">
gunshot_tally
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
20.34
</td>
<td style="text-align:right;">
30.57
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
5.25
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
20.00
</td>
<td style="text-align:right;">
196.00
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
gunshot_filtered
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
17.28
</td>
<td style="text-align:right;">
24.47
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
14.00
</td>
<td style="text-align:right;">
18.75
</td>
<td style="text-align:right;">
150.00
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
gunshot_rate
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
1.74
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
1.51
</td>
<td style="text-align:right;">
2.10
</td>
<td style="text-align:right;">
5.12
</td>
<td style="text-align:left;">
▇▇▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
unemployment_rate
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
5.04
</td>
<td style="text-align:right;">
1.08
</td>
<td style="text-align:right;">
2.80
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
5.10
</td>
<td style="text-align:right;">
6.00
</td>
<td style="text-align:right;">
6.90
</td>
<td style="text-align:left;">
▃▅▅▇▅
</td>
</tr>
<tr>
<td style="text-align:left;">
unemployment_rank
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
25.47
</td>
<td style="text-align:right;">
14.78
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
13.00
</td>
<td style="text-align:right;">
26.00
</td>
<td style="text-align:right;">
38.00
</td>
<td style="text-align:right;">
51.00
</td>
<td style="text-align:left;">
▇▇▇▇▇
</td>
</tr>
<tr>
<td style="text-align:left;">
density
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
412.52
</td>
<td style="text-align:right;">
1537.71
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
47.77
</td>
<td style="text-align:right;">
106.35
</td>
<td style="text-align:right;">
226.87
</td>
<td style="text-align:right;">
11019.43
</td>
<td style="text-align:left;">
▇▁▁▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
ownership
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
51.07
</td>
<td style="text-align:right;">
12.11
</td>
<td style="text-align:right;">
20.27
</td>
<td style="text-align:right;">
47.85
</td>
<td style="text-align:right;">
52.04
</td>
<td style="text-align:right;">
59.79
</td>
<td style="text-align:right;">
70.09
</td>
<td style="text-align:left;">
▂▁▅▇▅
</td>
</tr>
</tbody>
</table>
<p>Ultimately, we’re interested in firearm legislation and fatal police shootings, which we’ll get to, but let’s explore the relationship between other variables in our dataset first to gain a more complete understanding.</p>
<p>For example, determining if there’s a relationship between the number of violent crimes and the total population in a state is good to know. Outliers in this relationship would be important to note as they would be states with either lower or higher crime by population. Let’s use a scatterplot to better understand this relationship:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a><span class="co"># violent crimes</span></span>
<span id="cb163-2"><a href="#cb163-2"></a><span class="kw">ggplot</span>(firearms, </span>
<span id="cb163-3"><a href="#cb163-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> total_pop,</span>
<span id="cb163-4"><a href="#cb163-4"></a>           <span class="dt">y =</span> violent_crime)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-5"><a href="#cb163-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb163-6"><a href="#cb163-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total Population&quot;</span>,</span>
<span id="cb163-7"><a href="#cb163-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Violent Crime&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-8"><a href="#cb163-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-9"><a href="#cb163-9"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> NAME))</span></code></pre></div>
<pre><code>## Warning: ggrepel: 21 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="images/dataviz-unnamed-chunk-121-1.png" width="672" /></p>
<p>Here we see that the visualization of this relationship is largely dependent upon the state’s population, with large states like Texas and California sticking out. However, we do see that, for its size, Washington D.C had many more violent cries than other states, despite its small population.</p>
<p>It would also be helpful to understand the relationship between unemployment and violent crime:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a><span class="co"># violent crimes</span></span>
<span id="cb165-2"><a href="#cb165-2"></a><span class="kw">ggplot</span>(firearms, </span>
<span id="cb165-3"><a href="#cb165-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> unemployment_rate,</span>
<span id="cb165-4"><a href="#cb165-4"></a>           <span class="dt">y =</span> violent_crime)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-5"><a href="#cb165-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb165-6"><a href="#cb165-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Unemployment Rate&quot;</span>,</span>
<span id="cb165-7"><a href="#cb165-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Violent Crime&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb165-8"><a href="#cb165-8"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="images/dataviz-unnamed-chunk-122-1.png" width="672" /></p>
<p>Here, there appears to be some relationship with states that have higher rates of unemployment having slightly more violent crimes, but violent crimes is not adjusted by population, so this is likely not <em>that</em> helpful.</p>
<p>What about the relationship between fatal police shootings and gun <code>ownership</code> as a percent of firearm suicides to all suicides.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a><span class="co"># violent crimes</span></span>
<span id="cb166-2"><a href="#cb166-2"></a><span class="kw">ggplot</span>(firearms, </span>
<span id="cb166-3"><a href="#cb166-3"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> gunshot_rate,</span>
<span id="cb166-4"><a href="#cb166-4"></a>           <span class="dt">y =</span> ownership)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb166-5"><a href="#cb166-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb166-6"><a href="#cb166-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Annualized Rate of Fatal </span><span class="ch">\n</span><span class="st"> Police Shootings per 1,000,000&quot;</span>,</span>
<span id="cb166-7"><a href="#cb166-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Gun Ownership </span><span class="ch">\n</span><span class="st"> (firearm suicides:all suicides)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb166-8"><a href="#cb166-8"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-123-1.png" width="672" /></p>
<p>This suggests that states with more fatal police shootings <em>tend</em> to have more firearm suicides relative to non-firearm suicides; however, this relationship is non linear.</p>
<p>With these plots, we’re starting to get an understanding of the data and see that there are patterns and don’t appear to be wild outliers in any one variable (although, we should keep an eye on Washington, D.C. as it appeared as an outlier in a few plots). With that we’re confident we can move on to start looking into our question of interest.</p>
</div>
<div id="q-fatal-police-shootings-and-legislation" class="section level4">
<h4><span class="header-section-number">4.10.2.2</span> Q: Fatal Police Shootings and Legislation</h4>
<p>Ultimately, we’re interested in firearm legislation and fatal police shootings, so let’s focus in on Brady scores here, which measure legislation and <code>gunshot_tally</code>, a measure of the rate of fatal police shootings.</p>
<p>We see that the average <code>brady_score</code> (<code>mean</code>) is 3.94, with state values ranging from -39 to 76.</p>
<p>When it comes to the rate of police shootings (<code>gunshot_rate</code>), we see the average number (<code>mean</code>) for a state is is 1.74, with state values ranging from 0.28 to 5.12, depending on the state.</p>
<p>To start to understand the relationship between the two, we’ll want to visualize this relationship using a scatterplot:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a><span class="co"># visualize legistlation and shootings</span></span>
<span id="cb168-2"><a href="#cb168-2"></a><span class="kw">ggplot</span>(firearms, <span class="kw">aes</span>(<span class="dt">x =</span> brady_scores, </span>
<span id="cb168-3"><a href="#cb168-3"></a>                     <span class="dt">y =</span> gunshot_rate)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb168-4"><a href="#cb168-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb168-5"><a href="#cb168-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Firearm Legislative Strength Score&quot;</span>,</span>
<span id="cb168-6"><a href="#cb168-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Annualized Rate of Fatal </span><span class="ch">\n</span><span class="st"> Police Shootings per 1,000,000&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb168-7"><a href="#cb168-7"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-124-1.png" width="672" /></p>
<p>In this plot, we see that there is a relationship, but it is non-linear. Overall, the higher the legislative strength score (<code>brady_scores</code>), the lower the rate of police shootings; however, this decrease is nonlinear, as all states with a positive Brady Score have a similar police shooting rate.</p>
<p>For now, we won’t explore a model, but we will label the points to better contextualize the information displayed. To see which states are at either end of the distribution, using <code>geom_text()</code> is a good option:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="co"># label points with state name</span></span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="kw">ggplot</span>(firearms, <span class="kw">aes</span>(<span class="dt">x =</span> brady_scores, </span>
<span id="cb170-3"><a href="#cb170-3"></a>                     <span class="dt">y =</span> gunshot_rate)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb170-4"><a href="#cb170-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb170-5"><a href="#cb170-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Firearm Legislative Strength Score&quot;</span>,</span>
<span id="cb170-6"><a href="#cb170-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Annualized Rate of Fatal </span><span class="ch">\n</span><span class="st"> Police Shootings per 1,000,000&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb170-7"><a href="#cb170-7"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb170-8"><a href="#cb170-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> NAME), </span>
<span id="cb170-9"><a href="#cb170-9"></a>            <span class="dt">nudge_x =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_text).</code></pre>
<p><img src="images/dataviz-unnamed-chunk-125-1.png" width="672" /></p>
<p>This makes it clear that Wyoming, New Mexico, Oklahoma, Arizona, and Nevada have some of the highest rates of fatal police shootings, while Connecticut, New York, Pennsylvania, and North Dakota are among the lowest.</p>
<p>However, a number of labels overlap there, so it can be helpful to use <code>ggrepel</code> if you want to be able to match each point to its label:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb173-2"><a href="#cb173-2"></a></span>
<span id="cb173-3"><a href="#cb173-3"></a><span class="co"># repel points with state name </span></span>
<span id="cb173-4"><a href="#cb173-4"></a><span class="kw">ggplot</span>(firearms, <span class="kw">aes</span>(<span class="dt">x =</span> brady_scores, </span>
<span id="cb173-5"><a href="#cb173-5"></a>                     <span class="dt">y =</span> gunshot_rate)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb173-6"><a href="#cb173-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb173-7"><a href="#cb173-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Firearm Legislative Strength Score&quot;</span>,</span>
<span id="cb173-8"><a href="#cb173-8"></a>       <span class="dt">y =</span> <span class="st">&quot;Annualized Rate of Fatal </span><span class="ch">\n</span><span class="st"> Police Shootings per 1,000,000&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb173-9"><a href="#cb173-9"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb173-10"><a href="#cb173-10"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> NAME))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_text_repel).</code></pre>
<pre><code>## Warning: ggrepel: 7 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<p><img src="images/dataviz-unnamed-chunk-126-1.png" width="672" /></p>
<p>If we wanted to save this particular plot as a pdf, we could do so like this to save the plot in a directory called exploratory within a directory called figures:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="kw">pdf</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;exploratory&quot;</span>, <span class="st">&quot;Fatal_police_shootings_and_firearm_legislative_strength.pdf&quot;</span>))</span>
<span id="cb177-2"><a href="#cb177-2"></a></span>
<span id="cb177-3"><a href="#cb177-3"></a><span class="kw">ggplot</span>(firearms, <span class="kw">aes</span>(<span class="dt">x =</span> brady_scores, </span>
<span id="cb177-4"><a href="#cb177-4"></a>                     <span class="dt">y =</span> gunshot_rate)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb177-5"><a href="#cb177-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb177-6"><a href="#cb177-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Firearm Legislative Strength Score&quot;</span>,</span>
<span id="cb177-7"><a href="#cb177-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Annualized Rate of Fatal </span><span class="ch">\n</span><span class="st"> Police Shootings per 1,000,000&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb177-8"><a href="#cb177-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb177-9"><a href="#cb177-9"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> NAME))</span></code></pre></div>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_text_repel).</code></pre>
<pre><code>## Warning: ggrepel: 3 unlabeled data points (too many overlaps). Consider
## increasing max.overlaps</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<!--chapter:end:04-dataviz.Rmd-->
</div>
</div>
</div>
</div>
<div id="model" class="section level1">
<h1><span class="header-section-number">5</span> Modeling Data in the Tidyverse</h1>
<p>Placeholder</p>
<div id="about-this-course-4" class="section level2">
<h2><span class="header-section-number">5.1</span> About This Course</h2>
</div>
<div id="the-purpose-of-data-science" class="section level2">
<h2><span class="header-section-number">5.2</span> The Purpose of Data Science</h2>
</div>
<div id="types-of-data-science-questions" class="section level2">
<h2><span class="header-section-number">5.3</span> Types of Data Science Questions</h2>
</div>
<div id="data-needs" class="section level2">
<h2><span class="header-section-number">5.4</span> Data Needs</h2>
<div id="number-of-observations-is-too-small" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Number of observations is too small</h3>
</div>
<div id="dataset-does-not-contain-the-exact-variables-you-are-looking-for" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Dataset does not contain the exact variables you are looking for</h3>
</div>
<div id="variables-in-the-dataset-are-not-collected-in-the-same-year" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Variables in the dataset are not collected in the same year</h3>
</div>
<div id="dataset-is-not-representative-of-the-population-that-you-are-interested-in" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Dataset is not representative of the population that you are interested in</h3>
</div>
<div id="some-variables-in-the-dataset-are-measured-with-error" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Some variables in the dataset are measured with error</h3>
</div>
<div id="variables-are-confounded" class="section level3">
<h3><span class="header-section-number">5.4.6</span> Variables are confounded</h3>
</div>
</div>
<div id="descriptive-and-exploratory-analysis" class="section level2">
<h2><span class="header-section-number">5.5</span> Descriptive and Exploratory Analysis</h2>
<div id="missing-values" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Missing Values</h3>
</div>
<div id="shape" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Shape</h3>
<div id="normal-distribution" class="section level4">
<h4><span class="header-section-number">5.5.2.1</span> Normal Distribution</h4>
</div>
</div>
<div id="identifying-outliers" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Identifying Outliers</h3>
</div>
<div id="evaluating-variables" class="section level3">
<h3><span class="header-section-number">5.5.4</span> Evaluating Variables</h3>
<div id="summarizing-your-data" class="section level4">
<h4><span class="header-section-number">5.5.4.1</span> Summarizing Your Data</h4>
<div id="skimr-2" class="section level5">
<h5><span class="header-section-number">5.5.4.1.1</span> skimr</h5>
</div>
</div>
</div>
<div id="evaluating-relationships" class="section level3">
<h3><span class="header-section-number">5.5.5</span> Evaluating Relationships</h3>
</div>
</div>
<div id="inference" class="section level2">
<h2><span class="header-section-number">5.6</span> Inference</h2>
<div id="uncertainty" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Uncertainty</h3>
</div>
<div id="random-sampling" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Random Sampling</h3>
<div id="an-example-of-inferential-data-analysis" class="section level4">
<h4><span class="header-section-number">5.6.2.1</span> An example of inferential data analysis</h4>
</div>
</div>
</div>
<div id="linear-modeling" class="section level2">
<h2><span class="header-section-number">5.7</span> Linear Modeling</h2>
<div id="linear-regression" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Linear Regression</h3>
</div>
<div id="assumptions" class="section level3">
<h3><span class="header-section-number">5.7.2</span> Assumptions</h3>
<div id="linearity" class="section level4">
<h4><span class="header-section-number">5.7.2.1</span> Linearity</h4>
</div>
<div id="homoscedasticity" class="section level4">
<h4><span class="header-section-number">5.7.2.2</span> Homoscedasticity</h4>
</div>
<div id="normality-of-residuals" class="section level4">
<h4><span class="header-section-number">5.7.2.3</span> Normality of residuals</h4>
</div>
</div>
<div id="association" class="section level3">
<h3><span class="header-section-number">5.7.3</span> Association</h3>
<div id="beta-estimate" class="section level4">
<h4><span class="header-section-number">5.7.3.1</span> Beta estimate</h4>
</div>
<div id="standard-error" class="section level4">
<h4><span class="header-section-number">5.7.3.2</span> Standard error</h4>
</div>
</div>
<div id="association-testing-in-r" class="section level3">
<h3><span class="header-section-number">5.7.4</span> Association Testing in R</h3>
</div>
<div id="fitting-the-model" class="section level3">
<h3><span class="header-section-number">5.7.5</span> Fitting the Model</h3>
</div>
<div id="model-diagnostics" class="section level3">
<h3><span class="header-section-number">5.7.6</span> Model Diagnostics</h3>
</div>
<div id="tree-girth-and-height-example" class="section level3">
<h3><span class="header-section-number">5.7.7</span> Tree Girth and Height Example</h3>
</div>
<div id="interpreting-the-model" class="section level3">
<h3><span class="header-section-number">5.7.8</span> Interpreting the Model</h3>
</div>
<div id="variance-explained" class="section level3">
<h3><span class="header-section-number">5.7.9</span> Variance Explained</h3>
</div>
<div id="using-broom" class="section level3">
<h3><span class="header-section-number">5.7.10</span> Using <code>broom</code></h3>
</div>
<div id="correlation-is-not-causation" class="section level3">
<h3><span class="header-section-number">5.7.11</span> Correlation Is Not Causation</h3>
</div>
<div id="confounding" class="section level3">
<h3><span class="header-section-number">5.7.12</span> Confounding</h3>
</div>
</div>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">5.8</span> Multiple Linear Regression</h2>
</div>
<div id="beyond-linear-regression" class="section level2">
<h2><span class="header-section-number">5.9</span> Beyond Linear Regression</h2>
<div id="mean-different-from-expectation" class="section level3">
<h3><span class="header-section-number">5.9.1</span> Mean Different From Expectation?</h3>
</div>
<div id="testing-mean-difference-from-expectation-in-r" class="section level3">
<h3><span class="header-section-number">5.9.2</span> Testing Mean Difference From Expectation in R</h3>
</div>
</div>
<div id="more-statistical-tests" class="section level2">
<h2><span class="header-section-number">5.10</span> More Statistical Tests</h2>
</div>
<div id="hypothesis-testing" class="section level2">
<h2><span class="header-section-number">5.11</span> Hypothesis Testing</h2>
<div id="theinfer-package" class="section level3">
<h3><span class="header-section-number">5.11.1</span> The<code>Infer</code> Package</h3>
</div>
</div>
<div id="prediction-modeling" class="section level2">
<h2><span class="header-section-number">5.12</span> Prediction Modeling</h2>
<div id="what-is-machine-learning" class="section level3">
<h3><span class="header-section-number">5.12.1</span> What is Machine Learning?</h3>
</div>
<div id="machine-learning-steps" class="section level3">
<h3><span class="header-section-number">5.12.2</span> Machine Learning Steps</h3>
</div>
<div id="data-splitting" class="section level3">
<h3><span class="header-section-number">5.12.3</span> Data Splitting</h3>
</div>
<div id="train-test-validate" class="section level3">
<h3><span class="header-section-number">5.12.4</span> Train, Test, Validate</h3>
</div>
<div id="train" class="section level3">
<h3><span class="header-section-number">5.12.5</span> Train</h3>
</div>
<div id="test" class="section level3">
<h3><span class="header-section-number">5.12.6</span> Test</h3>
</div>
<div id="validate" class="section level3">
<h3><span class="header-section-number">5.12.7</span> Validate</h3>
</div>
<div id="variable-selection" class="section level3">
<h3><span class="header-section-number">5.12.8</span> Variable Selection</h3>
<div id="lack-of-causality-reminder" class="section level4">
<h4><span class="header-section-number">5.12.8.1</span> Lack of Causality Reminder</h4>
</div>
</div>
<div id="model-selection" class="section level3">
<h3><span class="header-section-number">5.12.9</span> Model Selection</h3>
</div>
<div id="regression-vs.-classification" class="section level3">
<h3><span class="header-section-number">5.12.10</span> Regression vs. Classification</h3>
<div id="linear-regression-1" class="section level4">
<h4><span class="header-section-number">5.12.10.1</span> Linear Regression</h4>
</div>
<div id="classification-and-regression-trees-cart" class="section level4">
<h4><span class="header-section-number">5.12.10.2</span> Classification and Regression Trees (CART)</h4>
</div>
</div>
<div id="model-accuracy" class="section level3">
<h3><span class="header-section-number">5.12.11</span> Model Accuracy</h3>
<div id="error-rates" class="section level4">
<h4><span class="header-section-number">5.12.11.1</span> Error Rates</h4>
<div id="rmse" class="section level5">
<h5><span class="header-section-number">5.12.11.1.1</span> RMSE</h5>
</div>
</div>
<div id="accuracy" class="section level4">
<h4><span class="header-section-number">5.12.11.2</span> Accuracy</h4>
</div>
</div>
</div>
<div id="the-tidymodels-ecosystem-1" class="section level2">
<h2><span class="header-section-number">5.13</span> The <code>tidymodels</code> Ecosystem</h2>
<div id="benefits-of-tidymodels" class="section level3">
<h3><span class="header-section-number">5.13.1</span> Benefits of <code>tidymodels</code></h3>
</div>
<div id="packages-of-tidymodels" class="section level3">
<h3><span class="header-section-number">5.13.2</span> Packages of <code>tidymodels</code></h3>
</div>
<div id="example-of-continuous-variable-prediction" class="section level3">
<h3><span class="header-section-number">5.13.3</span> Example of Continuous Variable Prediction</h3>
<div id="step-1-example-of-data-splitting-with-rsample" class="section level4">
<h4><span class="header-section-number">5.13.3.1</span> Step 1: Example of Data Splitting with <code>rsample</code></h4>
</div>
<div id="step-2-example-of-preparing-for-preprocessing-the-data-with-recipes" class="section level4">
<h4><span class="header-section-number">5.13.3.2</span> Step 2: Example of preparing for preprocessing the data with <code>recipes</code></h4>
<div id="step-1-specify-variables-with-the-recipe-function" class="section level5">
<h5><span class="header-section-number">5.13.3.2.1</span> Step 1: Specify variables with the <code>recipe()</code> function</h5>
</div>
<div id="step-2-specify-the-preprocessing-steps-with-step-functions" class="section level5">
<h5><span class="header-section-number">5.13.3.2.2</span> Step 2: Specify the preprocessing steps with <code>step*()</code> functions</h5>
</div>
</div>
<div id="step-3-example-of-optionally-performing-the-preprocessing-to-see-how-it-influences-the-data" class="section level4">
<h4><span class="header-section-number">5.13.3.3</span> Step 3: Example of optionally performing the preprocessing to see how it influences the data</h4>
</div>
<div id="step-4-example-of-specifying-the-model-with-parsnip" class="section level4">
<h4><span class="header-section-number">5.13.3.4</span> Step 4: Example of specifying the model with <code>parsnip</code></h4>
</div>
<div id="step-5-example-of-fitting-the-model" class="section level4">
<h4><span class="header-section-number">5.13.3.5</span> Step 5: Example of fitting the model</h4>
</div>
<div id="step-6-example-of-assessing-the-model-performance" class="section level4">
<h4><span class="header-section-number">5.13.3.6</span> Step 6: Example of assessing the model performance</h4>
</div>
</div>
<div id="example-of-categorical-variable-prediction" class="section level3">
<h3><span class="header-section-number">5.13.4</span> Example of Categorical Variable Prediction</h3>
<div id="example-of-creating-cross-validation-samples-with-rsample" class="section level4">
<h4><span class="header-section-number">5.13.4.1</span> Example of creating cross validation samples with <code>rsample</code></h4>
</div>
<div id="example-of-creating-another-recipe-model-and-workflow" class="section level4">
<h4><span class="header-section-number">5.13.4.2</span> Example of creating another recipe, model and workflow</h4>
</div>
<div id="example-of-assessing-model-performance-with-cross-validation-using-tune" class="section level4">
<h4><span class="header-section-number">5.13.4.3</span> Example of assessing model performance with cross validation using <code>tune</code></h4>
</div>
<div id="example-of-tuning" class="section level4">
<h4><span class="header-section-number">5.13.4.4</span> Example of tuning</h4>
</div>
</div>
</div>
<div id="case-studies-4" class="section level2">
<h2><span class="header-section-number">5.14</span> Case Studies</h2>
<div id="case-study-1-predicting-annual-air-pollution" class="section level3">
<h3><span class="header-section-number">5.14.1</span> Case Study #1: Predicting Annual Air Pollution</h3>
<div id="the-data" class="section level4">
<h4><span class="header-section-number">5.14.1.1</span> The Data</h4>
</div>
<div id="data-import" class="section level4">
<h4><span class="header-section-number">5.14.1.2</span> Data Import</h4>
</div>
<div id="data-exploration-and-wrangling" class="section level4">
<h4><span class="header-section-number">5.14.1.3</span> Data Exploration and Wrangling</h4>
</div>
<div id="evaluate-correlation" class="section level4">
<h4><span class="header-section-number">5.14.1.4</span> Evaluate Correlation</h4>
</div>
<div id="splitting-the-data" class="section level4">
<h4><span class="header-section-number">5.14.1.5</span> Splitting the Data</h4>
</div>
<div id="making-a-recipe" class="section level4">
<h4><span class="header-section-number">5.14.1.6</span> Making a Recipe</h4>
</div>
<div id="running-preprocessing" class="section level4">
<h4><span class="header-section-number">5.14.1.7</span> Running Preprocessing</h4>
<div id="extract-preprocessed-testing-data-using-bake" class="section level5">
<h5><span class="header-section-number">5.14.1.7.1</span> Extract preprocessed testing data using <code>bake()</code></h5>
</div>
</div>
<div id="specifying-the-model" class="section level4">
<h4><span class="header-section-number">5.14.1.8</span> Specifying the Model</h4>
</div>
<div id="assessing-the-model-fit" class="section level4">
<h4><span class="header-section-number">5.14.1.9</span> Assessing the Model Fit</h4>
</div>
<div id="model-performance" class="section level4">
<h4><span class="header-section-number">5.14.1.10</span> Model Performance</h4>
</div>
<div id="visualizing-model-performance" class="section level4">
<h4><span class="header-section-number">5.14.1.11</span> Visualizing Model Performance</h4>
</div>
<div id="quantifying-model-performance" class="section level4">
<h4><span class="header-section-number">5.14.1.12</span> Quantifying Model Performance</h4>
</div>
<div id="assessing-model-performance-on-v-folds-using-tune" class="section level4">
<h4><span class="header-section-number">5.14.1.13</span> Assessing Model Performance on <span class="math inline">\(v\)</span>-folds Using <code>tune</code></h4>
</div>
<div id="random-forest" class="section level4">
<h4><span class="header-section-number">5.14.1.14</span> Random Forest</h4>
</div>
<div id="model-tuning" class="section level4">
<h4><span class="header-section-number">5.14.1.15</span> Model Tuning</h4>
</div>
<div id="final-model-performance-evaluation" class="section level4">
<h4><span class="header-section-number">5.14.1.16</span> Final model performance evaluation</h4>
</div>
</div>
</div>
<div id="summary-of-tidymodels" class="section level2">
<h2><span class="header-section-number">5.15</span> Summary of <code>tidymodels</code></h2>
<!--chapter:end:05-prediction.Rmd-->
</div>
</div>
<div id="about-the-authors" class="section level1 unnumbered">
<h1>About the Authors</h1>
<p><strong>Carrie Wright</strong> is a Research Associate in the Department of Biostatistics at the Johns Hopkins Bloomberg School of Public Health. She is faculty member of the Johns Hopkins Data Science Lab, where her work focuses on making data science and bioinformatics more approachable to a variety of audiences. She is also a faculty member of the <a href="https://www.opencasestudies.org/">open case studies project</a> and a co-founder of the <a href="http://research.libd.org/rstatsclub/">LIBD rstats club</a>, a community designed to encourage others to learn more about R programming and statistics. Carrie can be found on Twitter at <a href="https://twitter.com/mirnas22">mirnas22</a> and on GitHub under the user name <a href="https://github.com/carriewright11">carriewright11</a>.</p>
<p><strong>Shannon E. Ellis</strong> is an Assistant Teaching Professor of <a href="http://www.cogsci.ucsd.edu">Cognitive Science</a> at the <a href="https://ucsd.edu">University of California San Deigo</a>. She teaches data science to thousands of undergraduates each year and is a developer of the <a href="https://www.clouddatascience.org">Cloud-Based Data Science</a> Course Set on <a href="https://leanpub.com/universities/set/jhu/cloud-based-data-science">Leanpub</a>. Shannon can be found on Twitter at <a href="https://twitter.com/Shannon_E_Ellis">Shannon_E_Ellis</a> and on GitHub under the user name <a href="https://github.com/shanellis">ShanEllis</a>.</p>
<p><strong>Stephanie C. Hicks</strong> is an Assistant Professor of <a href="https://www.jhsph.edu/departments/biostatistics">Biostatistics</a> at the <a href="https://www.jhsph.edu">Johns Hopkins Bloomberg School of Public Health</a>. She is also a faculty member of the <a href="http://jhudatascience.org">Johns Hopkins Data Science Lab</a>, co-host of <a href="https://twitter.com/CorrespondAuth">The Corresponding Author</a> podcast and co-founder of <a href="https://rladies-baltimore.github.io">R-Ladies Baltimore</a>. Stephanie can be found on Twitter and GitHub under the user name <a href="https://twitter.com/stephaniehicks">stephaniehicks</a>.</p>
<p><strong>Roger D. Peng</strong> is a Professor of Biostatistics at the Johns Hopkins Bloomberg School of Public Health. He is also a Co-Founder of the <a href="http://www.coursera.org/specialization/jhudatascience/1">Johns Hopkins Data Science Specialization</a>, which has enrolled over 5 million students, the <a href="https://www.coursera.org/specializations/executive-data-science">Johns Hopkins Executive Data Science Specialization</a>, the <a href="http://simplystatistics.org/">Simply Statistics blog</a> where he writes about statistics and data science for the general public, and the <a href="https://soundcloud.com/nssd-podcast">Not So Standard Deviations</a> podcast. Roger can be found on Twitter and GitHub under the user name <a href="https://twitter.com/rdpeng">rdpeng</a>.</p>
<!--chapter:end:about.Rmd-->
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
